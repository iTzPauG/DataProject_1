<<<<<<< Updated upstream
[0m23:13:22.854118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754d584dbb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754d58485690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754d5848bfd0>]}


============================== 23:13:22.863118 | 19e1d202-af22-4ae8-b621-1718ef1b644b ==============================
[0m23:13:22.863118 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:13:22.865008 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'debug': 'False', 'write_json': 'True', 'partial_parse': 'True', 'profiles_dir': '/usr/app/dbt/dbt', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'printer_width': '80', 'use_colors': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/dbt/logs', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m23:13:22.889065 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'data_project_1'
[0m23:13:22.894358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.14287892, "process_in_blocks": "0", "process_kernel_time": 0.802461, "process_mem_max_rss": "103972", "process_out_blocks": "0", "process_user_time": 1.13264}
[0m23:13:22.898800 [debug] [MainThread]: Command `dbt run` failed at 23:13:22.898574 after 0.15 seconds
[0m23:13:22.902629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754d5cdaaa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754d5cdaa9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x754d584d8e50>]}
[0m23:13:22.904643 [debug] [MainThread]: Flushing usage events
[0m23:13:23.677556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:14:26.477821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae8d5a8a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae8d5a55790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae8d5a96890>]}


============================== 23:14:26.486663 | 42a9ed52-ab8a-4415-bb42-0f79b52bf74e ==============================
[0m23:14:26.486663 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:14:26.490380 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_path': '/usr/app/dbt/dbt/logs', 'target_path': 'None', 'partial_parse': 'True', 'log_format': 'default', 'introspect': 'True', 'profiles_dir': '/usr/app/dbt/dbt', 'version_check': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'printer_width': '80', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'write_json': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'debug': 'False', 'empty': 'False'}
[0m23:14:26.517507 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'data_project_1'
[0m23:14:26.522543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.19722396, "process_in_blocks": "0", "process_kernel_time": 0.842174, "process_mem_max_rss": "103980", "process_out_blocks": "0", "process_user_time": 1.263262}
[0m23:14:26.525317 [debug] [MainThread]: Command `dbt run` failed at 23:14:26.524857 after 0.20 seconds
[0m23:14:26.527103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae8da272e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae8d5a26b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae8d5a8bf90>]}
[0m23:14:26.530755 [debug] [MainThread]: Flushing usage events
[0m23:14:27.159356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:15:29.784859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7749a7672a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7749a767a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7749a7984e10>]}


============================== 23:15:29.795265 | f128eaa3-2565-43d2-a1fa-af2d28174da9 ==============================
[0m23:15:29.795265 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:15:29.797465 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/app/dbt/dbt/logs', 'log_format': 'default', 'quiet': 'False', 'printer_width': '80', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt/dbt', 'target_path': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'empty': 'False', 'partial_parse': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True'}
[0m23:15:29.811934 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'data_project_1'
[0m23:15:29.815228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.10990032, "process_in_blocks": "0", "process_kernel_time": 0.819297, "process_mem_max_rss": "103952", "process_out_blocks": "0", "process_user_time": 1.210961}
[0m23:15:29.816605 [debug] [MainThread]: Command `dbt run` failed at 23:15:29.816437 after 0.11 seconds
[0m23:15:29.817775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7749abf42a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7749a7672a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7749a7673f50>]}
[0m23:15:29.819398 [debug] [MainThread]: Flushing usage events
[0m23:15:30.442041 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:27:14.268695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57F39EBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C501854A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C501854880>]}


============================== 00:27:14.279077 | 8559683e-c0fd-4ac4-826e-2034b7a0c49c ==============================
[0m00:27:14.279077 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:27:14.281119 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'C:\\Users\\gbala\\OneDrive\\Escritorio\\MÃ¡ster Big Data\\apis\\DataProject_1', 'write_json': 'True', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\gbala\\Desktop\\DataProject_1\\dbt\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m00:27:14.309931 [info ] [MainThread]: dbt version: 1.10.15
[0m00:27:14.309931 [info ] [MainThread]: python version: 3.10.11
[0m00:27:14.315727 [info ] [MainThread]: python path: C:\Users\gbala\AppData\Local\Programs\Python\Python310\python.exe
[0m00:27:14.315727 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m00:27:14.315727 [info ] [MainThread]: Using profiles dir at C:\Users\gbala\OneDrive\Escritorio\MÃ¡ster Big Data\apis\DataProject_1
[0m00:27:14.323118 [info ] [MainThread]: Using profiles.yml file at C:\Users\gbala\OneDrive\Escritorio\MÃ¡ster Big Data\apis\DataProject_1\profiles.yml
[0m00:27:14.324636 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\gbala\Desktop\DataProject_1\dbt\dbt_project.yml
[0m00:27:14.433522 [info ] [MainThread]: Configuration:
[0m00:27:14.435997 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:27:14.436529 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:27:14.436529 [info ] [MainThread]: Required dependencies:
[0m00:27:14.436529 [debug] [MainThread]: Executing "git --help"
[0m00:27:14.697344 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:27:14.699196 [debug] [MainThread]: STDERR: "b''"
[0m00:27:14.700268 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:27:14.701977 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:27:14.703054 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:27:14.704663 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'data_project_1'


[0m00:27:14.706391 [debug] [MainThread]: Command `dbt debug` failed at 00:27:14.706391 after 0.64 seconds
[0m00:27:14.707604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57F39EBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57FDF54B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C57F721C90>]}
[0m00:27:14.708373 [debug] [MainThread]: Flushing usage events
[0m00:27:15.340594 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:28:41.474553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177BA92EBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177BCC34A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177BCC34880>]}


============================== 00:28:41.483553 | 9c201379-144d-42e6-bba9-4b64a5759d79 ==============================
[0m00:28:41.483553 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:28:41.485073 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': 'C:\\Users\\gbala\\OneDrive\\Escritorio\\MÃ¡ster Big Data\\apis\\DataProject_1', 'use_colors': 'True', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\gbala\\Desktop\\DataProject_1\\dbt\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m00:28:41.514007 [info ] [MainThread]: dbt version: 1.10.15
[0m00:28:41.515511 [info ] [MainThread]: python version: 3.10.11
[0m00:28:41.516186 [info ] [MainThread]: python path: C:\Users\gbala\AppData\Local\Programs\Python\Python310\python.exe
[0m00:28:41.517436 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m00:28:41.526281 [info ] [MainThread]: Using profiles dir at C:\Users\gbala\OneDrive\Escritorio\MÃ¡ster Big Data\apis\DataProject_1
[0m00:28:41.527448 [info ] [MainThread]: Using profiles.yml file at C:\Users\gbala\OneDrive\Escritorio\MÃ¡ster Big Data\apis\DataProject_1\profiles.yml
[0m00:28:41.529450 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\gbala\Desktop\DataProject_1\dbt\dbt_project.yml
[0m00:28:41.634872 [info ] [MainThread]: Configuration:
[0m00:28:41.636128 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:28:41.637137 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:28:41.639135 [info ] [MainThread]: Required dependencies:
[0m00:28:41.639843 [debug] [MainThread]: Executing "git --help"
[0m00:28:41.935786 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:28:41.935786 [debug] [MainThread]: STDERR: "b''"
[0m00:28:41.936840 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:28:41.937838 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:28:41.938845 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:28:41.940587 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'data_project_1'


[0m00:28:41.941895 [debug] [MainThread]: Command `dbt debug` failed at 00:28:41.941895 after 0.74 seconds
[0m00:28:41.943374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177BA92EBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177BC3594B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177BACB1C90>]}
[0m00:28:41.944368 [debug] [MainThread]: Flushing usage events
[0m00:28:42.540592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:45.329147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E6A1CECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E6C4C8B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E6C4C8940>]}


============================== 00:29:45.337281 | 02cbe22f-20da-4594-8d73-8df01997d5b8 ==============================
[0m00:29:45.337281 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:29:45.339283 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\gbala\\Desktop\\DataProject_1\\dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\gbala\\Desktop\\DataProject_1\\dbt\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir C:\\Users\\gbala\\Desktop\\DataProject_1\\dbt', 'printer_width': '80', 'target_path': 'None'}
[0m00:29:45.361866 [info ] [MainThread]: dbt version: 1.10.15
[0m00:29:45.363861 [info ] [MainThread]: python version: 3.10.11
[0m00:29:45.364864 [info ] [MainThread]: python path: C:\Users\gbala\AppData\Local\Programs\Python\Python310\python.exe
[0m00:29:45.367297 [info ] [MainThread]: os info: Windows-10-10.0.26200-SP0
[0m00:29:45.375475 [info ] [MainThread]: Using profiles dir at C:\Users\gbala\Desktop\DataProject_1\dbt
[0m00:29:45.377491 [info ] [MainThread]: Using profiles.yml file at C:\Users\gbala\Desktop\DataProject_1\dbt\profiles.yml
[0m00:29:45.378487 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\gbala\Desktop\DataProject_1\dbt\dbt_project.yml
[0m00:29:45.482522 [info ] [MainThread]: Configuration:
[0m00:29:45.483520 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m00:29:45.484521 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:29:45.485938 [info ] [MainThread]: Required dependencies:
[0m00:29:45.486446 [debug] [MainThread]: Executing "git --help"
[0m00:29:45.758446 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:29:45.759551 [debug] [MainThread]: STDERR: "b''"
[0m00:29:45.762081 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:29:45.763079 [info ] [MainThread]: Connection test skipped since no profile was found
[0m00:29:45.765606 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:29:45.766604 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'data_project_1'


[0m00:29:45.768602 [debug] [MainThread]: Command `dbt debug` failed at 00:29:45.768602 after 0.77 seconds
[0m00:29:45.770111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E6A1CECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E687262F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E6A553F40>]}
[0m00:29:45.771122 [debug] [MainThread]: Flushing usage events
[0m00:29:46.377522 [debug] [MainThread]: An error was encountered while trying to flush usage events
=======
[0m23:11:16.678606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7855a05de6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7855a05de590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7855a05dea10>]}


============================== 23:11:16.685984 | ab98ff54-3038-463c-906d-6fc7b3c74c74 ==============================
[0m23:11:16.685984 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:11:16.687982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/dbt/logs', 'version_check': 'True', 'empty': 'False', 'no_print': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'log_format': 'default', 'profiles_dir': '/usr/app/dbt/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False'}
[0m23:11:16.702826 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbt_valenbisi'
[0m23:11:16.706208 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.10321008, "process_in_blocks": "0", "process_kernel_time": 0.572034, "process_mem_max_rss": "103988", "process_out_blocks": "0", "process_user_time": 1.168069}
[0m23:11:16.708006 [debug] [MainThread]: Command `dbt run` failed at 23:11:16.707772 after 0.11 seconds
[0m23:11:16.710114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7855a05a99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7855a0586a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7855a05dff10>]}
[0m23:11:16.711789 [debug] [MainThread]: Flushing usage events
[0m23:11:17.356516 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:12:19.810558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049dc79b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049dd609890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049dc79b190>]}


============================== 23:12:19.817270 | ab865479-e31f-4260-87e2-5d8baf288573 ==============================
[0m23:12:19.817270 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:12:19.818550 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'debug': 'False', 'log_path': '/usr/app/dbt/dbt/logs', 'partial_parse': 'True', 'log_format': 'default', 'profiles_dir': '/usr/app/dbt/dbt', 'use_experimental_parser': 'False', 'write_json': 'True', 'quiet': 'False', 'invocation_command': 'dbt run', 'empty': 'False', 'fail_fast': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m23:12:19.826253 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbt_valenbisi'
[0m23:12:19.827552 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.08750401, "process_in_blocks": "0", "process_kernel_time": 0.652714, "process_mem_max_rss": "104068", "process_out_blocks": "0", "process_user_time": 1.107636}
[0m23:12:19.829244 [debug] [MainThread]: Command `dbt run` failed at 23:12:19.829143 after 0.09 seconds
[0m23:12:19.830052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049e0f86e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049dcbc82d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7049dcacc6d0>]}
[0m23:12:19.831333 [debug] [MainThread]: Flushing usage events
[0m23:12:20.363483 [debug] [MainThread]: An error was encountered while trying to flush usage events
>>>>>>> Stashed changes
[0m01:25:48.308718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6124b1b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6124b103d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6124ac60d0>]}


============================== 01:25:48.326708 | 477b63f2-8634-46ed-bb25-74ac6f2d093e ==============================
[0m01:25:48.326708 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:25:48.329062 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt deps', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': 'logs', 'empty': 'None', 'target_path': 'None', 'version_check': 'True'}
[0m01:25:48.331765 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /usr/app/dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m01:25:48.336827 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.10832373, "process_in_blocks": "24", "process_kernel_time": 3.764981, "process_mem_max_rss": "103616", "process_out_blocks": "0", "process_user_time": 1.868487}
[0m01:25:48.339107 [debug] [MainThread]: Command `dbt deps` failed at 01:25:48.338898 after 0.11 seconds
[0m01:25:48.341513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6124b09410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6124ac7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6124b1b650>]}
[0m01:25:48.343862 [debug] [MainThread]: Flushing usage events
[0m01:25:48.902330 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:31:12.106224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3d61bc2dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3d6190e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3d61963590>]}


============================== 01:31:12.115869 | 6f3a19f7-7970-4227-9322-76705ae6982a ==============================
[0m01:31:12.115869 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:31:12.118104 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'write_json': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/usr/app/dbt', 'introspect': 'True', 'empty': 'None'}
[0m01:31:12.226018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f3a19f7-7970-4227-9322-76705ae6982a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3d618fc410>]}
[0m01:31:12.246178 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:31:13.611031 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:31:13.615369 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.5907362, "process_in_blocks": "0", "process_kernel_time": 1.265991, "process_mem_max_rss": "105228", "process_out_blocks": "0", "process_user_time": 1.974156}
[0m01:31:13.617917 [debug] [MainThread]: Command `dbt deps` succeeded at 01:31:13.617535 after 1.59 seconds
[0m01:31:13.620416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3d61951010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3d618ff890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3d66226d10>]}
[0m01:31:13.622821 [debug] [MainThread]: Flushing usage events
[0m01:31:14.278790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:31:18.037691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d0bbbe910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d0bcc4d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d0bc17910>]}


============================== 01:31:18.052325 | 46ae181b-b80e-4235-b68e-f10c5dc0cc94 ==============================
[0m01:31:18.052325 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:31:18.058964 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/usr/app/dbt/logs', 'write_json': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'quiet': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt build --target dev', 'introspect': 'True', 'profiles_dir': '/usr/app/dbt', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'empty': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True'}
[0m01:31:18.389575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46ae181b-b80e-4235-b68e-f10c5dc0cc94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d0e8e7950>]}
[0m01:31:18.489765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46ae181b-b80e-4235-b68e-f10c5dc0cc94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d0e90ca50>]}
[0m01:31:18.494108 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:31:18.617241 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m01:31:18.624001 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:31:18.626075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '46ae181b-b80e-4235-b68e-f10c5dc0cc94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d0af58590>]}
[0m01:31:20.338292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46ae181b-b80e-4235-b68e-f10c5dc0cc94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d0a3b9b10>]}
[0m01:31:20.442447 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m01:31:20.453697 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m01:31:20.500083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46ae181b-b80e-4235-b68e-f10c5dc0cc94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d0278b4d0>]}
[0m01:31:20.501231 [info ] [MainThread]: Found 1 model, 6 data tests, 2 sources, 459 macros
[0m01:31:20.505849 [info ] [MainThread]: 
[0m01:31:20.510839 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:31:20.512426 [info ] [MainThread]: 
[0m01:31:20.514608 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:31:20.517528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1'
[0m01:31:20.575120 [debug] [ThreadPool]: Using postgres connection "list_data_project_1"
[0m01:31:20.577067 [debug] [ThreadPool]: On list_data_project_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1"} */

    select distinct nspname from pg_namespace
  
[0m01:31:20.579336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:20.611139 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.032 seconds
[0m01:31:20.614008 [debug] [ThreadPool]: On list_data_project_1: Close
[0m01:31:20.616053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_project_1, now create_data_project_1_analytics)
[0m01:31:20.619089 [debug] [ThreadPool]: Creating schema "database: "data_project_1"
schema: "analytics"
"
[0m01:31:20.627351 [debug] [ThreadPool]: Using postgres connection "create_data_project_1_analytics"
[0m01:31:20.630278 [debug] [ThreadPool]: On create_data_project_1_analytics: BEGIN
[0m01:31:20.631784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:20.649411 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m01:31:20.652218 [debug] [ThreadPool]: Using postgres connection "create_data_project_1_analytics"
[0m01:31:20.654329 [debug] [ThreadPool]: On create_data_project_1_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "create_data_project_1_analytics"} */
create schema if not exists "analytics"
[0m01:31:20.667684 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.010 seconds
[0m01:31:20.670573 [debug] [ThreadPool]: On create_data_project_1_analytics: COMMIT
[0m01:31:20.672555 [debug] [ThreadPool]: Using postgres connection "create_data_project_1_analytics"
[0m01:31:20.674826 [debug] [ThreadPool]: On create_data_project_1_analytics: COMMIT
[0m01:31:20.678752 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m01:31:20.680873 [debug] [ThreadPool]: On create_data_project_1_analytics: Close
[0m01:31:20.685837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_project_1_analytics, now list_data_project_1_analytics)
[0m01:31:20.696072 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_analytics"
[0m01:31:20.698812 [debug] [ThreadPool]: On list_data_project_1_analytics: BEGIN
[0m01:31:20.701000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:20.718321 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m01:31:20.719966 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_analytics"
[0m01:31:20.721912 [debug] [ThreadPool]: On list_data_project_1_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1_analytics"} */
select
      'data_project_1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'data_project_1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'data_project_1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m01:31:20.764960 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.040 seconds
[0m01:31:20.770421 [debug] [ThreadPool]: On list_data_project_1_analytics: ROLLBACK
[0m01:31:20.774386 [debug] [ThreadPool]: On list_data_project_1_analytics: Close
[0m01:31:20.781604 [debug] [MainThread]: Using postgres connection "master"
[0m01:31:20.783507 [debug] [MainThread]: On master: BEGIN
[0m01:31:20.785494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:31:20.803825 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m01:31:20.807579 [debug] [MainThread]: Using postgres connection "master"
[0m01:31:20.809800 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:31:20.841834 [debug] [MainThread]: SQL status: SELECT 0 in 0.030 seconds
[0m01:31:20.845655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46ae181b-b80e-4235-b68e-f10c5dc0cc94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d027bae90>]}
[0m01:31:20.847925 [debug] [MainThread]: On master: ROLLBACK
[0m01:31:20.850523 [debug] [MainThread]: Using postgres connection "master"
[0m01:31:20.852421 [debug] [MainThread]: On master: BEGIN
[0m01:31:20.855279 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:31:20.857079 [debug] [MainThread]: On master: COMMIT
[0m01:31:20.858971 [debug] [MainThread]: Using postgres connection "master"
[0m01:31:20.860648 [debug] [MainThread]: On master: COMMIT
[0m01:31:20.863159 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:31:20.865667 [debug] [MainThread]: On master: Close
[0m01:31:20.880512 [debug] [Thread-1 (]: Began running node test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198
[0m01:31:20.881092 [debug] [Thread-2 (]: Began running node test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844
[0m01:31:20.882185 [debug] [Thread-3 (]: Began running node test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0
[0m01:31:20.882750 [debug] [Thread-4 (]: Began running node test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e
[0m01:31:20.883877 [info ] [Thread-1 (]: 1 of 7 START test source_not_null_raw_data_mediciones_fecha_carg ............... [RUN]
[0m01:31:20.888195 [info ] [Thread-2 (]: 2 of 7 START test source_not_null_raw_data_mediciones_id ....................... [RUN]
[0m01:31:20.893107 [info ] [Thread-3 (]: 3 of 7 START test source_not_null_raw_data_mediciones_nombre_estacion .......... [RUN]
[0m01:31:20.901894 [info ] [Thread-4 (]: 4 of 7 START test source_not_null_schema_ingesta_mediciones_id ................. [RUN]
[0m01:31:20.904213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_project_1_analytics, now test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198)
[0m01:31:20.907533 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844'
[0m01:31:20.910000 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0'
[0m01:31:20.912510 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e'
[0m01:31:20.915259 [debug] [Thread-1 (]: Began compiling node test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198
[0m01:31:20.917244 [debug] [Thread-2 (]: Began compiling node test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844
[0m01:31:20.919191 [debug] [Thread-3 (]: Began compiling node test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0
[0m01:31:20.921079 [debug] [Thread-4 (]: Began compiling node test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e
[0m01:31:20.942372 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198"
[0m01:31:20.948976 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844"
[0m01:31:20.955608 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0"
[0m01:31:20.963653 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e"
[0m01:31:21.016235 [debug] [Thread-2 (]: Began executing node test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844
[0m01:31:21.021023 [debug] [Thread-4 (]: Began executing node test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e
[0m01:31:21.021961 [debug] [Thread-3 (]: Began executing node test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0
[0m01:31:21.042163 [debug] [Thread-1 (]: Began executing node test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198
[0m01:31:21.055127 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e"
[0m01:31:21.057255 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844"
[0m01:31:21.062761 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0"
[0m01:31:21.067696 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198"
[0m01:31:21.116729 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e"
[0m01:31:21.117446 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844"
[0m01:31:21.119065 [debug] [Thread-4 (]: On test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e: BEGIN
[0m01:31:21.121018 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198"
[0m01:31:21.122213 [debug] [Thread-2 (]: On test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844: BEGIN
[0m01:31:21.123930 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:31:21.124767 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0"
[0m01:31:21.126082 [debug] [Thread-1 (]: On test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198: BEGIN
[0m01:31:21.128056 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:31:21.133242 [debug] [Thread-3 (]: On test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0: BEGIN
[0m01:31:21.135220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:21.138432 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:31:21.143715 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m01:31:21.147811 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e"
[0m01:31:21.149683 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m01:31:21.150719 [debug] [Thread-4 (]: On test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."public"."mediciones"
where id is null



  
  
      
    ) dbt_internal_test
[0m01:31:21.151848 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:31:21.152921 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844"
[0m01:31:21.154334 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m01:31:21.156715 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198"
[0m01:31:21.158964 [debug] [Thread-2 (]: On test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."public"."mediciones"
where id is null



  
  
      
    ) dbt_internal_test
[0m01:31:21.161181 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0"
[0m01:31:21.163851 [debug] [Thread-1 (]: On test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."public"."mediciones"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m01:31:21.164641 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m01:31:21.167614 [debug] [Thread-3 (]: On test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."public"."mediciones"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m01:31:21.168268 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m01:31:21.176204 [debug] [Thread-4 (]: On test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e: ROLLBACK
[0m01:31:21.176798 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m01:31:21.182535 [debug] [Thread-2 (]: On test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844: ROLLBACK
[0m01:31:21.183725 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m01:31:21.186058 [debug] [Thread-4 (]: On test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e: Close
[0m01:31:21.189494 [debug] [Thread-1 (]: On test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198: ROLLBACK
[0m01:31:21.192114 [debug] [Thread-2 (]: On test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844: Close
[0m01:31:21.194931 [debug] [Thread-3 (]: On test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0: ROLLBACK
[0m01:31:21.197811 [info ] [Thread-4 (]: 4 of 7 PASS source_not_null_schema_ingesta_mediciones_id ....................... [[32mPASS[0m in 0.29s]
[0m01:31:21.199601 [debug] [Thread-1 (]: On test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198: Close
[0m01:31:21.200923 [info ] [Thread-2 (]: 2 of 7 PASS source_not_null_raw_data_mediciones_id ............................. [[32mPASS[0m in 0.29s]
[0m01:31:21.203344 [debug] [Thread-3 (]: On test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0: Close
[0m01:31:21.204765 [debug] [Thread-4 (]: Finished running node test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e
[0m01:31:21.207315 [info ] [Thread-1 (]: 1 of 7 PASS source_not_null_raw_data_mediciones_fecha_carg ..................... [[32mPASS[0m in 0.30s]
[0m01:31:21.208999 [debug] [Thread-2 (]: Finished running node test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844
[0m01:31:21.211377 [info ] [Thread-3 (]: 3 of 7 PASS source_not_null_raw_data_mediciones_nombre_estacion ................ [[32mPASS[0m in 0.30s]
[0m01:31:21.212831 [debug] [Thread-4 (]: Began running node test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73
[0m01:31:21.214751 [debug] [Thread-1 (]: Finished running node test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198
[0m01:31:21.216456 [debug] [Thread-2 (]: Began running node test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a
[0m01:31:21.219493 [debug] [Thread-3 (]: Finished running node test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0
[0m01:31:21.221290 [info ] [Thread-4 (]: 5 of 7 START test source_unique_raw_data_mediciones_id ......................... [RUN]
[0m01:31:21.225030 [info ] [Thread-2 (]: 6 of 7 START test source_unique_schema_ingesta_mediciones_id ................... [RUN]
[0m01:31:21.229125 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.source_not_null_schema_ingesta_mediciones_id.d90936153e, now test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73)
[0m01:31:21.231457 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.source_not_null_raw_data_mediciones_id.656c995844, now test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a)
[0m01:31:21.233412 [debug] [Thread-4 (]: Began compiling node test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73
[0m01:31:21.235471 [debug] [Thread-2 (]: Began compiling node test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a
[0m01:31:21.244293 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73"
[0m01:31:21.249647 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a"
[0m01:31:21.261227 [debug] [Thread-4 (]: Began executing node test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73
[0m01:31:21.264909 [debug] [Thread-2 (]: Began executing node test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a
[0m01:31:21.268091 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73"
[0m01:31:21.272404 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a"
[0m01:31:21.287009 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73"
[0m01:31:21.289704 [debug] [Thread-4 (]: On test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73: BEGIN
[0m01:31:21.291690 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a"
[0m01:31:21.292588 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:31:21.294713 [debug] [Thread-2 (]: On test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a: BEGIN
[0m01:31:21.298351 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:31:21.307444 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m01:31:21.309406 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73"
[0m01:31:21.311156 [debug] [Thread-4 (]: On test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."public"."mediciones"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:31:21.312472 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m01:31:21.314254 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a"
[0m01:31:21.316193 [debug] [Thread-2 (]: On test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."public"."mediciones"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:31:21.318484 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m01:31:21.322081 [debug] [Thread-4 (]: On test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73: ROLLBACK
[0m01:31:21.322713 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m01:31:21.324708 [debug] [Thread-4 (]: On test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73: Close
[0m01:31:21.326586 [debug] [Thread-2 (]: On test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a: ROLLBACK
[0m01:31:21.328930 [info ] [Thread-4 (]: 5 of 7 PASS source_unique_raw_data_mediciones_id ............................... [[32mPASS[0m in 0.10s]
[0m01:31:21.331016 [debug] [Thread-2 (]: On test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a: Close
[0m01:31:21.332637 [debug] [Thread-4 (]: Finished running node test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73
[0m01:31:21.334767 [info ] [Thread-2 (]: 6 of 7 PASS source_unique_schema_ingesta_mediciones_id ......................... [[32mPASS[0m in 0.10s]
[0m01:31:21.337742 [debug] [Thread-2 (]: Finished running node test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a
[0m01:31:21.340617 [debug] [Thread-1 (]: Began running node model.data_project_1.stg_air_quality_valencia
[0m01:31:21.342485 [info ] [Thread-1 (]: 7 of 7 START sql view model analytics.stg_air_quality_valencia ................. [RUN]
[0m01:31:21.343980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.source_not_null_raw_data_mediciones_fecha_carg.7430f4d198, now model.data_project_1.stg_air_quality_valencia)
[0m01:31:21.345661 [debug] [Thread-1 (]: Began compiling node model.data_project_1.stg_air_quality_valencia
[0m01:31:21.349997 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.stg_air_quality_valencia"
[0m01:31:21.365358 [debug] [Thread-1 (]: Began executing node model.data_project_1.stg_air_quality_valencia
[0m01:31:21.516347 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.stg_air_quality_valencia"
[0m01:31:21.533546 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_air_quality_valencia"
[0m01:31:21.535628 [debug] [Thread-1 (]: On model.data_project_1.stg_air_quality_valencia: BEGIN
[0m01:31:21.537740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:21.554246 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m01:31:21.556659 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_air_quality_valencia"
[0m01:31:21.558701 [debug] [Thread-1 (]: On model.data_project_1.stg_air_quality_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_air_quality_valencia"} */

  create view "data_project_1"."analytics"."stg_air_quality_valencia__dbt_tmp"
    
    
  as (
    -- models/staging/stg_mediciones.sql

WITH source AS (
    -- 1. SelecciÃ³n de la tabla de origen (asumiendo que estÃ¡ en el esquema 'public')
    SELECT
        id,
        nombre_estacion,
        lon,
        lat,
        city,
        no2,
        o3,
        pm10,
        pm25,
        fecha_carg,
        created_at
    FROM "data_project_1"."public"."mediciones" -- Usar la macro source() es la mejor prÃ¡ctica
),

renamed AS (
    SELECT
        -- Claves primarias y forÃ¡neas
        CAST(id AS INTEGER) AS medicion_id,
        
        -- Dimensiones (estandarizaciÃ³n)
        TRIM(nombre_estacion) AS station_name,
        TRIM(LOWER(city)) AS city_name,
        
        -- Hechos (conversiÃ³n de tipos y limpieza de valores)
        CAST(lon AS NUMERIC) AS longitude,
        CAST(lat AS NUMERIC) AS latitude,
        
        -- MÃ©tricas de contaminaciÃ³n (convertir a tipo FLOAT para cÃ¡lculos)
        NULLIF(no2, 0) AS no2_ug_m3, -- Ejemplo: si 0 es un valor nulo/ausente
        NULLIF(o3, 0) AS o3_ug_m3,
        NULLIF(pm10, 0) AS pm10_ug_m3,
        NULLIF(pm25, 0) AS pm25_ug_m3,
        
        -- Timestamps
        fecha_carg AS loaded_at_utc,
        created_at AS created_at_utc
        
    FROM source
)

SELECT * FROM renamed
  );
[0m01:31:21.596405 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.036 seconds
[0m01:31:21.606483 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_air_quality_valencia"
[0m01:31:21.610764 [debug] [Thread-1 (]: On model.data_project_1.stg_air_quality_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_air_quality_valencia"} */
alter table "data_project_1"."analytics"."stg_air_quality_valencia__dbt_tmp" rename to "stg_air_quality_valencia"
[0m01:31:21.615188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m01:31:21.630200 [debug] [Thread-1 (]: On model.data_project_1.stg_air_quality_valencia: COMMIT
[0m01:31:21.638822 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_air_quality_valencia"
[0m01:31:21.640286 [debug] [Thread-1 (]: On model.data_project_1.stg_air_quality_valencia: COMMIT
[0m01:31:21.644099 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:31:21.652678 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."stg_air_quality_valencia__dbt_backup"
[0m01:31:21.659331 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_air_quality_valencia"
[0m01:31:21.660828 [debug] [Thread-1 (]: On model.data_project_1.stg_air_quality_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_air_quality_valencia"} */
drop view if exists "data_project_1"."analytics"."stg_air_quality_valencia__dbt_backup" cascade
[0m01:31:21.664757 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m01:31:21.667413 [debug] [Thread-1 (]: On model.data_project_1.stg_air_quality_valencia: Close
[0m01:31:21.671226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46ae181b-b80e-4235-b68e-f10c5dc0cc94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d097f9dd0>]}
[0m01:31:21.674212 [info ] [Thread-1 (]: 7 of 7 OK created sql view model analytics.stg_air_quality_valencia ............ [[32mCREATE VIEW[0m in 0.33s]
[0m01:31:21.676380 [debug] [Thread-1 (]: Finished running node model.data_project_1.stg_air_quality_valencia
[0m01:31:21.680231 [debug] [MainThread]: Using postgres connection "master"
[0m01:31:21.681656 [debug] [MainThread]: On master: BEGIN
[0m01:31:21.683054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:31:21.694473 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m01:31:21.696191 [debug] [MainThread]: On master: COMMIT
[0m01:31:21.697646 [debug] [MainThread]: Using postgres connection "master"
[0m01:31:21.698851 [debug] [MainThread]: On master: COMMIT
[0m01:31:21.700760 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:31:21.701968 [debug] [MainThread]: On master: Close
[0m01:31:21.703742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:21.705202 [debug] [MainThread]: Connection 'model.data_project_1.stg_air_quality_valencia' was properly closed.
[0m01:31:21.706709 [debug] [MainThread]: Connection 'test.data_project_1.source_unique_schema_ingesta_mediciones_id.34482bfd5a' was properly closed.
[0m01:31:21.708447 [debug] [MainThread]: Connection 'test.data_project_1.source_not_null_raw_data_mediciones_nombre_estacion.01d660d9a0' was properly closed.
[0m01:31:21.710342 [debug] [MainThread]: Connection 'test.data_project_1.source_unique_raw_data_mediciones_id.97427a1f73' was properly closed.
[0m01:31:21.713218 [info ] [MainThread]: 
[0m01:31:21.714839 [info ] [MainThread]: Finished running 6 data tests, 1 view model in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m01:31:21.717747 [debug] [MainThread]: Command end result
[0m01:31:21.779808 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m01:31:21.789157 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m01:31:21.803143 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m01:31:21.804857 [info ] [MainThread]: 
[0m01:31:21.807006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:31:21.808439 [info ] [MainThread]: 
[0m01:31:21.810256 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m01:31:21.812891 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.8926466, "process_in_blocks": "152", "process_kernel_time": 1.142154, "process_mem_max_rss": "134764", "process_out_blocks": "0", "process_user_time": 4.841131}
[0m01:31:21.814546 [debug] [MainThread]: Command `dbt build` succeeded at 01:31:21.814351 after 3.89 seconds
[0m01:31:21.815922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d10402f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d10713910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705d0a379250>]}
[0m01:31:21.817611 [debug] [MainThread]: Flushing usage events
[0m01:31:22.416542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:46:22.882899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f8e1833f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f8e183bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f8e1c585d0>]}


============================== 01:46:22.892187 | e0638b42-1a81-481a-82a5-504e82bb923b ==============================
[0m01:46:22.892187 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:46:22.893986 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'invocation_command': 'dbt deps', 'printer_width': '80', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'cache_selected_only': 'False', 'empty': 'None', 'profiles_dir': '/usr/app/dbt', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False', 'target_path': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'version_check': 'True', 'warn_error': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:46:23.006022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0638b42-1a81-481a-82a5-504e82bb923b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f8e17e5d50>]}
[0m01:46:23.034717 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:46:23.050465 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:46:23.054039 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.26215333, "process_in_blocks": "12184", "process_kernel_time": 0.436196, "process_mem_max_rss": "104488", "process_out_blocks": "0", "process_user_time": 1.431516}
[0m01:46:23.055467 [debug] [MainThread]: Command `dbt deps` succeeded at 01:46:23.055329 after 0.26 seconds
[0m01:46:23.056556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f8e1829290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f8e1833550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f8e1833450>]}
[0m01:46:23.057721 [debug] [MainThread]: Flushing usage events
[0m01:46:23.692438 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:46:25.575629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4fc9a9ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4fc9eb8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4fc9a9fd10>]}


============================== 01:46:25.582378 | 96500ae4-84d8-40fe-a3c3-3f9bdeb058bd ==============================
[0m01:46:25.582378 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:46:25.584849 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt build --target dev', 'fail_fast': 'False', 'debug': 'False', 'write_json': 'True', 'profiles_dir': '/usr/app/dbt', 'empty': 'False', 'log_path': '/usr/app/dbt/logs', 'quiet': 'False', 'warn_error': 'None', 'use_colors': 'True', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_format': 'default', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'indirect_selection': 'eager'}
[0m01:46:25.760276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96500ae4-84d8-40fe-a3c3-3f9bdeb058bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4fc8757250>]}
[0m01:46:25.827621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96500ae4-84d8-40fe-a3c3-3f9bdeb058bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4fcc7c4fd0>]}
[0m01:46:25.833738 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:46:25.898946 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m01:46:26.196574 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading data_project_1: intermediate/schema.yml - Runtime Error
    Contents of file 'models/intermediate/schema.yml' are not valid. Dictionary expected.
[0m01:46:26.199903 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.69682163, "process_in_blocks": "2960", "process_kernel_time": 0.254188, "process_mem_max_rss": "114312", "process_out_blocks": "0", "process_user_time": 1.585654}
[0m01:46:26.201888 [debug] [MainThread]: Command `dbt build` failed at 01:46:26.201717 after 0.70 seconds
[0m01:46:26.203807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4fc9a4f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4fc9a4fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4fc83de410>]}
[0m01:46:26.205354 [debug] [MainThread]: Flushing usage events
[0m01:46:26.693998 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:54:35.506065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fd87c44850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fd84f77910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fd84f23f50>]}


============================== 01:54:35.516276 | 937b19b7-12f7-4424-914a-c4e19edd299e ==============================
[0m01:54:35.516276 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:54:35.518075 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'write_json': 'True', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_path': '/usr/app/dbt/logs', 'indirect_selection': 'eager', 'target_path': 'None', 'introspect': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'debug': 'False', 'static_parser': 'True', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False'}
[0m01:54:35.636358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '937b19b7-12f7-4424-914a-c4e19edd299e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fd84e5af50>]}
[0m01:54:35.652796 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:54:35.671133 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:54:35.674641 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.24850404, "process_in_blocks": "20840", "process_kernel_time": 0.563603, "process_mem_max_rss": "104180", "process_out_blocks": "0", "process_user_time": 1.433163}
[0m01:54:35.676354 [debug] [MainThread]: Command `dbt deps` succeeded at 01:54:35.676192 after 0.25 seconds
[0m01:54:35.677647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fd84f65390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fd84f23010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72fd89816d10>]}
[0m01:54:35.678921 [debug] [MainThread]: Flushing usage events
[0m01:54:36.411292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:54:38.277152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaf8bc529d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaf8bc8be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaf8bfb9990>]}


============================== 01:54:38.286731 | 16a9367c-5557-4930-a2af-307a62ff59df ==============================
[0m01:54:38.286731 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:54:38.289522 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/app/dbt/logs', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'no_print': 'None', 'warn_error': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'quiet': 'False', 'empty': 'False', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/usr/app/dbt', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt build --target dev'}
[0m01:54:38.448784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16a9367c-5557-4930-a2af-307a62ff59df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaf8ad48190>]}
[0m01:54:38.498130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16a9367c-5557-4930-a2af-307a62ff59df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaf8e982090>]}
[0m01:54:38.500336 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:54:38.562956 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m01:54:38.862103 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 6 files added, 2 files changed.
[0m01:54:38.863975 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/staging/strg_mediciones_madrid.sql
[0m01:54:38.865484 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/schema.yml
[0m01:54:38.867009 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/schema.yml
[0m01:54:38.868276 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/marts_mediciones.sql
[0m01:54:38.869551 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/staging/stag_mediciones_valencia..sql
[0m01:54:38.870631 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/int_mediciones_tiempo.sql
[0m01:54:38.872085 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/staging/sources.yml
[0m01:54:38.873244 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/staging/schema.yml
[0m01:54:38.874264 [debug] [MainThread]: Partial parsing: deleted file: data_project_1://models/staging/stg_air_quality_valencia.sql
[0m01:54:39.095750 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'int_mediciones_agregadas' in the 'models' section of file 'models/intermediate/schema.yml'
[0m01:54:39.265454 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'mkt_mediciones_tableau' in the 'models' section of file 'models/marts/schema.yml'
[0m01:54:39.339897 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_valencia' in the 'models' section of file 'models/staging/schema.yml'
[0m01:54:39.343150 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_madrid' in the 'models' section of file 'models/staging/schema.yml'
[0m01:54:39.380229 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.data_project_1.strg_mediciones_madrid' (models/staging/strg_mediciones_madrid.sql) depends on a source named 'raw.mediciones' which was not found
[0m01:54:39.382524 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.1770904, "process_in_blocks": "3200", "process_kernel_time": 0.335738, "process_mem_max_rss": "119532", "process_out_blocks": "0", "process_user_time": 2.026424}
[0m01:54:39.383859 [debug] [MainThread]: Command `dbt build` failed at 01:54:39.383743 after 1.18 seconds
[0m01:54:39.385083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaf6a7a6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaf6a772850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eaf8a99a050>]}
[0m01:54:39.386158 [debug] [MainThread]: Flushing usage events
[0m01:54:39.981610 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:59:46.989548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c2e7788990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c2e775e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c2e773f4d0>]}


============================== 01:59:47.000183 | 7e5bd93e-a80f-4da7-9ea2-a83b161f5b0a ==============================
[0m01:59:47.000183 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:59:47.002368 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'use_colors': 'True', 'log_path': '/usr/app/dbt/logs', 'invocation_command': 'dbt deps', 'warn_error': 'None', 'static_parser': 'True', 'no_print': 'None', 'introspect': 'True', 'version_check': 'True', 'write_json': 'True', 'empty': 'None', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80', 'profiles_dir': '/usr/app/dbt', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False'}
[0m01:59:47.132736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e5bd93e-a80f-4da7-9ea2-a83b161f5b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c2e772d490>]}
[0m01:59:47.146184 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:59:47.180639 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:59:47.185084 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.28503355, "process_in_blocks": "12376", "process_kernel_time": 0.84858, "process_mem_max_rss": "104564", "process_out_blocks": "0", "process_user_time": 1.460537}
[0m01:59:47.186741 [debug] [MainThread]: Command `dbt deps` succeeded at 01:59:47.186528 after 0.29 seconds
[0m01:59:47.188554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c2e7781450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c2ec02eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c2e7bb0650>]}
[0m01:59:47.189871 [debug] [MainThread]: Flushing usage events
[0m01:59:47.861328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:59:49.657655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b9fc448d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b9fc4ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b9fbf6f50>]}


============================== 01:59:49.666450 | 6ef16600-c0b9-43ce-9d85-08b35d1dce84 ==============================
[0m01:59:49.666450 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:59:49.668739 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'introspect': 'True', 'printer_width': '80', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'version_check': 'True', 'invocation_command': 'dbt build --target dev', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'use_colors': 'True'}
[0m01:59:49.821101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ef16600-c0b9-43ce-9d85-08b35d1dce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b9ed23890>]}
[0m01:59:49.883775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ef16600-c0b9-43ce-9d85-08b35d1dce84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ba2952a10>]}
[0m01:59:49.886976 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:59:49.991550 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m01:59:50.290714 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 6 files added, 2 files changed.
[0m01:59:50.292844 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/staging/strg_mediciones_valencia..sql
[0m01:59:50.294742 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/schema.yml
[0m01:59:50.296091 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/staging/strg_mediciones_madrid.sql
[0m01:59:50.297360 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/schema.yml
[0m01:59:50.298645 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/int_mediciones_tiempo.sql
[0m01:59:50.299985 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/marts_mediciones.sql
[0m01:59:50.301339 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/staging/sources.yml
[0m01:59:50.302532 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/staging/schema.yml
[0m01:59:50.304294 [debug] [MainThread]: Partial parsing: deleted file: data_project_1://models/staging/stg_air_quality_valencia.sql
[0m01:59:50.772733 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'strg_mediciones_valencia' in the 'models' section of file 'models/staging/schema.yml'
[0m01:59:50.807297 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.data_project_1.strg_mediciones_valencia.' (models/staging/strg_mediciones_valencia..sql) depends on a source named 'raw.mediciones' which was not found
[0m01:59:50.809435 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2248753, "process_in_blocks": "3000", "process_kernel_time": 0.332265, "process_mem_max_rss": "119724", "process_out_blocks": "0", "process_user_time": 2.021279}
[0m01:59:50.811059 [debug] [MainThread]: Command `dbt build` failed at 01:59:50.810951 after 1.23 seconds
[0m01:59:50.812022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9ba4512bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b9d96c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9b9fd8c410>]}
[0m01:59:50.813408 [debug] [MainThread]: Flushing usage events
[0m01:59:51.374082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:24.188370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d367bb17990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d367baca1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d367bb1ff90>]}


============================== 02:03:24.198515 | 64563983-1138-47e7-96df-99277afa241f ==============================
[0m02:03:24.198515 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:03:24.200425 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'partial_parse': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'no_print': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'fail_fast': 'False', 'quiet': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None'}
[0m02:03:24.306541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64563983-1138-47e7-96df-99277afa241f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d367baaa050>]}
[0m02:03:24.331151 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:03:24.344479 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:03:24.347291 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.22930431, "process_in_blocks": "16840", "process_kernel_time": 0.861909, "process_mem_max_rss": "104100", "process_out_blocks": "0", "process_user_time": 1.646572}
[0m02:03:24.348957 [debug] [MainThread]: Command `dbt deps` succeeded at 02:03:24.348817 after 0.23 seconds
[0m02:03:24.350210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d367bb0d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d367bab8bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d367b9f4190>]}
[0m02:03:24.351610 [debug] [MainThread]: Flushing usage events
[0m02:03:25.049179 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:03:26.940963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58d8fb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58d8f81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58d8fbad0>]}


============================== 02:03:26.949341 | 7d2c7340-c17f-46b6-bef8-cd6fa9535626 ==============================
[0m02:03:26.949341 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:03:26.951795 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --target dev', 'profiles_dir': '/usr/app/dbt', 'write_json': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'warn_error': 'None', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'version_check': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'introspect': 'True', 'use_experimental_parser': 'False'}
[0m02:03:27.107474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d2c7340-c17f-46b6-bef8-cd6fa9535626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58e8cc9d0>]}
[0m02:03:27.158476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d2c7340-c17f-46b6-bef8-cd6fa9535626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff590622e50>]}
[0m02:03:27.161961 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:03:27.247671 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m02:03:27.608147 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 6 files added, 2 files changed.
[0m02:03:27.611038 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/staging/strg_mediciones_madrid.sql
[0m02:03:27.613133 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/int_mediciones_tiempo.sql
[0m02:03:27.614803 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/marts_mediciones.sql
[0m02:03:27.616484 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/schema.yml
[0m02:03:27.618280 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/staging/strg_mediciones_valencia..sql
[0m02:03:27.620458 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/schema.yml
[0m02:03:27.622506 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/staging/sources.yml
[0m02:03:27.624411 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/staging/schema.yml
[0m02:03:27.626288 [debug] [MainThread]: Partial parsing: deleted file: data_project_1://models/staging/stg_air_quality_valencia.sql
[0m02:03:28.073009 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_mediciones_madrid' in the 'models' section of file 'models/staging/schema.yml'
[0m02:03:28.076401 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_mediciones_valencia' in the 'models' section of file 'models/staging/schema.yml'
[0m02:03:28.110796 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.data_project_1.int_mediciones_tiempo' (models/intermediate/int_mediciones_tiempo.sql) depends on a node named 'stg_mediciones_valencia' which was not found
[0m02:03:28.113078 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2440578, "process_in_blocks": "2776", "process_kernel_time": 0.360011, "process_mem_max_rss": "120340", "process_out_blocks": "0", "process_user_time": 2.037429}
[0m02:03:28.114925 [debug] [MainThread]: Command `dbt build` failed at 02:03:28.114638 after 1.25 seconds
[0m02:03:28.116433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58b929050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58b9b9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58b979a90>]}
[0m02:03:28.117625 [debug] [MainThread]: Flushing usage events
[0m02:03:28.677665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:12:06.528637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e3242cb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e32427fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e32427f990>]}


============================== 02:12:06.537273 | 4e70bd20-0f9f-4af3-b5e0-3c89dea67a7e ==============================
[0m02:12:06.537273 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:12:06.539469 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'target_path': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'log_format': 'default', 'write_json': 'True', 'debug': 'False', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'printer_width': '80', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'log_cache_events': 'False', 'profiles_dir': '/usr/app/dbt', 'warn_error': 'None'}
[0m02:12:06.674866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e70bd20-0f9f-4af3-b5e0-3c89dea67a7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e3241942d0>]}
[0m02:12:06.689061 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:12:06.870377 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:12:06.877471 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.43857276, "process_in_blocks": "18840", "process_kernel_time": 0.868298, "process_mem_max_rss": "105400", "process_out_blocks": "0", "process_user_time": 1.607362}
[0m02:12:06.879787 [debug] [MainThread]: Command `dbt deps` succeeded at 02:12:06.879457 after 0.44 seconds
[0m02:12:06.883901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e3242c17d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e32540f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e328ad3090>]}
[0m02:12:06.886290 [debug] [MainThread]: Flushing usage events
[0m02:12:07.520518 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:12:09.566631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78530df0b150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78530df63d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78530e235a50>]}


============================== 02:12:09.576676 | ffca559d-8974-4195-934a-3c642480835c ==============================
[0m02:12:09.576676 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:12:09.578456 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'partial_parse': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --target dev', 'write_json': 'True', 'debug': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'static_parser': 'True', 'warn_error': 'None', 'no_print': 'None', 'quiet': 'False', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'use_colors': 'True', 'target_path': 'None'}
[0m02:12:09.724232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffca559d-8974-4195-934a-3c642480835c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78530de97910>]}
[0m02:12:09.770765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffca559d-8974-4195-934a-3c642480835c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785310c58fd0>]}
[0m02:12:09.773089 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:12:09.840449 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m02:12:10.119548 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 2 files changed.
[0m02:12:10.122593 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/staging/stg_mediciones_madrid.sql
[0m02:12:10.124893 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/staging/stg_mediciones_valencia.sql
[0m02:12:10.127397 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/staging/sources.yml
[0m02:12:10.130008 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/staging/schema.yml
[0m02:12:10.131533 [debug] [MainThread]: Partial parsing: deleted file: data_project_1://models/staging/stg_air_quality_valencia.sql
[0m02:12:10.661535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffca559d-8974-4195-934a-3c642480835c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7853107c2a50>]}
[0m02:12:10.766102 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m02:12:10.777811 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m02:12:10.841686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffca559d-8974-4195-934a-3c642480835c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785308937f50>]}
[0m02:12:10.843108 [info ] [MainThread]: Found 2 models, 8 data tests, 1 source, 459 macros
[0m02:12:10.846520 [info ] [MainThread]: 
[0m02:12:10.847854 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:12:10.849163 [info ] [MainThread]: 
[0m02:12:10.850882 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:12:10.857716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1'
[0m02:12:10.921756 [debug] [ThreadPool]: Using postgres connection "list_data_project_1"
[0m02:12:10.923357 [debug] [ThreadPool]: On list_data_project_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1"} */

    select distinct nspname from pg_namespace
  
[0m02:12:10.924455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:12:10.948211 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m02:12:10.951134 [debug] [ThreadPool]: On list_data_project_1: Close
[0m02:12:10.954336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_project_1, now list_data_project_1_analytics)
[0m02:12:10.962407 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_analytics"
[0m02:12:10.968513 [debug] [ThreadPool]: On list_data_project_1_analytics: BEGIN
[0m02:12:10.973161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:12:10.988827 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m02:12:10.991063 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_analytics"
[0m02:12:10.993441 [debug] [ThreadPool]: On list_data_project_1_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1_analytics"} */
select
      'data_project_1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'data_project_1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'data_project_1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m02:12:11.036925 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.042 seconds
[0m02:12:11.039359 [debug] [ThreadPool]: On list_data_project_1_analytics: ROLLBACK
[0m02:12:11.040914 [debug] [ThreadPool]: On list_data_project_1_analytics: Close
[0m02:12:11.046923 [debug] [MainThread]: Using postgres connection "master"
[0m02:12:11.048354 [debug] [MainThread]: On master: BEGIN
[0m02:12:11.049875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:12:11.058427 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m02:12:11.062255 [debug] [MainThread]: Using postgres connection "master"
[0m02:12:11.063549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:12:11.089553 [debug] [MainThread]: SQL status: SELECT 1 in 0.025 seconds
[0m02:12:11.091636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffca559d-8974-4195-934a-3c642480835c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785308952250>]}
[0m02:12:11.093298 [debug] [MainThread]: On master: ROLLBACK
[0m02:12:11.094756 [debug] [MainThread]: Using postgres connection "master"
[0m02:12:11.095821 [debug] [MainThread]: On master: BEGIN
[0m02:12:11.097493 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:12:11.098679 [debug] [MainThread]: On master: COMMIT
[0m02:12:11.099359 [debug] [MainThread]: Using postgres connection "master"
[0m02:12:11.100071 [debug] [MainThread]: On master: COMMIT
[0m02:12:11.101560 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:12:11.102522 [debug] [MainThread]: On master: Close
[0m02:12:11.111384 [debug] [Thread-1 (]: Began running node model.data_project_1.stg_mediciones_madrid
[0m02:12:11.111790 [debug] [Thread-2 (]: Began running node model.data_project_1.stg_mediciones_valencia
[0m02:12:11.113274 [info ] [Thread-1 (]: 1 of 10 START sql view model analytics.stg_mediciones_madrid ................... [RUN]
[0m02:12:11.114999 [info ] [Thread-2 (]: 2 of 10 START sql view model analytics.stg_mediciones_valencia ................. [RUN]
[0m02:12:11.116667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_project_1_analytics, now model.data_project_1.stg_mediciones_madrid)
[0m02:12:11.118298 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.data_project_1.stg_mediciones_valencia'
[0m02:12:11.119613 [debug] [Thread-1 (]: Began compiling node model.data_project_1.stg_mediciones_madrid
[0m02:12:11.121001 [debug] [Thread-2 (]: Began compiling node model.data_project_1.stg_mediciones_valencia
[0m02:12:11.129731 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_madrid"
[0m02:12:11.133149 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_valencia"
[0m02:12:11.146328 [debug] [Thread-1 (]: Began executing node model.data_project_1.stg_mediciones_madrid
[0m02:12:11.171827 [debug] [Thread-2 (]: Began executing node model.data_project_1.stg_mediciones_valencia
[0m02:12:11.174871 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_madrid"
[0m02:12:11.179546 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_valencia"
[0m02:12:11.188729 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m02:12:11.190386 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: BEGIN
[0m02:12:11.192024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:11.193316 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m02:12:11.195001 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: BEGIN
[0m02:12:11.196537 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m02:12:11.203019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:12:11.205567 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m02:12:11.206907 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m02:12:11.208023 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */

  create view "data_project_1"."analytics"."stg_mediciones_madrid__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'madrid' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='madrid'
  );
[0m02:12:11.209462 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m02:12:11.212531 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */

  create view "data_project_1"."analytics"."stg_mediciones_valencia__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'valencia' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='valencia'
  );
[0m02:12:11.247939 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.034 seconds
[0m02:12:11.248480 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.037 seconds
[0m02:12:11.257977 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m02:12:11.261867 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m02:12:11.263334 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."analytics"."stg_mediciones_valencia__dbt_tmp" rename to "stg_mediciones_valencia"
[0m02:12:11.264802 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."analytics"."stg_mediciones_madrid__dbt_tmp" rename to "stg_mediciones_madrid"
[0m02:12:11.270154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m02:12:11.270732 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m02:12:11.281819 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m02:12:11.284139 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m02:12:11.286311 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m02:12:11.288569 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m02:12:11.290013 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m02:12:11.291606 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m02:12:11.296953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m02:12:11.297632 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m02:12:11.304396 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."stg_mediciones_madrid__dbt_backup"
[0m02:12:11.307237 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."stg_mediciones_valencia__dbt_backup"
[0m02:12:11.312168 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m02:12:11.313523 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m02:12:11.314583 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
drop view if exists "data_project_1"."analytics"."stg_mediciones_madrid__dbt_backup" cascade
[0m02:12:11.315607 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
drop view if exists "data_project_1"."analytics"."stg_mediciones_valencia__dbt_backup" cascade
[0m02:12:11.327760 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.010 seconds
[0m02:12:11.328421 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.012 seconds
[0m02:12:11.332082 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: Close
[0m02:12:11.335253 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: Close
[0m02:12:11.338897 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffca559d-8974-4195-934a-3c642480835c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852c3ef4e10>]}
[0m02:12:11.340395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffca559d-8974-4195-934a-3c642480835c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7852c3daee50>]}
[0m02:12:11.342131 [info ] [Thread-2 (]: 2 of 10 OK created sql view model analytics.stg_mediciones_valencia ............ [[32mCREATE VIEW[0m in 0.22s]
[0m02:12:11.344302 [info ] [Thread-1 (]: 1 of 10 OK created sql view model analytics.stg_mediciones_madrid .............. [[32mCREATE VIEW[0m in 0.22s]
[0m02:12:11.345776 [debug] [Thread-2 (]: Finished running node model.data_project_1.stg_mediciones_valencia
[0m02:12:11.346905 [debug] [Thread-1 (]: Finished running node model.data_project_1.stg_mediciones_madrid
[0m02:12:11.348655 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m02:12:11.349232 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m02:12:11.349849 [debug] [Thread-2 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m02:12:11.350425 [debug] [Thread-1 (]: Began running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m02:12:11.352013 [info ] [Thread-4 (]: 3 of 10 START test not_null_stg_mediciones_valencia_fecha_carg ................. [RUN]
[0m02:12:11.353714 [info ] [Thread-3 (]: 4 of 10 START test not_null_stg_mediciones_valencia_id ......................... [RUN]
[0m02:12:11.355464 [info ] [Thread-2 (]: 5 of 10 START test not_null_stg_mediciones_valencia_nombre_estacion ............ [RUN]
[0m02:12:11.357078 [info ] [Thread-1 (]: 6 of 10 START test unique_stg_mediciones_valencia_id ........................... [RUN]
[0m02:12:11.358519 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e'
[0m02:12:11.359939 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e'
[0m02:12:11.361496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_valencia, now test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046)
[0m02:12:11.363030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_madrid, now test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170)
[0m02:12:11.364316 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m02:12:11.365571 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m02:12:11.366965 [debug] [Thread-2 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m02:12:11.368728 [debug] [Thread-1 (]: Began compiling node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m02:12:11.380239 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m02:12:11.385314 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m02:12:11.393932 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m02:12:11.401611 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m02:12:11.413189 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m02:12:11.435133 [debug] [Thread-1 (]: Began executing node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m02:12:11.441773 [debug] [Thread-2 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m02:12:11.442662 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m02:12:11.449349 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m02:12:11.449081 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m02:12:11.453957 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m02:12:11.460011 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m02:12:11.474232 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m02:12:11.476493 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: BEGIN
[0m02:12:11.478123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:12:11.478885 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m02:12:11.481620 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m02:12:11.482883 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: BEGIN
[0m02:12:11.485017 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m02:12:11.485705 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: BEGIN
[0m02:12:11.487311 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:12:11.489110 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: BEGIN
[0m02:12:11.491082 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m02:12:11.493255 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m02:12:11.493705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:11.496284 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m02:12:11.498969 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."analytics"."stg_mediciones_valencia"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m02:12:11.503908 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m02:12:11.505940 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m02:12:11.507355 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m02:12:11.507875 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."analytics"."stg_mediciones_valencia"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m02:12:11.508553 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m02:12:11.509049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m02:12:11.509981 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m02:12:11.513958 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: ROLLBACK
[0m02:12:11.514300 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:12:11.515196 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m02:12:11.516338 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."analytics"."stg_mediciones_valencia"
where id is null



  
  
      
    ) dbt_internal_test
[0m02:12:11.517936 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: Close
[0m02:12:11.520830 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: ROLLBACK
[0m02:12:11.522459 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."analytics"."stg_mediciones_valencia"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:12:11.525533 [info ] [Thread-2 (]: 5 of 10 PASS not_null_stg_mediciones_valencia_nombre_estacion .................. [[32mPASS[0m in 0.16s]
[0m02:12:11.526465 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:12:11.527065 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: Close
[0m02:12:11.529724 [debug] [Thread-2 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m02:12:11.532801 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: ROLLBACK
[0m02:12:11.535119 [info ] [Thread-4 (]: 3 of 10 PASS not_null_stg_mediciones_valencia_fecha_carg ....................... [[32mPASS[0m in 0.18s]
[0m02:12:11.536766 [debug] [Thread-2 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m02:12:11.538642 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: Close
[0m02:12:11.539647 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m02:12:11.539971 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m02:12:11.540723 [info ] [Thread-2 (]: 7 of 10 START test not_null_stg_mediciones_madrid_fecha_carg ................... [RUN]
[0m02:12:11.542101 [info ] [Thread-3 (]: 4 of 10 PASS not_null_stg_mediciones_valencia_id ............................... [[32mPASS[0m in 0.18s]
[0m02:12:11.543129 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m02:12:11.545944 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: ROLLBACK
[0m02:12:11.547069 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046, now test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf)
[0m02:12:11.548211 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m02:12:11.549246 [info ] [Thread-4 (]: 8 of 10 START test not_null_stg_mediciones_madrid_id ........................... [RUN]
[0m02:12:11.551028 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: Close
[0m02:12:11.552535 [debug] [Thread-2 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m02:12:11.554438 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m02:12:11.555674 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e, now test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515)
[0m02:12:11.557386 [info ] [Thread-1 (]: 6 of 10 PASS unique_stg_mediciones_valencia_id ................................. [[32mPASS[0m in 0.19s]
[0m02:12:11.562262 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m02:12:11.563678 [info ] [Thread-3 (]: 9 of 10 START test not_null_stg_mediciones_madrid_nombre_estacion .............. [RUN]
[0m02:12:11.565158 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m02:12:11.566470 [debug] [Thread-1 (]: Finished running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m02:12:11.569886 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e, now test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2)
[0m02:12:11.574505 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m02:12:11.576066 [debug] [Thread-1 (]: Began running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m02:12:11.577497 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m02:12:11.580707 [debug] [Thread-2 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m02:12:11.580253 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_mediciones_madrid_id ............................ [RUN]
[0m02:12:11.588330 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m02:12:11.592181 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m02:12:11.594338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170, now test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c)
[0m02:12:11.594988 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m02:12:11.597554 [debug] [Thread-1 (]: Began compiling node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m02:12:11.600515 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m02:12:11.604567 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m02:12:11.608246 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m02:12:11.609321 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m02:12:11.610502 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: BEGIN
[0m02:12:11.613635 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m02:12:11.614224 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m02:12:11.615146 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:12:11.617922 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: BEGIN
[0m02:12:11.621131 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:12:11.622806 [debug] [Thread-1 (]: Began executing node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m02:12:11.629172 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m02:12:11.630257 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m02:12:11.631393 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m02:12:11.632070 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m02:12:11.632959 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m02:12:11.635159 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m02:12:11.636692 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: BEGIN
[0m02:12:11.637990 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."analytics"."stg_mediciones_madrid"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m02:12:11.639206 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."analytics"."stg_mediciones_madrid"
where id is null



  
  
      
    ) dbt_internal_test
[0m02:12:11.640719 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:12:11.644136 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m02:12:11.644720 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:12:11.645186 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:12:11.646108 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: BEGIN
[0m02:12:11.648163 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: ROLLBACK
[0m02:12:11.651119 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: ROLLBACK
[0m02:12:11.652096 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m02:12:11.652575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:11.654492 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: Close
[0m02:12:11.655596 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: Close
[0m02:12:11.656564 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m02:12:11.658581 [info ] [Thread-2 (]: 7 of 10 PASS not_null_stg_mediciones_madrid_fecha_carg ......................... [[32mPASS[0m in 0.11s]
[0m02:12:11.659762 [info ] [Thread-4 (]: 8 of 10 PASS not_null_stg_mediciones_madrid_id ................................. [[32mPASS[0m in 0.10s]
[0m02:12:11.660868 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."analytics"."stg_mediciones_madrid"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m02:12:11.662795 [debug] [Thread-2 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m02:12:11.664040 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m02:12:11.665490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m02:12:11.667074 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m02:12:11.668848 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m02:12:11.671071 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: ROLLBACK
[0m02:12:11.672092 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."analytics"."stg_mediciones_madrid"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m02:12:11.673381 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: Close
[0m02:12:11.675076 [info ] [Thread-3 (]: 9 of 10 PASS not_null_stg_mediciones_madrid_nombre_estacion .................... [[32mPASS[0m in 0.11s]
[0m02:12:11.676743 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m02:12:11.677517 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m02:12:11.680824 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: ROLLBACK
[0m02:12:11.683325 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: Close
[0m02:12:11.686785 [info ] [Thread-1 (]: 10 of 10 PASS unique_stg_mediciones_madrid_id .................................. [[32mPASS[0m in 0.09s]
[0m02:12:11.689983 [debug] [Thread-1 (]: Finished running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m02:12:11.695779 [debug] [MainThread]: Using postgres connection "master"
[0m02:12:11.703580 [debug] [MainThread]: On master: BEGIN
[0m02:12:11.705324 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:12:11.713351 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m02:12:11.714622 [debug] [MainThread]: On master: COMMIT
[0m02:12:11.715490 [debug] [MainThread]: Using postgres connection "master"
[0m02:12:11.716713 [debug] [MainThread]: On master: COMMIT
[0m02:12:11.718286 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:12:11.719798 [debug] [MainThread]: On master: Close
[0m02:12:11.720824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:12:11.721996 [debug] [MainThread]: Connection 'test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c' was properly closed.
[0m02:12:11.723088 [debug] [MainThread]: Connection 'test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf' was properly closed.
[0m02:12:11.723995 [debug] [MainThread]: Connection 'test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515' was properly closed.
[0m02:12:11.724745 [debug] [MainThread]: Connection 'test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2' was properly closed.
[0m02:12:11.725787 [info ] [MainThread]: 
[0m02:12:11.726877 [info ] [MainThread]: Finished running 8 data tests, 2 view models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m02:12:11.728571 [debug] [MainThread]: Command end result
[0m02:12:11.776678 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m02:12:11.786523 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m02:12:11.804321 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m02:12:11.806676 [info ] [MainThread]: 
[0m02:12:11.808626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:12:11.810432 [info ] [MainThread]: 
[0m02:12:11.812086 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m02:12:11.815085 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.337344, "process_in_blocks": "4736", "process_kernel_time": 0.478758, "process_mem_max_rss": "134004", "process_out_blocks": "0", "process_user_time": 2.668488}
[0m02:12:11.817539 [debug] [MainThread]: Command `dbt build` succeeded at 02:12:11.817318 after 2.34 seconds
[0m02:12:11.819283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78530df5bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78530df5b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7853127e78d0>]}
[0m02:12:11.820868 [debug] [MainThread]: Flushing usage events
[0m02:12:12.394543 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:19:00.751623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758e49c97a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758e49c97bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758e49c97350>]}


============================== 02:19:00.759443 | 75bbe8fd-bcc2-45a0-9f3e-1812c908bfe3 ==============================
[0m02:19:00.759443 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:19:00.761272 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'fail_fast': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'version_check': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'quiet': 'False', 'warn_error': 'None', 'debug': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'None', 'write_json': 'True', 'profiles_dir': '/usr/app/dbt', 'log_format': 'default', 'log_path': '/usr/app/dbt/logs', 'introspect': 'True', 'cache_selected_only': 'False'}
[0m02:19:00.863803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75bbe8fd-bcc2-45a0-9f3e-1812c908bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758e4a0ad310>]}
[0m02:19:00.910547 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:19:00.944033 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:19:00.949602 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.26582316, "process_in_blocks": "14744", "process_kernel_time": 0.572679, "process_mem_max_rss": "104444", "process_out_blocks": "0", "process_user_time": 1.488159}
[0m02:19:00.952250 [debug] [MainThread]: Command `dbt deps` succeeded at 02:19:00.952012 after 0.27 seconds
[0m02:19:00.954836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758e49c8d110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758e49c96350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758e49c971d0>]}
[0m02:19:00.957445 [debug] [MainThread]: Flushing usage events
[0m02:19:01.594519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:19:03.459324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd0386fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd03c885d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd0386ca50>]}


============================== 02:19:03.465639 | 9b07ddb1-a00d-46a8-abbb-227a794b4aaf ==============================
[0m02:19:03.465639 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:19:03.472360 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'empty': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'debug': 'False', 'invocation_command': 'dbt build --target dev', 'use_colors': 'True', 'write_json': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'profiles_dir': '/usr/app/dbt', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'quiet': 'False', 'target_path': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m02:19:03.632090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b07ddb1-a00d-46a8-abbb-227a794b4aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd0251ccd0>]}
[0m02:19:03.722825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b07ddb1-a00d-46a8-abbb-227a794b4aaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd06596f10>]}
[0m02:19:03.725359 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:19:03.793732 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m02:19:04.032694 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading data_project_1: marts/schema.yml - Runtime Error
    Contents of file 'models/marts/schema.yml' are not valid. Dictionary expected.
[0m02:19:04.035063 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.64569426, "process_in_blocks": "2808", "process_kernel_time": 0.280422, "process_mem_max_rss": "114292", "process_out_blocks": "0", "process_user_time": 1.617511}
[0m02:19:04.036826 [debug] [MainThread]: Command `dbt build` failed at 02:19:04.036674 after 0.65 seconds
[0m02:19:04.037956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd0381fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd01916350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bd080771d0>]}
[0m02:19:04.039441 [debug] [MainThread]: Flushing usage events
[0m02:19:04.575159 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:47:12.358575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750af5bc0450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750af5f1d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750af5b77b10>]}


============================== 09:47:12.385258 | 10787f37-b9cc-40de-bc76-18a6ac8d52ae ==============================
[0m09:47:12.385258 [info ] [MainThread]: Running with dbt=1.10.15
[0m09:47:12.387468 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'use_colors': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt deps', 'empty': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False'}
[0m09:47:12.650764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10787f37-b9cc-40de-bc76-18a6ac8d52ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750af5b64090>]}
[0m09:47:12.693540 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:47:12.716507 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:47:12.723522 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5135434, "process_in_blocks": "0", "process_kernel_time": 1.541448, "process_mem_max_rss": "104512", "process_out_blocks": "0", "process_user_time": 3.944176}
[0m09:47:12.727766 [debug] [MainThread]: Command `dbt deps` succeeded at 09:47:12.727395 after 0.52 seconds
[0m09:47:12.730291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750af5bc3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750af5bb9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750afa48ae10>]}
[0m09:47:12.732539 [debug] [MainThread]: Flushing usage events
[0m09:47:13.737725 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:47:18.705641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9b2603890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9b26038d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9b2603990>]}


============================== 09:47:18.719085 | 4067db8f-eff8-4b51-82f4-36d92c0db8d6 ==============================
[0m09:47:18.719085 [info ] [MainThread]: Running with dbt=1.10.15
[0m09:47:18.722292 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'partial_parse': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'use_colors': 'True', 'profiles_dir': '/usr/app/dbt', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'introspect': 'True', 'quiet': 'False', 'warn_error': 'None', 'target_path': 'None', 'empty': 'False', 'invocation_command': 'dbt build --target dev', 'printer_width': '80'}
[0m09:47:19.114034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4067db8f-eff8-4b51-82f4-36d92c0db8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9b2593390>]}
[0m09:47:19.283055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4067db8f-eff8-4b51-82f4-36d92c0db8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9b5326c10>]}
[0m09:47:19.286772 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:47:19.441044 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m09:47:19.799085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:47:19.801851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:47:19.886723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4067db8f-eff8-4b51-82f4-36d92c0db8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9b0934090>]}
[0m09:47:20.126850 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m09:47:20.143860 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m09:47:20.238778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4067db8f-eff8-4b51-82f4-36d92c0db8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9b01268d0>]}
[0m09:47:20.241163 [info ] [MainThread]: Found 2 models, 8 data tests, 1 source, 459 macros
[0m09:47:20.249945 [info ] [MainThread]: 
[0m09:47:20.252327 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:47:20.254599 [info ] [MainThread]: 
[0m09:47:20.258461 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:47:20.268943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1'
[0m09:47:20.528797 [debug] [ThreadPool]: Using postgres connection "list_data_project_1"
[0m09:47:20.530785 [debug] [ThreadPool]: On list_data_project_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1"} */

    select distinct nspname from pg_namespace
  
[0m09:47:20.532015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:47:20.580481 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.048 seconds
[0m09:47:20.585320 [debug] [ThreadPool]: On list_data_project_1: Close
[0m09:47:20.590967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_project_1, now list_data_project_1_analytics)
[0m09:47:20.603253 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_analytics"
[0m09:47:20.606955 [debug] [ThreadPool]: On list_data_project_1_analytics: BEGIN
[0m09:47:20.612784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:47:20.628162 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m09:47:20.630395 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_analytics"
[0m09:47:20.632578 [debug] [ThreadPool]: On list_data_project_1_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1_analytics"} */
select
      'data_project_1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'data_project_1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'data_project_1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m09:47:20.707224 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.072 seconds
[0m09:47:20.710683 [debug] [ThreadPool]: On list_data_project_1_analytics: ROLLBACK
[0m09:47:20.713045 [debug] [ThreadPool]: On list_data_project_1_analytics: Close
[0m09:47:20.724034 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:20.726541 [debug] [MainThread]: On master: BEGIN
[0m09:47:20.728611 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:47:20.749754 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m09:47:20.752012 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:20.754273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:47:20.829200 [debug] [MainThread]: SQL status: SELECT 3 in 0.071 seconds
[0m09:47:20.836176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4067db8f-eff8-4b51-82f4-36d92c0db8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9b542c950>]}
[0m09:47:20.838650 [debug] [MainThread]: On master: ROLLBACK
[0m09:47:20.841459 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:20.843960 [debug] [MainThread]: On master: BEGIN
[0m09:47:20.849816 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m09:47:20.852736 [debug] [MainThread]: On master: COMMIT
[0m09:47:20.856252 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:20.859723 [debug] [MainThread]: On master: COMMIT
[0m09:47:20.862365 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:47:20.864515 [debug] [MainThread]: On master: Close
[0m09:47:20.881690 [debug] [Thread-1 (]: Began running node model.data_project_1.stg_mediciones_madrid
[0m09:47:20.882898 [debug] [Thread-2 (]: Began running node model.data_project_1.stg_mediciones_valencia
[0m09:47:20.887198 [info ] [Thread-1 (]: 1 of 10 START sql view model analytics.stg_mediciones_madrid ................... [RUN]
[0m09:47:20.891152 [info ] [Thread-2 (]: 2 of 10 START sql view model analytics.stg_mediciones_valencia ................. [RUN]
[0m09:47:20.893708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_project_1_analytics, now model.data_project_1.stg_mediciones_madrid)
[0m09:47:20.895649 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.data_project_1.stg_mediciones_valencia'
[0m09:47:20.897556 [debug] [Thread-1 (]: Began compiling node model.data_project_1.stg_mediciones_madrid
[0m09:47:20.899185 [debug] [Thread-2 (]: Began compiling node model.data_project_1.stg_mediciones_valencia
[0m09:47:20.915557 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_madrid"
[0m09:47:20.922800 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_valencia"
[0m09:47:20.938489 [debug] [Thread-1 (]: Began executing node model.data_project_1.stg_mediciones_madrid
[0m09:47:20.940486 [debug] [Thread-2 (]: Began executing node model.data_project_1.stg_mediciones_valencia
[0m09:47:21.058526 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_madrid"
[0m09:47:21.059220 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_valencia"
[0m09:47:21.081025 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m09:47:21.083329 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m09:47:21.085009 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: BEGIN
[0m09:47:21.087559 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: BEGIN
[0m09:47:21.089778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:21.092562 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:47:21.112552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m09:47:21.114855 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m09:47:21.115614 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m09:47:21.117723 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */

  create view "data_project_1"."analytics"."stg_mediciones_madrid__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'madrid' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='madrid'
  );
[0m09:47:21.120218 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m09:47:21.123676 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */

  create view "data_project_1"."analytics"."stg_mediciones_valencia__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'valencia' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='valencia'
  );
[0m09:47:21.165116 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.042 seconds
[0m09:47:21.166028 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m09:47:21.179603 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m09:47:21.188407 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m09:47:21.190371 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."analytics"."stg_mediciones_madrid" rename to "stg_mediciones_madrid__dbt_backup"
[0m09:47:21.193784 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."analytics"."stg_mediciones_valencia" rename to "stg_mediciones_valencia__dbt_backup"
[0m09:47:21.200981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:47:21.202060 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:47:21.209317 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m09:47:21.216362 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m09:47:21.218856 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."analytics"."stg_mediciones_madrid__dbt_tmp" rename to "stg_mediciones_madrid"
[0m09:47:21.223089 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."analytics"."stg_mediciones_valencia__dbt_tmp" rename to "stg_mediciones_valencia"
[0m09:47:21.229073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:47:21.233612 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:47:21.302170 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m09:47:21.300960 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m09:47:21.305696 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m09:47:21.308727 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m09:47:21.312027 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m09:47:21.314495 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m09:47:21.320584 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:47:21.329228 [debug] [Thread-2 (]: SQL status: COMMIT in 0.010 seconds
[0m09:47:21.343104 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."stg_mediciones_madrid__dbt_backup"
[0m09:47:21.349658 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."stg_mediciones_valencia__dbt_backup"
[0m09:47:21.363662 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m09:47:21.365919 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m09:47:21.369623 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
drop view if exists "data_project_1"."analytics"."stg_mediciones_madrid__dbt_backup" cascade
[0m09:47:21.372193 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
drop view if exists "data_project_1"."analytics"."stg_mediciones_valencia__dbt_backup" cascade
[0m09:47:21.399438 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.024 seconds
[0m09:47:21.416715 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.040 seconds
[0m09:47:21.420162 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: Close
[0m09:47:21.424875 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: Close
[0m09:47:21.435351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4067db8f-eff8-4b51-82f4-36d92c0db8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9b1d5a490>]}
[0m09:47:21.438364 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4067db8f-eff8-4b51-82f4-36d92c0db8d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9b270d310>]}
[0m09:47:21.440843 [info ] [Thread-1 (]: 1 of 10 OK created sql view model analytics.stg_mediciones_madrid .............. [[32mCREATE VIEW[0m in 0.54s]
[0m09:47:21.444837 [info ] [Thread-2 (]: 2 of 10 OK created sql view model analytics.stg_mediciones_valencia ............ [[32mCREATE VIEW[0m in 0.54s]
[0m09:47:21.447644 [debug] [Thread-1 (]: Finished running node model.data_project_1.stg_mediciones_madrid
[0m09:47:21.450418 [debug] [Thread-2 (]: Finished running node model.data_project_1.stg_mediciones_valencia
[0m09:47:21.459628 [debug] [Thread-2 (]: Began running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m09:47:21.457394 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m09:47:21.458465 [debug] [Thread-1 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m09:47:21.455663 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m09:47:21.463105 [info ] [Thread-2 (]: 6 of 10 START test unique_stg_mediciones_madrid_id ............................. [RUN]
[0m09:47:21.465646 [info ] [Thread-3 (]: 4 of 10 START test not_null_stg_mediciones_madrid_id ........................... [RUN]
[0m09:47:21.467776 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_mediciones_madrid_nombre_estacion .............. [RUN]
[0m09:47:21.469910 [info ] [Thread-4 (]: 3 of 10 START test not_null_stg_mediciones_madrid_fecha_carg ................... [RUN]
[0m09:47:21.472165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_valencia, now test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c)
[0m09:47:21.474859 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515'
[0m09:47:21.477790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_madrid, now test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2)
[0m09:47:21.480016 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf'
[0m09:47:21.482168 [debug] [Thread-2 (]: Began compiling node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m09:47:21.484585 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m09:47:21.486930 [debug] [Thread-1 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m09:47:21.489405 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m09:47:21.535965 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m09:47:21.547561 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m09:47:21.557684 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m09:47:21.570831 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m09:47:21.595254 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m09:47:21.600448 [debug] [Thread-1 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m09:47:21.606944 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m09:47:21.616085 [debug] [Thread-2 (]: Began executing node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m09:47:21.657218 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m09:47:21.671895 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m09:47:21.678140 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m09:47:21.685546 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m09:47:21.704709 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m09:47:21.709488 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m09:47:21.710490 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: BEGIN
[0m09:47:21.711431 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m09:47:21.713157 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: BEGIN
[0m09:47:21.714412 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m09:47:21.717627 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:47:21.720254 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: BEGIN
[0m09:47:21.723246 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:47:21.725970 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: BEGIN
[0m09:47:21.730312 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:47:21.738189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:21.747789 [debug] [Thread-4 (]: SQL status: BEGIN in 0.029 seconds
[0m09:47:21.753218 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m09:47:21.755883 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."analytics"."stg_mediciones_madrid"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m09:47:21.760278 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m09:47:21.761331 [debug] [Thread-3 (]: SQL status: BEGIN in 0.038 seconds
[0m09:47:21.768128 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m09:47:21.769150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m09:47:21.771010 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m09:47:21.773539 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."analytics"."stg_mediciones_madrid"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:47:21.777915 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m09:47:21.790562 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."analytics"."stg_mediciones_madrid"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m09:47:21.782981 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."analytics"."stg_mediciones_madrid"
where id is null



  
  
      
    ) dbt_internal_test
[0m09:47:21.781348 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.015 seconds
[0m09:47:21.793778 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m09:47:21.807857 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m09:47:21.809048 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: ROLLBACK
[0m09:47:21.810566 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m09:47:21.814787 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: ROLLBACK
[0m09:47:21.819978 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: ROLLBACK
[0m09:47:21.825114 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: Close
[0m09:47:21.830351 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: ROLLBACK
[0m09:47:21.833633 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: Close
[0m09:47:21.837041 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: Close
[0m09:47:21.840043 [info ] [Thread-4 (]: 3 of 10 PASS not_null_stg_mediciones_madrid_fecha_carg ......................... [[32mPASS[0m in 0.36s]
[0m09:47:21.844558 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: Close
[0m09:47:21.847086 [info ] [Thread-2 (]: 6 of 10 PASS unique_stg_mediciones_madrid_id ................................... [[32mPASS[0m in 0.37s]
[0m09:47:21.849956 [info ] [Thread-3 (]: 4 of 10 PASS not_null_stg_mediciones_madrid_id ................................. [[32mPASS[0m in 0.38s]
[0m09:47:21.852800 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m09:47:21.855508 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_mediciones_madrid_nombre_estacion .................... [[32mPASS[0m in 0.38s]
[0m09:47:21.863899 [debug] [Thread-2 (]: Finished running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m09:47:21.867443 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m09:47:21.873075 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m09:47:21.876701 [debug] [Thread-1 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m09:47:21.879106 [debug] [Thread-2 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m09:47:21.881928 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m09:47:21.886745 [info ] [Thread-4 (]: 7 of 10 START test not_null_stg_mediciones_valencia_fecha_carg ................. [RUN]
[0m09:47:21.889662 [debug] [Thread-1 (]: Began running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m09:47:21.892242 [info ] [Thread-2 (]: 8 of 10 START test not_null_stg_mediciones_valencia_id ......................... [RUN]
[0m09:47:21.895306 [info ] [Thread-3 (]: 9 of 10 START test not_null_stg_mediciones_valencia_nombre_estacion ............ [RUN]
[0m09:47:21.897839 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf, now test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e)
[0m09:47:21.900635 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_mediciones_valencia_id .......................... [RUN]
[0m09:47:21.911206 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c, now test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e)
[0m09:47:21.929528 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515, now test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046)
[0m09:47:21.932117 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m09:47:21.934629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2, now test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170)
[0m09:47:21.936774 [debug] [Thread-2 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m09:47:21.939079 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m09:47:21.954202 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m09:47:21.956021 [debug] [Thread-1 (]: Began compiling node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m09:47:21.966303 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m09:47:21.979760 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m09:47:21.992273 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m09:47:22.005858 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m09:47:22.015568 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m09:47:22.016559 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m09:47:22.017404 [debug] [Thread-2 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m09:47:22.019659 [debug] [Thread-1 (]: Began executing node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m09:47:22.026348 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m09:47:22.035104 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m09:47:22.046607 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m09:47:22.055429 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m09:47:22.060570 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: BEGIN
[0m09:47:22.061693 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m09:47:22.063982 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:47:22.066373 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m09:47:22.068268 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: BEGIN
[0m09:47:22.071128 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m09:47:22.073691 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: BEGIN
[0m09:47:22.081031 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:47:22.083758 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: BEGIN
[0m09:47:22.086441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:47:22.087495 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m09:47:22.093714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:47:22.102735 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m09:47:22.115222 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."analytics"."stg_mediciones_valencia"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m09:47:22.116260 [debug] [Thread-3 (]: SQL status: BEGIN in 0.035 seconds
[0m09:47:22.128680 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m09:47:22.133417 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m09:47:22.137558 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m09:47:22.139039 [debug] [Thread-2 (]: SQL status: BEGIN in 0.053 seconds
[0m09:47:22.148684 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m09:47:22.154351 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: ROLLBACK
[0m09:47:22.160438 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."analytics"."stg_mediciones_valencia"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m09:47:22.164482 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m09:47:22.167529 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."analytics"."stg_mediciones_valencia"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:47:22.170864 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: Close
[0m09:47:22.174421 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."analytics"."stg_mediciones_valencia"
where id is null



  
  
      
    ) dbt_internal_test
[0m09:47:22.176734 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m09:47:22.179909 [info ] [Thread-4 (]: 7 of 10 PASS not_null_stg_mediciones_valencia_fecha_carg ....................... [[32mPASS[0m in 0.28s]
[0m09:47:22.182588 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m09:47:22.187273 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m09:47:22.190251 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: ROLLBACK
[0m09:47:22.194987 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m09:47:22.201906 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: ROLLBACK
[0m09:47:22.209009 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: ROLLBACK
[0m09:47:22.212617 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: Close
[0m09:47:22.216877 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: Close
[0m09:47:22.219483 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: Close
[0m09:47:22.222949 [info ] [Thread-3 (]: 9 of 10 PASS not_null_stg_mediciones_valencia_nombre_estacion .................. [[32mPASS[0m in 0.29s]
[0m09:47:22.225625 [info ] [Thread-1 (]: 10 of 10 PASS unique_stg_mediciones_valencia_id ................................ [[32mPASS[0m in 0.29s]
[0m09:47:22.229362 [info ] [Thread-2 (]: 8 of 10 PASS not_null_stg_mediciones_valencia_id ............................... [[32mPASS[0m in 0.32s]
[0m09:47:22.234563 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m09:47:22.237290 [debug] [Thread-1 (]: Finished running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m09:47:22.240945 [debug] [Thread-2 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m09:47:22.252002 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:22.255681 [debug] [MainThread]: On master: BEGIN
[0m09:47:22.261068 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:47:22.281981 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m09:47:22.284321 [debug] [MainThread]: On master: COMMIT
[0m09:47:22.288866 [debug] [MainThread]: Using postgres connection "master"
[0m09:47:22.291236 [debug] [MainThread]: On master: COMMIT
[0m09:47:22.294263 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:47:22.297488 [debug] [MainThread]: On master: Close
[0m09:47:22.300434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:47:22.306964 [debug] [MainThread]: Connection 'test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170' was properly closed.
[0m09:47:22.309986 [debug] [MainThread]: Connection 'test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e' was properly closed.
[0m09:47:22.312572 [debug] [MainThread]: Connection 'test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046' was properly closed.
[0m09:47:22.314523 [debug] [MainThread]: Connection 'test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e' was properly closed.
[0m09:47:22.316940 [info ] [MainThread]: 
[0m09:47:22.319767 [info ] [MainThread]: Finished running 8 data tests, 2 view models in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m09:47:22.325968 [debug] [MainThread]: Command end result
[0m09:47:22.433746 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m09:47:22.445168 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m09:47:22.464921 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m09:47:22.466669 [info ] [MainThread]: 
[0m09:47:22.468628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:47:22.470483 [info ] [MainThread]: 
[0m09:47:22.472586 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m09:47:22.475649 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.93031, "process_in_blocks": "80", "process_kernel_time": 1.112535, "process_mem_max_rss": "128756", "process_out_blocks": "0", "process_user_time": 6.046386}
[0m09:47:22.478174 [debug] [MainThread]: Command `dbt build` succeeded at 09:47:22.477894 after 3.93 seconds
[0m09:47:22.483416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9b6e07190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9b1968690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9b294dc90>]}
[0m09:47:22.486174 [debug] [MainThread]: Flushing usage events
[0m09:47:23.171399 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:02:20.690968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b45ffadbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b45ff86850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b45ffbbbd0>]}


============================== 10:02:20.701743 | 25f0045a-13d2-4e1b-acaf-2170307a2da6 ==============================
[0m10:02:20.701743 [info ] [MainThread]: Running with dbt=1.10.15
[0m10:02:20.703703 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'target_path': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt deps', 'profiles_dir': '/usr/app/dbt', 'no_print': 'None', 'warn_error': 'None', 'empty': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_path': '/usr/app/dbt/logs', 'printer_width': '80'}
[0m10:02:20.851982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25f0045a-13d2-4e1b-acaf-2170307a2da6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b45ffbb610>]}
[0m10:02:20.871854 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:02:20.894505 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:02:20.900036 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.31626, "process_in_blocks": "23920", "process_kernel_time": 0.794827, "process_mem_max_rss": "103324", "process_out_blocks": "0", "process_user_time": 2.12087}
[0m10:02:20.902366 [debug] [MainThread]: Command `dbt deps` succeeded at 10:02:20.902185 after 0.32 seconds
[0m10:02:20.904862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b45ffa9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b45ff54250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b46487ed10>]}
[0m10:02:20.907191 [debug] [MainThread]: Flushing usage events
[0m10:02:21.619753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:02:24.359683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751c977c3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751c9781f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751c977c2250>]}


============================== 10:02:24.372951 | 78474ff8-3394-4892-b2db-669465d99567 ==============================
[0m10:02:24.372951 [info ] [MainThread]: Running with dbt=1.10.15
[0m10:02:24.377471 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'partial_parse': 'True', 'log_path': '/usr/app/dbt/logs', 'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False', 'invocation_command': 'dbt build --target dev'}
[0m10:02:24.687195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78474ff8-3394-4892-b2db-669465d99567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751c977b4850>]}
[0m10:02:24.801688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78474ff8-3394-4892-b2db-669465d99567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751c9a50d1d0>]}
[0m10:02:24.806640 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:02:24.927497 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m10:02:25.394953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m10:02:25.398468 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/int_madrid_daily_avg.sql
[0m10:02:25.400393 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/schema.yml
[0m10:02:25.401721 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/int_madrid_hourly_avg.sql
[0m10:02:25.403352 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/int_madrid_station_summary.sql
[0m10:02:25.673337 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.data_project_1.int_madrid_daily_avg' (models/intermediate/int_madrid_daily_avg.sql) depends on a node named 'madrid' which was not found
[0m10:02:25.677085 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4525411, "process_in_blocks": "3016", "process_kernel_time": 0.447195, "process_mem_max_rss": "117584", "process_out_blocks": "0", "process_user_time": 2.830905}
[0m10:02:25.680434 [debug] [MainThread]: Command `dbt build` failed at 10:02:25.680062 after 1.46 seconds
[0m10:02:25.683301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751c977b43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751c95f56350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751c95be2090>]}
[0m10:02:25.685440 [debug] [MainThread]: Flushing usage events
[0m10:02:26.509671 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:08:00.812049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d73f642f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d73f5f6ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d73f5f6310>]}


============================== 10:08:00.822584 | 082dbb2b-3d71-4c59-835b-c88674e0b465 ==============================
[0m10:08:00.822584 [info ] [MainThread]: Running with dbt=1.10.15
[0m10:08:00.824626 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'invocation_command': 'dbt deps', 'quiet': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'profiles_dir': '/usr/app/dbt', 'log_format': 'default', 'target_path': 'None', 'log_path': '/usr/app/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:08:01.024216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '082dbb2b-3d71-4c59-835b-c88674e0b465', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d73f550dd0>]}
[0m10:08:01.047238 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:08:01.071190 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:08:01.078066 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35997003, "process_in_blocks": "19496", "process_kernel_time": 0.546393, "process_mem_max_rss": "104500", "process_out_blocks": "0", "process_user_time": 2.137007}
[0m10:08:01.080189 [debug] [MainThread]: Command `dbt deps` succeeded at 10:08:01.079969 after 0.36 seconds
[0m10:08:01.081998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d73f643710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d73f4ec250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d742318710>]}
[0m10:08:01.083402 [debug] [MainThread]: Flushing usage events
[0m10:08:01.974985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:08:04.459033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e73a4febb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e73a4f9bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e73a4f9b5d0>]}


============================== 10:08:04.468649 | f079eacd-c6c5-47df-81a4-0d14d889d569 ==============================
[0m10:08:04.468649 [info ] [MainThread]: Running with dbt=1.10.15
[0m10:08:04.471301 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'warn_error': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_path': '/usr/app/dbt/logs', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --target dev', 'log_cache_events': 'False', 'partial_parse': 'True', 'profiles_dir': '/usr/app/dbt', 'write_json': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'no_print': 'None', 'target_path': 'None', 'log_format': 'default'}
[0m10:08:04.722326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f079eacd-c6c5-47df-81a4-0d14d889d569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e73a4770b10>]}
[0m10:08:04.799574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f079eacd-c6c5-47df-81a4-0d14d889d569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e73a43a5ad0>]}
[0m10:08:04.802618 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:08:04.904041 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m10:08:05.333637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:08:05.336210 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/valencia.sql
[0m10:08:05.664271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f079eacd-c6c5-47df-81a4-0d14d889d569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e73a33c6910>]}
[0m10:08:05.790995 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:08:05.801246 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:08:05.945207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f079eacd-c6c5-47df-81a4-0d14d889d569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e73a60c4b50>]}
[0m10:08:05.947492 [info ] [MainThread]: Found 3 models, 8 data tests, 1 source, 459 macros
[0m10:08:05.953212 [info ] [MainThread]: 
[0m10:08:05.955373 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:08:05.957539 [info ] [MainThread]: 
[0m10:08:05.961931 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:08:05.971003 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1'
[0m10:08:06.060742 [debug] [ThreadPool]: Using postgres connection "list_data_project_1"
[0m10:08:06.062677 [debug] [ThreadPool]: On list_data_project_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1"} */

    select distinct nspname from pg_namespace
  
[0m10:08:06.064335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:06.104711 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.040 seconds
[0m10:08:06.108787 [debug] [ThreadPool]: On list_data_project_1: Close
[0m10:08:06.112863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_project_1, now list_data_project_1_analytics)
[0m10:08:06.122449 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_analytics"
[0m10:08:06.124590 [debug] [ThreadPool]: On list_data_project_1_analytics: BEGIN
[0m10:08:06.126601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:06.142341 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m10:08:06.144592 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_analytics"
[0m10:08:06.146159 [debug] [ThreadPool]: On list_data_project_1_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1_analytics"} */
select
      'data_project_1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'data_project_1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'data_project_1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m10:08:06.217718 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.070 seconds
[0m10:08:06.221135 [debug] [ThreadPool]: On list_data_project_1_analytics: ROLLBACK
[0m10:08:06.223496 [debug] [ThreadPool]: On list_data_project_1_analytics: Close
[0m10:08:06.232629 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:06.234706 [debug] [MainThread]: On master: BEGIN
[0m10:08:06.236649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:08:06.252523 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:08:06.254709 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:06.256810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:08:06.360628 [debug] [MainThread]: SQL status: SELECT 3 in 0.101 seconds
[0m10:08:06.363920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f079eacd-c6c5-47df-81a4-0d14d889d569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e73a7dfc3d0>]}
[0m10:08:06.365901 [debug] [MainThread]: On master: ROLLBACK
[0m10:08:06.367873 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:06.369303 [debug] [MainThread]: On master: BEGIN
[0m10:08:06.371369 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:08:06.372857 [debug] [MainThread]: On master: COMMIT
[0m10:08:06.374793 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:06.376679 [debug] [MainThread]: On master: COMMIT
[0m10:08:06.378571 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:08:06.380019 [debug] [MainThread]: On master: Close
[0m10:08:06.391873 [debug] [Thread-1 (]: Began running node model.data_project_1.stg_mediciones_madrid
[0m10:08:06.392653 [debug] [Thread-2 (]: Began running node model.data_project_1.stg_mediciones_valencia
[0m10:08:06.394603 [info ] [Thread-1 (]: 1 of 11 START sql view model analytics.stg_mediciones_madrid ................... [RUN]
[0m10:08:06.396647 [info ] [Thread-2 (]: 2 of 11 START sql view model analytics.stg_mediciones_valencia ................. [RUN]
[0m10:08:06.398591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_project_1_analytics, now model.data_project_1.stg_mediciones_madrid)
[0m10:08:06.400540 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.data_project_1.stg_mediciones_valencia'
[0m10:08:06.402581 [debug] [Thread-1 (]: Began compiling node model.data_project_1.stg_mediciones_madrid
[0m10:08:06.404236 [debug] [Thread-2 (]: Began compiling node model.data_project_1.stg_mediciones_valencia
[0m10:08:06.415604 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_madrid"
[0m10:08:06.420777 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_valencia"
[0m10:08:06.433782 [debug] [Thread-1 (]: Began executing node model.data_project_1.stg_mediciones_madrid
[0m10:08:06.443470 [debug] [Thread-2 (]: Began executing node model.data_project_1.stg_mediciones_valencia
[0m10:08:06.493856 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_madrid"
[0m10:08:06.496226 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_valencia"
[0m10:08:06.507382 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:08:06.509071 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: BEGIN
[0m10:08:06.509881 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:08:06.511356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:06.513093 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: BEGIN
[0m10:08:06.515663 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:08:06.525666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m10:08:06.527430 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:08:06.528809 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */

  create view "data_project_1"."analytics"."stg_mediciones_madrid__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'madrid' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='madrid'
  );
[0m10:08:06.553155 [debug] [Thread-2 (]: SQL status: BEGIN in 0.037 seconds
[0m10:08:06.555643 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:08:06.557582 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */

  create view "data_project_1"."analytics"."stg_mediciones_valencia__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'valencia' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='valencia'
  );
[0m10:08:06.594611 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.064 seconds
[0m10:08:06.595400 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.036 seconds
[0m10:08:06.604132 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:08:06.608497 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:08:06.610974 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."analytics"."stg_mediciones_madrid" rename to "stg_mediciones_madrid__dbt_backup"
[0m10:08:06.612951 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."analytics"."stg_mediciones_valencia" rename to "stg_mediciones_valencia__dbt_backup"
[0m10:08:06.616826 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:08:06.617267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:08:06.621439 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:08:06.626743 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:08:06.628569 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."analytics"."stg_mediciones_valencia__dbt_tmp" rename to "stg_mediciones_valencia"
[0m10:08:06.630125 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."analytics"."stg_mediciones_madrid__dbt_tmp" rename to "stg_mediciones_madrid"
[0m10:08:06.633068 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:08:06.641607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m10:08:06.654575 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m10:08:06.656403 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m10:08:06.658524 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:08:06.660317 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:08:06.661665 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m10:08:06.663155 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m10:08:06.676878 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m10:08:06.677808 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:08:06.686334 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."stg_mediciones_valencia__dbt_backup"
[0m10:08:06.689834 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."stg_mediciones_madrid__dbt_backup"
[0m10:08:06.699284 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:08:06.701033 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:08:06.702479 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
drop view if exists "data_project_1"."analytics"."stg_mediciones_valencia__dbt_backup" cascade
[0m10:08:06.703714 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
drop view if exists "data_project_1"."analytics"."stg_mediciones_madrid__dbt_backup" cascade
[0m10:08:06.736230 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.031 seconds
[0m10:08:06.739682 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.024 seconds
[0m10:08:06.749351 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: Close
[0m10:08:06.755737 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: Close
[0m10:08:06.760430 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f079eacd-c6c5-47df-81a4-0d14d889d569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e737f040390>]}
[0m10:08:06.762617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f079eacd-c6c5-47df-81a4-0d14d889d569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e737f08ca50>]}
[0m10:08:06.769630 [info ] [Thread-2 (]: 2 of 11 OK created sql view model analytics.stg_mediciones_valencia ............ [[32mCREATE VIEW[0m in 0.36s]
[0m10:08:06.772499 [info ] [Thread-1 (]: 1 of 11 OK created sql view model analytics.stg_mediciones_madrid .............. [[32mCREATE VIEW[0m in 0.36s]
[0m10:08:06.775008 [debug] [Thread-2 (]: Finished running node model.data_project_1.stg_mediciones_valencia
[0m10:08:06.777409 [debug] [Thread-1 (]: Finished running node model.data_project_1.stg_mediciones_madrid
[0m10:08:06.781115 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:08:06.781944 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:08:06.782625 [debug] [Thread-1 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:08:06.783083 [debug] [Thread-2 (]: Began running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:08:06.785659 [info ] [Thread-4 (]: 3 of 11 START test not_null_stg_mediciones_valencia_fecha_carg ................. [RUN]
[0m10:08:06.787716 [info ] [Thread-3 (]: 4 of 11 START test not_null_stg_mediciones_valencia_id ......................... [RUN]
[0m10:08:06.789789 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_mediciones_valencia_nombre_estacion ............ [RUN]
[0m10:08:06.791908 [info ] [Thread-2 (]: 6 of 11 START test unique_stg_mediciones_valencia_id ........................... [RUN]
[0m10:08:06.794125 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e'
[0m10:08:06.796290 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e'
[0m10:08:06.798545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_madrid, now test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046)
[0m10:08:06.800767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_valencia, now test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170)
[0m10:08:06.802713 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:08:06.805257 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:08:06.807294 [debug] [Thread-1 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:08:06.809299 [debug] [Thread-2 (]: Began compiling node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:08:06.832612 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:08:06.839454 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:08:06.848638 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:08:06.858201 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:08:06.873440 [debug] [Thread-1 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:08:06.895883 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:08:06.898309 [debug] [Thread-2 (]: Began executing node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:08:06.898781 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:08:06.899737 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:08:06.903345 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:08:06.908997 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:08:06.913332 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:08:06.916062 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:08:06.919658 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: BEGIN
[0m10:08:06.921087 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:08:06.921764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:06.925817 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:08:06.926567 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: BEGIN
[0m10:08:06.927481 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:08:06.930458 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: BEGIN
[0m10:08:06.932120 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:08:06.934082 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: BEGIN
[0m10:08:06.936025 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:08:06.938981 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:08:06.940588 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:08:06.945211 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:08:06.947308 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."analytics"."stg_mediciones_valencia"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m10:08:06.951318 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m10:08:06.953460 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:08:06.955486 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."analytics"."stg_mediciones_valencia"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:08:06.956158 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m10:08:06.957661 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m10:08:06.959824 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:08:06.961612 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:08:06.962429 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m10:08:06.963977 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."analytics"."stg_mediciones_valencia"
where id is null



  
  
      
    ) dbt_internal_test
[0m10:08:06.965522 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."analytics"."stg_mediciones_valencia"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m10:08:06.966181 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m10:08:06.970701 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: ROLLBACK
[0m10:08:06.977029 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: ROLLBACK
[0m10:08:06.977825 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:08:06.979161 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:08:06.980147 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: Close
[0m10:08:06.981817 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: Close
[0m10:08:06.984439 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: ROLLBACK
[0m10:08:06.987682 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: ROLLBACK
[0m10:08:06.990205 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_mediciones_valencia_nombre_estacion .................. [[32mPASS[0m in 0.19s]
[0m10:08:06.992640 [info ] [Thread-2 (]: 6 of 11 PASS unique_stg_mediciones_valencia_id ................................. [[32mPASS[0m in 0.19s]
[0m10:08:06.994749 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: Close
[0m10:08:06.996086 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: Close
[0m10:08:06.997740 [debug] [Thread-1 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:08:06.999680 [debug] [Thread-2 (]: Finished running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:08:07.002396 [info ] [Thread-3 (]: 4 of 11 PASS not_null_stg_mediciones_valencia_id ............................... [[32mPASS[0m in 0.21s]
[0m10:08:07.004652 [info ] [Thread-4 (]: 3 of 11 PASS not_null_stg_mediciones_valencia_fecha_carg ....................... [[32mPASS[0m in 0.21s]
[0m10:08:07.006526 [debug] [Thread-1 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:08:07.008655 [debug] [Thread-2 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:08:07.010488 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:08:07.012590 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:08:07.014476 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_mediciones_madrid_fecha_carg ................... [RUN]
[0m10:08:07.016141 [info ] [Thread-2 (]: 8 of 11 START test not_null_stg_mediciones_madrid_id ........................... [RUN]
[0m10:08:07.017799 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:08:07.019754 [debug] [Thread-4 (]: Began running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:08:07.021528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046, now test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf)
[0m10:08:07.024017 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170, now test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515)
[0m10:08:07.026232 [info ] [Thread-3 (]: 9 of 11 START test not_null_stg_mediciones_madrid_nombre_estacion .............. [RUN]
[0m10:08:07.028213 [info ] [Thread-4 (]: 10 of 11 START test unique_stg_mediciones_madrid_id ............................ [RUN]
[0m10:08:07.030061 [debug] [Thread-1 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:08:07.032019 [debug] [Thread-2 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:08:07.034153 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e, now test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2)
[0m10:08:07.035963 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e, now test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c)
[0m10:08:07.044302 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:08:07.051017 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:08:07.052803 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:08:07.055038 [debug] [Thread-4 (]: Began compiling node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:08:07.065517 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:08:07.074081 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:08:07.077803 [debug] [Thread-2 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:08:07.086300 [debug] [Thread-1 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:08:07.088028 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:08:07.095791 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:08:07.096827 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:08:07.097700 [debug] [Thread-4 (]: Began executing node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:08:07.107051 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:08:07.113298 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:08:07.118475 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:08:07.120530 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:08:07.123296 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: BEGIN
[0m10:08:07.125082 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:08:07.127209 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: BEGIN
[0m10:08:07.129134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:07.131044 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: BEGIN
[0m10:08:07.132281 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:08:07.134815 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:08:07.138563 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:08:07.142920 [debug] [Thread-4 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: BEGIN
[0m10:08:07.149550 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:08:07.152032 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m10:08:07.154372 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:08:07.158783 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."analytics"."stg_mediciones_madrid"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m10:08:07.161961 [debug] [Thread-2 (]: SQL status: BEGIN in 0.027 seconds
[0m10:08:07.164192 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:08:07.166571 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:08:07.167545 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."analytics"."stg_mediciones_madrid"
where id is null



  
  
      
    ) dbt_internal_test
[0m10:08:07.169122 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m10:08:07.170145 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m10:08:07.172898 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: ROLLBACK
[0m10:08:07.177191 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:08:07.179204 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:08:07.179878 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:08:07.181694 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: Close
[0m10:08:07.182760 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."analytics"."stg_mediciones_madrid"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m10:08:07.184737 [debug] [Thread-4 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."analytics"."stg_mediciones_madrid"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:08:07.188124 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: ROLLBACK
[0m10:08:07.192328 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_mediciones_madrid_fecha_carg ......................... [[32mPASS[0m in 0.17s]
[0m10:08:07.197144 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: Close
[0m10:08:07.198198 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m10:08:07.199406 [debug] [Thread-1 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:08:07.200062 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:08:07.202550 [info ] [Thread-2 (]: 8 of 11 PASS not_null_stg_mediciones_madrid_id ................................. [[32mPASS[0m in 0.18s]
[0m10:08:07.206182 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: ROLLBACK
[0m10:08:07.208852 [debug] [Thread-1 (]: Began running node model.data_project_1.valencia
[0m10:08:07.212271 [debug] [Thread-4 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: ROLLBACK
[0m10:08:07.214439 [debug] [Thread-2 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:08:07.216617 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: Close
[0m10:08:07.218465 [info ] [Thread-1 (]: 11 of 11 START sql view model analytics.valencia ............................... [RUN]
[0m10:08:07.221018 [debug] [Thread-4 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: Close
[0m10:08:07.225897 [info ] [Thread-3 (]: 9 of 11 PASS not_null_stg_mediciones_madrid_nombre_estacion .................... [[32mPASS[0m in 0.19s]
[0m10:08:07.228229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf, now model.data_project_1.valencia)
[0m10:08:07.231228 [info ] [Thread-4 (]: 10 of 11 PASS unique_stg_mediciones_madrid_id .................................. [[32mPASS[0m in 0.20s]
[0m10:08:07.233297 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:08:07.235306 [debug] [Thread-1 (]: Began compiling node model.data_project_1.valencia
[0m10:08:07.237249 [debug] [Thread-4 (]: Finished running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:08:07.247311 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.valencia"
[0m10:08:07.279166 [debug] [Thread-1 (]: Began executing node model.data_project_1.valencia
[0m10:08:07.286065 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.valencia"
[0m10:08:07.309110 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.valencia"
[0m10:08:07.310991 [debug] [Thread-1 (]: On model.data_project_1.valencia: BEGIN
[0m10:08:07.312560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:07.326223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m10:08:07.328522 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.valencia"
[0m10:08:07.330170 [debug] [Thread-1 (]: On model.data_project_1.valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.valencia"} */

  create view "data_project_1"."analytics"."valencia__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'valencia' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at,
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."analytics"."stg_mediciones_valencia"
where city='valencia'
  );
[0m10:08:07.338018 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:08:07.345613 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.valencia"
[0m10:08:07.348265 [debug] [Thread-1 (]: On model.data_project_1.valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.valencia"} */
alter table "data_project_1"."analytics"."valencia__dbt_tmp" rename to "valencia"
[0m10:08:07.357313 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:08:07.361604 [debug] [Thread-1 (]: On model.data_project_1.valencia: COMMIT
[0m10:08:07.363843 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.valencia"
[0m10:08:07.365992 [debug] [Thread-1 (]: On model.data_project_1.valencia: COMMIT
[0m10:08:07.371503 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:08:07.382886 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."valencia__dbt_backup"
[0m10:08:07.389656 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.valencia"
[0m10:08:07.393805 [debug] [Thread-1 (]: On model.data_project_1.valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.valencia"} */
drop view if exists "data_project_1"."analytics"."valencia__dbt_backup" cascade
[0m10:08:07.401736 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:08:07.406395 [debug] [Thread-1 (]: On model.data_project_1.valencia: Close
[0m10:08:07.409808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f079eacd-c6c5-47df-81a4-0d14d889d569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e737eefc2d0>]}
[0m10:08:07.412914 [info ] [Thread-1 (]: 11 of 11 OK created sql view model analytics.valencia .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m10:08:07.416808 [debug] [Thread-1 (]: Finished running node model.data_project_1.valencia
[0m10:08:07.425806 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:07.433244 [debug] [MainThread]: On master: BEGIN
[0m10:08:07.437197 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:08:07.463925 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m10:08:07.467161 [debug] [MainThread]: On master: COMMIT
[0m10:08:07.470115 [debug] [MainThread]: Using postgres connection "master"
[0m10:08:07.472273 [debug] [MainThread]: On master: COMMIT
[0m10:08:07.476785 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:08:07.479157 [debug] [MainThread]: On master: Close
[0m10:08:07.483150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:07.485311 [debug] [MainThread]: Connection 'model.data_project_1.valencia' was properly closed.
[0m10:08:07.486992 [debug] [MainThread]: Connection 'test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515' was properly closed.
[0m10:08:07.489319 [debug] [MainThread]: Connection 'test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c' was properly closed.
[0m10:08:07.491355 [debug] [MainThread]: Connection 'test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2' was properly closed.
[0m10:08:07.493594 [info ] [MainThread]: 
[0m10:08:07.495663 [info ] [MainThread]: Finished running 8 data tests, 3 view models in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m10:08:07.499736 [debug] [MainThread]: Command end result
[0m10:08:07.557550 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:08:07.568282 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:08:07.584777 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m10:08:07.586758 [info ] [MainThread]: 
[0m10:08:07.588527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:08:07.590292 [info ] [MainThread]: 
[0m10:08:07.591773 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m10:08:07.594489 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.2333064, "process_in_blocks": "4592", "process_kernel_time": 0.670982, "process_mem_max_rss": "131412", "process_out_blocks": "0", "process_user_time": 3.542625}
[0m10:08:07.596354 [debug] [MainThread]: Command `dbt build` succeeded at 10:08:07.596179 after 3.24 seconds
[0m10:08:07.597790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e73a4feac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e737f038490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e73a5319e50>]}
[0m10:08:07.599361 [debug] [MainThread]: Flushing usage events
[0m10:08:08.427620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:40:20.235923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a499da2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a4a846790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a49d218d0>]}


============================== 10:40:20.252870 | b6e16aed-bcd0-4692-922a-f23b8e0143a9 ==============================
[0m10:40:20.252870 [info ] [MainThread]: Running with dbt=1.10.15
[0m10:40:20.255749 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'target_path': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'partial_parse': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'invocation_command': 'dbt deps', 'log_path': '/usr/app/dbt/logs', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'None', 'log_format': 'default', 'indirect_selection': 'eager'}
[0m10:40:20.504965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6e16aed-bcd0-4692-922a-f23b8e0143a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a49929e50>]}
[0m10:40:20.537854 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:40:20.585673 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:40:20.592284 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5539914, "process_in_blocks": "28800", "process_kernel_time": 3.397901, "process_mem_max_rss": "103976", "process_out_blocks": "0", "process_user_time": 6.589086}
[0m10:40:20.596521 [debug] [MainThread]: Command `dbt deps` succeeded at 10:40:20.596102 after 0.56 seconds
[0m10:40:20.599793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a499d1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a4998dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x783a4e27ee50>]}
[0m10:40:20.602471 [debug] [MainThread]: Flushing usage events
[0m10:40:21.591481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:40:25.788455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752565497b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75256549ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752565447690>]}


============================== 10:40:25.799084 | 965cd387-4c40-466f-9ebb-824513b082aa ==============================
[0m10:40:25.799084 [info ] [MainThread]: Running with dbt=1.10.15
[0m10:40:25.801892 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'version_check': 'True', 'invocation_command': 'dbt build --target dev', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'introspect': 'True', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:40:26.062212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75256548f810>]}
[0m10:40:26.151076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7525681bcd10>]}
[0m10:40:26.154364 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:40:26.300381 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m10:40:26.966962 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 14 files added, 0 files changed.
[0m10:40:26.969737 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/mart_monthly_promedio.sql
[0m10:40:26.971445 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/int_station_summary.sql
[0m10:40:26.972967 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/int_hourly_avg.sql
[0m10:40:26.974399 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/mart_top_polluted_stations.sql
[0m10:40:26.975709 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/mart_alerts.sql
[0m10:40:26.976889 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/mart_daily_promedio.sql
[0m10:40:26.978903 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/schema.yml
[0m10:40:26.980615 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/int_monthly_avg.sql
[0m10:40:26.982418 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/intermediate/int_daily_avg.sql
[0m10:40:26.984178 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/mart_station_summary.sql
[0m10:40:26.986576 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/mart_weekly_extended.sql
[0m10:40:26.988450 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/mart_hourly.sql
[0m10:40:26.995224 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/mart_fact_air_quality.sql
[0m10:40:26.997130 [debug] [MainThread]: Partial parsing: added file: data_project_1://models/marts/schema.yml
[0m10:40:26.998642 [debug] [MainThread]: Partial parsing: deleted file: data_project_1://models/intermediate/valencia.sql
[0m10:40:27.699229 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'mart_daily' in the 'models' section of file 'models/marts/schema.yml'
[0m10:40:28.221699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752564114f10>]}
[0m10:40:28.500635 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:40:28.519559 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:40:28.625959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75251becfd90>]}
[0m10:40:28.628737 [info ] [MainThread]: Found 14 models, 8 data tests, 1 source, 459 macros
[0m10:40:28.641106 [info ] [MainThread]: 
[0m10:40:28.644351 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:40:28.647667 [info ] [MainThread]: 
[0m10:40:28.650776 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:40:28.670029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1'
[0m10:40:28.755474 [debug] [ThreadPool]: Using postgres connection "list_data_project_1"
[0m10:40:28.758397 [debug] [ThreadPool]: On list_data_project_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1"} */

    select distinct nspname from pg_namespace
  
[0m10:40:28.760643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:28.803827 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.043 seconds
[0m10:40:28.808226 [debug] [ThreadPool]: On list_data_project_1: Close
[0m10:40:28.814544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_project_1, now list_data_project_1_analytics)
[0m10:40:28.828542 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_analytics"
[0m10:40:28.831629 [debug] [ThreadPool]: On list_data_project_1_analytics: BEGIN
[0m10:40:28.836137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:40:28.858188 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m10:40:28.861701 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_analytics"
[0m10:40:28.864321 [debug] [ThreadPool]: On list_data_project_1_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1_analytics"} */
select
      'data_project_1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'data_project_1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'data_project_1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m10:40:28.912463 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m10:40:28.917345 [debug] [ThreadPool]: On list_data_project_1_analytics: ROLLBACK
[0m10:40:28.920975 [debug] [ThreadPool]: On list_data_project_1_analytics: Close
[0m10:40:28.933401 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:28.937061 [debug] [MainThread]: On master: BEGIN
[0m10:40:28.940380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:40:28.958508 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m10:40:28.961483 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:28.963929 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:40:29.007094 [debug] [MainThread]: SQL status: SELECT 4 in 0.041 seconds
[0m10:40:29.012208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7525639281d0>]}
[0m10:40:29.015607 [debug] [MainThread]: On master: ROLLBACK
[0m10:40:29.019557 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:29.022415 [debug] [MainThread]: On master: BEGIN
[0m10:40:29.025652 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:40:29.028284 [debug] [MainThread]: On master: COMMIT
[0m10:40:29.030429 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:29.032546 [debug] [MainThread]: On master: COMMIT
[0m10:40:29.036721 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:40:29.039965 [debug] [MainThread]: On master: Close
[0m10:40:29.060170 [debug] [Thread-1 (]: Began running node model.data_project_1.stg_mediciones_madrid
[0m10:40:29.061018 [debug] [Thread-2 (]: Began running node model.data_project_1.stg_mediciones_valencia
[0m10:40:29.064287 [info ] [Thread-1 (]: 1 of 22 START sql view model analytics.stg_mediciones_madrid ................... [RUN]
[0m10:40:29.067876 [info ] [Thread-2 (]: 2 of 22 START sql view model analytics.stg_mediciones_valencia ................. [RUN]
[0m10:40:29.071263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_project_1_analytics, now model.data_project_1.stg_mediciones_madrid)
[0m10:40:29.075346 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.data_project_1.stg_mediciones_valencia'
[0m10:40:29.078560 [debug] [Thread-1 (]: Began compiling node model.data_project_1.stg_mediciones_madrid
[0m10:40:29.082003 [debug] [Thread-2 (]: Began compiling node model.data_project_1.stg_mediciones_valencia
[0m10:40:29.096494 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_madrid"
[0m10:40:29.102539 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_valencia"
[0m10:40:29.123776 [debug] [Thread-1 (]: Began executing node model.data_project_1.stg_mediciones_madrid
[0m10:40:29.126622 [debug] [Thread-2 (]: Began executing node model.data_project_1.stg_mediciones_valencia
[0m10:40:29.209656 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_valencia"
[0m10:40:29.210639 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_madrid"
[0m10:40:29.228902 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:40:29.231263 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: BEGIN
[0m10:40:29.234030 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:40:29.234757 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:40:29.236935 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: BEGIN
[0m10:40:29.241721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:29.266266 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m10:40:29.269835 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:40:29.272427 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */

  create view "data_project_1"."analytics"."stg_mediciones_valencia__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'valencia' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='valencia'
  );
[0m10:40:29.275708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m10:40:29.279143 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:40:29.282619 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */

  create view "data_project_1"."analytics"."stg_mediciones_madrid__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'madrid' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='madrid'
  );
[0m10:40:29.319324 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.042 seconds
[0m10:40:29.320787 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.035 seconds
[0m10:40:29.344811 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:40:29.352797 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:40:29.356689 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."analytics"."stg_mediciones_valencia" rename to "stg_mediciones_valencia__dbt_backup"
[0m10:40:29.360559 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."analytics"."stg_mediciones_madrid" rename to "stg_mediciones_madrid__dbt_backup"
[0m10:40:29.375140 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m10:40:29.385401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m10:40:29.394807 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:40:29.411835 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:40:29.414449 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."analytics"."stg_mediciones_valencia__dbt_tmp" rename to "stg_mediciones_valencia"
[0m10:40:29.421419 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."analytics"."stg_mediciones_madrid__dbt_tmp" rename to "stg_mediciones_madrid"
[0m10:40:29.431602 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:40:29.438437 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:40:29.568374 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m10:40:29.576260 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m10:40:29.579742 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:40:29.585877 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:40:29.590778 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m10:40:29.595044 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m10:40:29.613777 [debug] [Thread-2 (]: SQL status: COMMIT in 0.015 seconds
[0m10:40:29.615171 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m10:40:29.627891 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."stg_mediciones_valencia__dbt_backup"
[0m10:40:29.632701 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."stg_mediciones_madrid__dbt_backup"
[0m10:40:29.647162 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:40:29.649065 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:40:29.651522 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
drop view if exists "data_project_1"."analytics"."stg_mediciones_valencia__dbt_backup" cascade
[0m10:40:29.654240 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
drop view if exists "data_project_1"."analytics"."stg_mediciones_madrid__dbt_backup" cascade
[0m10:40:29.672321 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.013 seconds
[0m10:40:29.674026 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.017 seconds
[0m10:40:29.682976 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: Close
[0m10:40:29.687620 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: Close
[0m10:40:29.698405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75251b2aa510>]}
[0m10:40:29.701535 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75251b2a1bd0>]}
[0m10:40:29.707049 [info ] [Thread-1 (]: 1 of 22 OK created sql view model analytics.stg_mediciones_madrid .............. [[32mCREATE VIEW[0m in 0.62s]
[0m10:40:29.711839 [info ] [Thread-2 (]: 2 of 22 OK created sql view model analytics.stg_mediciones_valencia ............ [[32mCREATE VIEW[0m in 0.63s]
[0m10:40:29.717435 [debug] [Thread-1 (]: Finished running node model.data_project_1.stg_mediciones_madrid
[0m10:40:29.721154 [debug] [Thread-2 (]: Finished running node model.data_project_1.stg_mediciones_valencia
[0m10:40:29.728149 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:40:29.729066 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:40:29.729885 [debug] [Thread-1 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:40:29.732429 [debug] [Thread-2 (]: Began running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:40:29.737059 [info ] [Thread-4 (]: 3 of 22 START test not_null_stg_mediciones_madrid_fecha_carg ................... [RUN]
[0m10:40:29.741507 [info ] [Thread-3 (]: 4 of 22 START test not_null_stg_mediciones_madrid_id ........................... [RUN]
[0m10:40:29.745996 [info ] [Thread-1 (]: 5 of 22 START test not_null_stg_mediciones_madrid_nombre_estacion .............. [RUN]
[0m10:40:29.750775 [info ] [Thread-2 (]: 6 of 22 START test unique_stg_mediciones_madrid_id ............................. [RUN]
[0m10:40:29.758515 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf'
[0m10:40:29.763287 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515'
[0m10:40:29.767394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_madrid, now test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2)
[0m10:40:29.770827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_valencia, now test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c)
[0m10:40:29.774595 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:40:29.777836 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:40:29.781868 [debug] [Thread-1 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:40:29.785162 [debug] [Thread-2 (]: Began compiling node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:40:29.811892 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:40:29.819397 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:40:29.828715 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:40:29.841604 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:40:29.864802 [debug] [Thread-1 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:40:29.867412 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:40:29.879612 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:40:29.895643 [debug] [Thread-2 (]: Began executing node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:40:29.899267 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:40:29.904024 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:40:29.912622 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:40:29.917772 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:40:29.943048 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:40:29.944778 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:40:29.947522 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: BEGIN
[0m10:40:29.948969 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:40:29.951795 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: BEGIN
[0m10:40:29.953466 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:40:29.956645 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:40:29.959960 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: BEGIN
[0m10:40:29.962693 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:40:29.966087 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: BEGIN
[0m10:40:29.972005 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:40:29.980792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:29.987655 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m10:40:29.993763 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m10:40:29.996693 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:40:30.001141 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:40:30.006456 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."analytics"."stg_mediciones_madrid"
where id is null



  
  
      
    ) dbt_internal_test
[0m10:40:30.011709 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."analytics"."stg_mediciones_madrid"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:40:30.024357 [debug] [Thread-4 (]: SQL status: BEGIN in 0.052 seconds
[0m10:40:30.027924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m10:40:30.030842 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:40:30.035792 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:40:30.041166 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."analytics"."stg_mediciones_madrid"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m10:40:30.043118 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.027 seconds
[0m10:40:30.047362 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."analytics"."stg_mediciones_madrid"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m10:40:30.049406 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.030 seconds
[0m10:40:30.065356 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: ROLLBACK
[0m10:40:30.073012 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.020 seconds
[0m10:40:30.083337 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: ROLLBACK
[0m10:40:30.084681 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m10:40:30.092208 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: Close
[0m10:40:30.103064 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: ROLLBACK
[0m10:40:30.110104 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: Close
[0m10:40:30.124939 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: ROLLBACK
[0m10:40:30.134139 [info ] [Thread-3 (]: 4 of 22 PASS not_null_stg_mediciones_madrid_id ................................. [[32mPASS[0m in 0.37s]
[0m10:40:30.140372 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: Close
[0m10:40:30.145681 [info ] [Thread-2 (]: 6 of 22 PASS unique_stg_mediciones_madrid_id ................................... [[32mPASS[0m in 0.37s]
[0m10:40:30.151775 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: Close
[0m10:40:30.157477 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:40:30.163644 [info ] [Thread-4 (]: 3 of 22 PASS not_null_stg_mediciones_madrid_fecha_carg ......................... [[32mPASS[0m in 0.41s]
[0m10:40:30.170022 [debug] [Thread-2 (]: Finished running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:40:30.175287 [info ] [Thread-1 (]: 5 of 22 PASS not_null_stg_mediciones_madrid_nombre_estacion .................... [[32mPASS[0m in 0.41s]
[0m10:40:30.181872 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:40:30.188986 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:40:30.193531 [debug] [Thread-2 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:40:30.199223 [debug] [Thread-1 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:40:30.203563 [info ] [Thread-3 (]: 7 of 22 START test not_null_stg_mediciones_valencia_fecha_carg ................. [RUN]
[0m10:40:30.208020 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:40:30.211476 [info ] [Thread-2 (]: 8 of 22 START test not_null_stg_mediciones_valencia_id ......................... [RUN]
[0m10:40:30.216445 [debug] [Thread-1 (]: Began running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:40:30.220853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515, now test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e)
[0m10:40:30.224770 [info ] [Thread-4 (]: 9 of 22 START test not_null_stg_mediciones_valencia_nombre_estacion ............ [RUN]
[0m10:40:30.229808 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c, now test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e)
[0m10:40:30.235128 [info ] [Thread-1 (]: 10 of 22 START test unique_stg_mediciones_valencia_id .......................... [RUN]
[0m10:40:30.238619 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:40:30.241810 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf, now test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046)
[0m10:40:30.245303 [debug] [Thread-2 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:40:30.249376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2, now test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170)
[0m10:40:30.262722 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:40:30.267565 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:40:30.278285 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:40:30.284257 [debug] [Thread-1 (]: Began compiling node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:40:30.307060 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:40:30.330790 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:40:30.359739 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:40:30.361849 [debug] [Thread-1 (]: Began executing node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:40:30.371145 [debug] [Thread-2 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:40:30.372322 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:40:30.376686 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:40:30.386992 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:40:30.392770 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:40:30.403142 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:40:30.425351 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:40:30.427616 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:40:30.430830 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:40:30.434065 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: BEGIN
[0m10:40:30.437153 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:40:30.438309 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: BEGIN
[0m10:40:30.441053 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: BEGIN
[0m10:40:30.443897 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:40:30.446982 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: BEGIN
[0m10:40:30.450572 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:40:30.453803 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:40:30.461358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:30.486909 [debug] [Thread-2 (]: SQL status: BEGIN in 0.043 seconds
[0m10:40:30.490408 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:40:30.491672 [debug] [Thread-4 (]: SQL status: BEGIN in 0.038 seconds
[0m10:40:30.494838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m10:40:30.495715 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m10:40:30.496724 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."analytics"."stg_mediciones_valencia"
where id is null



  
  
      
    ) dbt_internal_test
[0m10:40:30.500769 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:40:30.504421 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:40:30.507907 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:40:30.513132 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."analytics"."stg_mediciones_valencia"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m10:40:30.516915 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."analytics"."stg_mediciones_valencia"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:40:30.518354 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:40:30.520618 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."analytics"."stg_mediciones_valencia"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m10:40:30.534373 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m10:40:30.532236 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: ROLLBACK
[0m10:40:30.536829 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m10:40:30.544151 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: ROLLBACK
[0m10:40:30.548238 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m10:40:30.549336 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: Close
[0m10:40:30.553520 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: ROLLBACK
[0m10:40:30.559062 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: Close
[0m10:40:30.563743 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: ROLLBACK
[0m10:40:30.570432 [info ] [Thread-2 (]: 8 of 22 PASS not_null_stg_mediciones_valencia_id ............................... [[32mPASS[0m in 0.34s]
[0m10:40:30.575500 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: Close
[0m10:40:30.581077 [info ] [Thread-4 (]: 9 of 22 PASS not_null_stg_mediciones_valencia_nombre_estacion .................. [[32mPASS[0m in 0.34s]
[0m10:40:30.586238 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: Close
[0m10:40:30.590383 [debug] [Thread-2 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:40:30.594696 [info ] [Thread-1 (]: 10 of 22 PASS unique_stg_mediciones_valencia_id ................................ [[32mPASS[0m in 0.35s]
[0m10:40:30.601109 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:40:30.606042 [info ] [Thread-3 (]: 7 of 22 PASS not_null_stg_mediciones_valencia_fecha_carg ....................... [[32mPASS[0m in 0.38s]
[0m10:40:30.611492 [debug] [Thread-1 (]: Finished running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:40:30.618442 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:40:30.625369 [debug] [Thread-2 (]: Began running node model.data_project_1.int_daily_avg
[0m10:40:30.626835 [debug] [Thread-4 (]: Began running node model.data_project_1.int_hourly_avg
[0m10:40:30.628290 [debug] [Thread-1 (]: Began running node model.data_project_1.int_monthly_avg
[0m10:40:30.629414 [debug] [Thread-3 (]: Began running node model.data_project_1.int_station_summary
[0m10:40:30.631624 [info ] [Thread-2 (]: 11 of 22 START sql view model analytics.int_daily_avg .......................... [RUN]
[0m10:40:30.635198 [info ] [Thread-4 (]: 12 of 22 START sql view model analytics.int_hourly_avg ......................... [RUN]
[0m10:40:30.638442 [info ] [Thread-1 (]: 13 of 22 START sql view model analytics.int_monthly_avg ........................ [RUN]
[0m10:40:30.641239 [info ] [Thread-3 (]: 14 of 22 START sql view model analytics.int_station_summary .................... [RUN]
[0m10:40:30.644385 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e, now model.data_project_1.int_daily_avg)
[0m10:40:30.648214 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046, now model.data_project_1.int_hourly_avg)
[0m10:40:30.651503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170, now model.data_project_1.int_monthly_avg)
[0m10:40:30.656241 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e, now model.data_project_1.int_station_summary)
[0m10:40:30.660275 [debug] [Thread-2 (]: Began compiling node model.data_project_1.int_daily_avg
[0m10:40:30.667244 [debug] [Thread-4 (]: Began compiling node model.data_project_1.int_hourly_avg
[0m10:40:30.672278 [debug] [Thread-1 (]: Began compiling node model.data_project_1.int_monthly_avg
[0m10:40:30.678351 [debug] [Thread-3 (]: Began compiling node model.data_project_1.int_station_summary
[0m10:40:30.693282 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.int_daily_avg"
[0m10:40:30.704800 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.int_hourly_avg"
[0m10:40:30.715410 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.int_monthly_avg"
[0m10:40:30.733095 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.int_station_summary"
[0m10:40:30.770392 [debug] [Thread-4 (]: Began executing node model.data_project_1.int_hourly_avg
[0m10:40:30.782763 [debug] [Thread-2 (]: Began executing node model.data_project_1.int_daily_avg
[0m10:40:30.786358 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.int_hourly_avg"
[0m10:40:30.797637 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.int_daily_avg"
[0m10:40:30.799782 [debug] [Thread-1 (]: Began executing node model.data_project_1.int_monthly_avg
[0m10:40:30.803760 [debug] [Thread-3 (]: Began executing node model.data_project_1.int_station_summary
[0m10:40:30.819217 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.int_monthly_avg"
[0m10:40:30.837795 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.int_station_summary"
[0m10:40:30.843314 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:40:30.844437 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:40:30.847012 [debug] [Thread-2 (]: On model.data_project_1.int_daily_avg: BEGIN
[0m10:40:30.849904 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:40:30.851233 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: BEGIN
[0m10:40:30.854594 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:40:30.857162 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: BEGIN
[0m10:40:30.858288 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:40:30.860601 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:40:30.867338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:30.870056 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: BEGIN
[0m10:40:30.877821 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:40:30.884427 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m10:40:30.887244 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:40:30.890146 [debug] [Thread-2 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */

  create view "data_project_1"."analytics"."int_daily_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."analytics"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."analytics"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m10:40:30.894477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m10:40:30.895761 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m10:40:30.898744 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:40:30.899775 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m10:40:30.902755 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:40:30.905504 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */

  create view "data_project_1"."analytics"."int_monthly_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."analytics"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."analytics"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_month,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_month
order by city, nombre_estacion, fecha_month
  );
[0m10:40:30.908003 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:40:30.910836 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */

  create view "data_project_1"."analytics"."int_hourly_avg__dbt_tmp"
    
    
  as (
    with all_data as (
    select * from "data_project_1"."analytics"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."analytics"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    avg(no2) as no2_avg,
    avg(o3) as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by 1,2,3
order by fecha_hour, city, nombre_estacion
  );
[0m10:40:30.916301 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */

  create view "data_project_1"."analytics"."int_station_summary__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."analytics"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."analytics"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m10:40:30.934746 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m10:40:30.944525 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:40:30.945346 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m10:40:30.948621 [debug] [Thread-2 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
alter table "data_project_1"."analytics"."int_daily_avg__dbt_tmp" rename to "int_daily_avg"
[0m10:40:30.950579 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m10:40:30.951492 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m10:40:30.964436 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:40:30.975225 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m10:40:30.978275 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:40:30.990764 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:40:30.993512 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
alter table "data_project_1"."analytics"."int_monthly_avg__dbt_tmp" rename to "int_monthly_avg"
[0m10:40:31.001278 [debug] [Thread-2 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m10:40:31.005173 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
alter table "data_project_1"."analytics"."int_station_summary__dbt_tmp" rename to "int_station_summary"
[0m10:40:31.008899 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
alter table "data_project_1"."analytics"."int_hourly_avg__dbt_tmp" rename to "int_hourly_avg"
[0m10:40:31.015715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:40:31.017354 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:40:31.023791 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:40:31.028832 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m10:40:31.029662 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:40:31.031968 [debug] [Thread-2 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m10:40:31.037480 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: COMMIT
[0m10:40:31.040843 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:40:31.047741 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m10:40:31.053714 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:40:31.055797 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m10:40:31.058433 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m10:40:31.061238 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:40:31.064194 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: COMMIT
[0m10:40:31.073570 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."int_daily_avg__dbt_backup"
[0m10:40:31.078623 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m10:40:31.080069 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:40:31.085125 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:40:31.091483 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m10:40:31.098067 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."int_monthly_avg__dbt_backup"
[0m10:40:31.100355 [debug] [Thread-2 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
drop view if exists "data_project_1"."analytics"."int_daily_avg__dbt_backup" cascade
[0m10:40:31.102447 [debug] [Thread-4 (]: SQL status: COMMIT in 0.015 seconds
[0m10:40:31.106954 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."analytics"."int_station_summary__dbt_backup"
[0m10:40:31.110454 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:40:31.116120 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:40:31.123642 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."analytics"."int_hourly_avg__dbt_backup"
[0m10:40:31.127075 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:40:31.131204 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
drop view if exists "data_project_1"."analytics"."int_monthly_avg__dbt_backup" cascade
[0m10:40:31.136735 [debug] [Thread-2 (]: On model.data_project_1.int_daily_avg: Close
[0m10:40:31.141198 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:40:31.144988 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
drop view if exists "data_project_1"."analytics"."int_station_summary__dbt_backup" cascade
[0m10:40:31.149709 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:40:31.152847 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75251b2cd310>]}
[0m10:40:31.155803 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
drop view if exists "data_project_1"."analytics"."int_hourly_avg__dbt_backup" cascade
[0m10:40:31.162259 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:40:31.168724 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: Close
[0m10:40:31.175316 [info ] [Thread-2 (]: 11 of 22 OK created sql view model analytics.int_daily_avg ..................... [[32mCREATE VIEW[0m in 0.51s]
[0m10:40:31.181150 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:40:31.186674 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: Close
[0m10:40:31.191329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752518190090>]}
[0m10:40:31.194976 [debug] [Thread-2 (]: Finished running node model.data_project_1.int_daily_avg
[0m10:40:31.201279 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: Close
[0m10:40:31.205005 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75251becda10>]}
[0m10:40:31.208284 [info ] [Thread-1 (]: 13 of 22 OK created sql view model analytics.int_monthly_avg ................... [[32mCREATE VIEW[0m in 0.54s]
[0m10:40:31.214756 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_daily_promedio
[0m10:40:31.217380 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752513f28bd0>]}
[0m10:40:31.221372 [info ] [Thread-3 (]: 14 of 22 OK created sql view model analytics.int_station_summary ............... [[32mCREATE VIEW[0m in 0.55s]
[0m10:40:31.226617 [debug] [Thread-1 (]: Finished running node model.data_project_1.int_monthly_avg
[0m10:40:31.232060 [info ] [Thread-2 (]: 15 of 22 START sql table model analytics.mart_daily_promedio ................... [RUN]
[0m10:40:31.237012 [info ] [Thread-4 (]: 12 of 22 OK created sql view model analytics.int_hourly_avg .................... [[32mCREATE VIEW[0m in 0.57s]
[0m10:40:31.241427 [debug] [Thread-3 (]: Finished running node model.data_project_1.int_station_summary
[0m10:40:31.245349 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_top_polluted_stations
[0m10:40:31.249045 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_daily_avg, now model.data_project_1.mart_daily_promedio)
[0m10:40:31.252606 [debug] [Thread-4 (]: Finished running node model.data_project_1.int_hourly_avg
[0m10:40:31.256614 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_weekly_extended
[0m10:40:31.260228 [info ] [Thread-1 (]: 16 of 22 START sql table model analytics.mart_top_polluted_stations ............ [RUN]
[0m10:40:31.264036 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_daily_promedio
[0m10:40:31.267776 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_monthly_promedio
[0m10:40:31.271117 [info ] [Thread-3 (]: 17 of 22 START sql table model analytics.mart_weekly_extended .................. [RUN]
[0m10:40:31.274923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_monthly_avg, now model.data_project_1.mart_top_polluted_stations)
[0m10:40:31.288019 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_daily_promedio"
[0m10:40:31.291875 [info ] [Thread-4 (]: 18 of 22 START sql table model analytics.mart_monthly_promedio ................. [RUN]
[0m10:40:31.297254 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_station_summary, now model.data_project_1.mart_weekly_extended)
[0m10:40:31.303352 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_top_polluted_stations
[0m10:40:31.311756 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_hourly_avg, now model.data_project_1.mart_monthly_promedio)
[0m10:40:31.319707 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_weekly_extended
[0m10:40:31.335693 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_top_polluted_stations"
[0m10:40:31.339258 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_monthly_promedio
[0m10:40:31.354699 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_weekly_extended"
[0m10:40:31.367983 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_monthly_promedio"
[0m10:40:31.381494 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_daily_promedio
[0m10:40:31.410133 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_top_polluted_stations
[0m10:40:31.417863 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_monthly_promedio
[0m10:40:31.426136 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_weekly_extended
[0m10:40:31.492874 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_daily_promedio"
[0m10:40:31.494243 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_top_polluted_stations"
[0m10:40:31.503630 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_monthly_promedio"
[0m10:40:31.510847 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_weekly_extended"
[0m10:40:31.542352 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:40:31.545899 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: BEGIN
[0m10:40:31.547197 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:40:31.549852 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:40:31.551162 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:40:31.553493 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: BEGIN
[0m10:40:31.556987 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:40:31.559736 [debug] [Thread-1 (]: On model.data_project_1.mart_top_polluted_stations: BEGIN
[0m10:40:31.563451 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:40:31.566245 [debug] [Thread-2 (]: On model.data_project_1.mart_daily_promedio: BEGIN
[0m10:40:31.568899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:31.574233 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:40:31.575234 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m10:40:31.583063 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:40:31.586556 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */

  
    

  create  table "data_project_1"."analytics"."mart_weekly_extended__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."analytics"."int_daily_avg"
),

weekly_data as (
    select
        city,
        nombre_estacion,
        date_trunc('week', fecha_day) as fecha_week,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg
    from daily_data
    group by city, nombre_estacion, date_trunc('week', fecha_day)
)

select
    *,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2
from weekly_data
order by fecha_week, city, nombre_estacion
  );
  
[0m10:40:31.593828 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m10:40:31.597476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m10:40:31.599755 [debug] [Thread-2 (]: SQL status: BEGIN in 0.026 seconds
[0m10:40:31.600532 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:40:31.603845 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:40:31.607213 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:40:31.610616 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */

  
    

  create  table "data_project_1"."analytics"."mart_monthly_promedio__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    nombre_estacion,
    fecha_month,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as contaminacion_promedio
from "data_project_1"."analytics"."int_monthly_avg"
  );
  
[0m10:40:31.614115 [debug] [Thread-1 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */

  
    

  create  table "data_project_1"."analytics"."mart_top_polluted_stations__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."analytics"."int_daily_avg"
),

ranked as (
    select
        city,
        nombre_estacion,
        fecha_day,
        no2_avg,
        o3_avg,
        pm10_avg,
        pm25_avg,
        rank() over (partition by city, fecha_day order by pm25_avg desc) as rank_pm25,
        rank() over (partition by city, fecha_day order by pm10_avg desc) as rank_pm10
    from daily_data
)

select *
from ranked
where rank_pm25 <= 5 or rank_pm10 <= 5
order by fecha_day, city, rank_pm25, rank_pm10
  );
  
[0m10:40:31.617213 [debug] [Thread-2 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */

  
    

  create  table "data_project_1"."analytics"."mart_daily_promedio__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * 
    from "data_project_1"."analytics"."int_daily_avg"
)

select
    city,
    nombre_estacion,
    fecha_day,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Calculamos un Ã­ndice de contaminaciÃ³n promedio
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n del nivel de NO2
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por dÃ­a dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_day order by pm25_avg desc) as ranking_pm25
from daily_data
order by fecha_day, city, nombre_estacion
  );
  
[0m10:40:31.649313 [debug] [Thread-3 (]: SQL status: SELECT 34 in 0.059 seconds
[0m10:40:31.666474 [debug] [Thread-4 (]: SQL status: SELECT 34 in 0.045 seconds
[0m10:40:31.682154 [debug] [Thread-1 (]: SQL status: SELECT 36 in 0.058 seconds
[0m10:40:31.684345 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:40:31.685813 [debug] [Thread-2 (]: SQL status: SELECT 68 in 0.058 seconds
[0m10:40:31.695302 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:40:31.703502 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:40:31.709318 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."analytics"."mart_weekly_extended__dbt_tmp" rename to "mart_weekly_extended"
[0m10:40:31.726283 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:40:31.731994 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."analytics"."mart_monthly_promedio__dbt_tmp" rename to "mart_monthly_promedio"
[0m10:40:31.738756 [debug] [Thread-1 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."analytics"."mart_top_polluted_stations__dbt_tmp" rename to "mart_top_polluted_stations"
[0m10:40:31.745087 [debug] [Thread-2 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."analytics"."mart_daily_promedio__dbt_tmp" rename to "mart_daily_promedio"
[0m10:40:31.746343 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:40:31.752543 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:40:31.756621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:40:31.760369 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:40:31.765013 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m10:40:31.771585 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m10:40:31.776412 [debug] [Thread-1 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m10:40:31.781425 [debug] [Thread-2 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m10:40:31.784955 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:40:31.790987 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:40:31.794303 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:40:31.797823 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:40:31.801233 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m10:40:31.803650 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m10:40:31.806488 [debug] [Thread-1 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m10:40:31.809325 [debug] [Thread-2 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m10:40:31.828878 [debug] [Thread-3 (]: SQL status: COMMIT in 0.016 seconds
[0m10:40:31.837861 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."analytics"."mart_weekly_extended__dbt_backup"
[0m10:40:31.840579 [debug] [Thread-2 (]: SQL status: COMMIT in 0.022 seconds
[0m10:40:31.841674 [debug] [Thread-4 (]: SQL status: COMMIT in 0.027 seconds
[0m10:40:31.843103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m10:40:31.849630 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:40:31.859373 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."mart_daily_promedio__dbt_backup"
[0m10:40:31.865103 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."analytics"."mart_monthly_promedio__dbt_backup"
[0m10:40:31.872343 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."mart_top_polluted_stations__dbt_backup"
[0m10:40:31.879698 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
drop table if exists "data_project_1"."analytics"."mart_weekly_extended__dbt_backup" cascade
[0m10:40:31.883686 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:40:31.887856 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:40:31.892836 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:40:31.902648 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:40:31.905477 [debug] [Thread-2 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
drop table if exists "data_project_1"."analytics"."mart_daily_promedio__dbt_backup" cascade
[0m10:40:31.908182 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
drop table if exists "data_project_1"."analytics"."mart_monthly_promedio__dbt_backup" cascade
[0m10:40:31.911267 [debug] [Thread-1 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
drop table if exists "data_project_1"."analytics"."mart_top_polluted_stations__dbt_backup" cascade
[0m10:40:31.918194 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: Close
[0m10:40:31.924593 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:40:31.928165 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:40:31.931655 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:40:31.935589 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752513f00e90>]}
[0m10:40:31.942983 [debug] [Thread-2 (]: On model.data_project_1.mart_daily_promedio: Close
[0m10:40:31.948947 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: Close
[0m10:40:31.954769 [debug] [Thread-1 (]: On model.data_project_1.mart_top_polluted_stations: Close
[0m10:40:31.958649 [info ] [Thread-3 (]: 17 of 22 OK created sql table model analytics.mart_weekly_extended ............. [[32mSELECT 34[0m in 0.64s]
[0m10:40:31.966688 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752513f03910>]}
[0m10:40:31.971796 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752513f3c7d0>]}
[0m10:40:31.976895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7525181d4390>]}
[0m10:40:31.983844 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_weekly_extended
[0m10:40:31.989547 [info ] [Thread-2 (]: 15 of 22 OK created sql table model analytics.mart_daily_promedio .............. [[32mSELECT 68[0m in 0.72s]
[0m10:40:31.996466 [info ] [Thread-4 (]: 18 of 22 OK created sql table model analytics.mart_monthly_promedio ............ [[32mSELECT 34[0m in 0.66s]
[0m10:40:32.002496 [info ] [Thread-1 (]: 16 of 22 OK created sql table model analytics.mart_top_polluted_stations ....... [[32mSELECT 36[0m in 0.70s]
[0m10:40:32.007407 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_station_summary
[0m10:40:32.014034 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_daily_promedio
[0m10:40:32.020189 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_monthly_promedio
[0m10:40:32.026392 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_top_polluted_stations
[0m10:40:32.032809 [info ] [Thread-3 (]: 19 of 22 START sql table model analytics.mart_station_summary .................. [RUN]
[0m10:40:32.038769 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_alerts
[0m10:40:32.044646 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_hourly
[0m10:40:32.050943 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_fact_air_quality
[0m10:40:32.055904 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_weekly_extended, now model.data_project_1.mart_station_summary)
[0m10:40:32.061538 [info ] [Thread-2 (]: 20 of 22 START sql table model analytics.mart_alerts ........................... [RUN]
[0m10:40:32.068210 [info ] [Thread-4 (]: 21 of 22 START sql table model analytics.mart_hourly ........................... [RUN]
[0m10:40:32.074213 [info ] [Thread-1 (]: 22 of 22 START sql table model analytics.mart_fact_air_quality ................. [RUN]
[0m10:40:32.080303 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_station_summary
[0m10:40:32.084618 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_daily_promedio, now model.data_project_1.mart_alerts)
[0m10:40:32.088430 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_monthly_promedio, now model.data_project_1.mart_hourly)
[0m10:40:32.094203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_top_polluted_stations, now model.data_project_1.mart_fact_air_quality)
[0m10:40:32.105010 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_station_summary"
[0m10:40:32.108257 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_alerts
[0m10:40:32.117405 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_hourly
[0m10:40:32.121501 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_fact_air_quality
[0m10:40:32.132493 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_alerts"
[0m10:40:32.148794 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_hourly"
[0m10:40:32.164826 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_fact_air_quality"
[0m10:40:32.171871 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_station_summary
[0m10:40:32.196797 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_alerts
[0m10:40:32.200707 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_station_summary"
[0m10:40:32.211652 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_hourly
[0m10:40:32.212830 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_fact_air_quality
[0m10:40:32.218842 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_alerts"
[0m10:40:32.241013 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_hourly"
[0m10:40:32.250156 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_fact_air_quality"
[0m10:40:32.255314 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m10:40:32.265489 [debug] [Thread-3 (]: On model.data_project_1.mart_station_summary: BEGIN
[0m10:40:32.267407 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:40:32.271410 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:40:32.273176 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:40:32.276463 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: BEGIN
[0m10:40:32.281068 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:40:32.283800 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: BEGIN
[0m10:40:32.287463 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:40:32.291209 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: BEGIN
[0m10:40:32.294353 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:40:32.300245 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m10:40:32.301614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:40:32.307668 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m10:40:32.314374 [debug] [Thread-3 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */

  
    

  create  table "data_project_1"."analytics"."mart_station_summary__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    nombre_estacion,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    first_measurement,
    last_measurement,
    case
        when pm25_avg > 50 then 'Alto'
        when pm25_avg > 25 then 'Moderado'
        else 'Bajo'
    end as nivel_pm25
from "data_project_1"."analytics"."int_station_summary"
  );
  
[0m10:40:32.320496 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m10:40:32.324221 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:40:32.326378 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "first_measurement" does not exist
LINE 21:     first_measurement,
             ^

[0m10:40:32.329274 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */

  
    

  create  table "data_project_1"."analytics"."mart_alerts__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select *
    from "data_project_1"."analytics"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    case 
        when no2_avg > 200 then 'Alerta NO2'
        when o3_avg > 180 then 'Alerta O3'
        when pm10_avg > 150 then 'Alerta PM10'
        when pm25_avg > 75 then 'Alerta PM2.5'
        else null
    end as alerta
from hourly_data
where no2_avg > 200
   or o3_avg > 180
   or pm10_avg > 150
   or pm25_avg > 75
order by fecha_hour, city, nombre_estacion
  );
  
[0m10:40:32.333462 [debug] [Thread-4 (]: SQL status: BEGIN in 0.039 seconds
[0m10:40:32.334206 [debug] [Thread-3 (]: On model.data_project_1.mart_station_summary: ROLLBACK
[0m10:40:32.340060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m10:40:32.343180 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:40:32.348239 [debug] [Thread-3 (]: On model.data_project_1.mart_station_summary: Close
[0m10:40:32.351338 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:40:32.355712 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */

  
    

  create  table "data_project_1"."analytics"."mart_hourly__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select * 
    from "data_project_1"."analytics"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Ãndice de contaminaciÃ³n por hora
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n de NO2 por niveles
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por hora dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_hour order by pm25_avg desc) as ranking_pm25
from hourly_data
order by fecha_hour, city, nombre_estacion
  );
  
[0m10:40:32.366087 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */

  
    

  create  table "data_project_1"."analytics"."mart_fact_air_quality__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * from "data_project_1"."analytics"."int_daily_avg"
),
weekly_data as (
    select * from "data_project_1"."analytics"."mart_weekly_extended"
),
monthly_data as (
    select * from "data_project_1"."analytics"."int_monthly_avg"
)

select
    coalesce(d.city, w.city, m.city) as city,
    coalesce(d.nombre_estacion, w.nombre_estacion, m.nombre_estacion) as nombre_estacion,
    d.fecha_day,
    w.fecha_week,
    m.fecha_month,
    d.no2_avg as daily_no2,
    d.o3_avg as daily_o3,
    d.pm10_avg as daily_pm10,
    d.pm25_avg as daily_pm25,
    w.no2_avg as weekly_no2,
    w.o3_avg as weekly_o3,
    w.pm10_avg as weekly_pm10,
    w.pm25_avg as weekly_pm25,
    m.no2_avg as monthly_no2,
    m.o3_avg as monthly_o3,
    m.pm10_avg as monthly_pm10,
    m.pm25_avg as monthly_pm25
from daily_data d
full outer join weekly_data w
    on d.city = w.city
    and d.nombre_estacion = w.nombre_estacion
    and date_trunc('week', d.fecha_day) = w.fecha_week
full outer join monthly_data m
    on coalesce(d.city, w.city) = m.city
    and coalesce(d.nombre_estacion, w.nombre_estacion) = m.nombre_estacion
    and date_trunc('month', d.fecha_day) = m.fecha_month
order by city, nombre_estacion, d.fecha_day
  );
  
[0m10:40:32.374624 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.035 seconds
[0m10:40:32.386465 [debug] [Thread-3 (]: Database Error in model mart_station_summary (models/marts/mart_station_summary.sql)
  column "first_measurement" does not exist
  LINE 21:     first_measurement,
               ^
  compiled code at target/run/data_project_1/models/marts/mart_station_summary.sql
[0m10:40:32.398771 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:40:32.402579 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75251b3f0690>]}
[0m10:40:32.407196 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."analytics"."mart_alerts__dbt_tmp" rename to "mart_alerts"
[0m10:40:32.408618 [debug] [Thread-4 (]: SQL status: SELECT 136 in 0.037 seconds
[0m10:40:32.412324 [error] [Thread-3 (]: 19 of 22 ERROR creating sql table model analytics.mart_station_summary ......... [[31mERROR[0m in 0.35s]
[0m10:40:32.416144 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:40:32.418016 [debug] [Thread-1 (]: SQL status: SELECT 68 in 0.041 seconds
[0m10:40:32.426084 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:40:32.429034 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_station_summary
[0m10:40:32.434727 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: COMMIT
[0m10:40:32.444576 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:40:32.447913 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."analytics"."mart_hourly__dbt_tmp" rename to "mart_hourly"
[0m10:40:32.451748 [debug] [Thread-7 (]: Marking all children of 'model.data_project_1.mart_station_summary' to be skipped because of status 'error'.  Reason: Database Error in model mart_station_summary (models/marts/mart_station_summary.sql)
  column "first_measurement" does not exist
  LINE 21:     first_measurement,
               ^
  compiled code at target/run/data_project_1/models/marts/mart_station_summary.sql.
[0m10:40:32.454678 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:40:32.457468 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."analytics"."mart_fact_air_quality__dbt_tmp" rename to "mart_fact_air_quality"
[0m10:40:32.463229 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:40:32.467718 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: COMMIT
[0m10:40:32.472730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:40:32.476263 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: COMMIT
[0m10:40:32.482699 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m10:40:32.487909 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m10:40:32.491458 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:40:32.501012 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."mart_alerts__dbt_backup"
[0m10:40:32.505013 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:40:32.509280 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: COMMIT
[0m10:40:32.516254 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:40:32.522564 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m10:40:32.532570 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m10:40:32.534021 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
drop table if exists "data_project_1"."analytics"."mart_alerts__dbt_backup" cascade
[0m10:40:32.554324 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."analytics"."mart_hourly__dbt_backup"
[0m10:40:32.556098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m10:40:32.559767 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m10:40:32.567739 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:40:32.575270 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."mart_fact_air_quality__dbt_backup"
[0m10:40:32.583360 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: Close
[0m10:40:32.586986 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
drop table if exists "data_project_1"."analytics"."mart_hourly__dbt_backup" cascade
[0m10:40:32.590896 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:40:32.594546 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7525181944d0>]}
[0m10:40:32.599351 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:40:32.601950 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
drop table if exists "data_project_1"."analytics"."mart_fact_air_quality__dbt_backup" cascade
[0m10:40:32.606116 [info ] [Thread-2 (]: 20 of 22 OK created sql table model analytics.mart_alerts ...................... [[32mSELECT 0[0m in 0.51s]
[0m10:40:32.615110 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: Close
[0m10:40:32.623824 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:40:32.631620 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_alerts
[0m10:40:32.645616 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7525181dfd50>]}
[0m10:40:32.652797 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: Close
[0m10:40:32.668995 [info ] [Thread-4 (]: 21 of 22 OK created sql table model analytics.mart_hourly ...................... [[32mSELECT 136[0m in 0.56s]
[0m10:40:32.687500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '965cd387-4c40-466f-9ebb-824513b082aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7525181d35d0>]}
[0m10:40:32.699904 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_hourly
[0m10:40:32.717723 [info ] [Thread-1 (]: 22 of 22 OK created sql table model analytics.mart_fact_air_quality ............ [[32mSELECT 68[0m in 0.59s]
[0m10:40:32.732680 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_fact_air_quality
[0m10:40:32.750383 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:32.793326 [debug] [MainThread]: On master: BEGIN
[0m10:40:32.803722 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:40:32.881558 [debug] [MainThread]: SQL status: BEGIN in 0.078 seconds
[0m10:40:32.897708 [debug] [MainThread]: On master: COMMIT
[0m10:40:33.001332 [debug] [MainThread]: Using postgres connection "master"
[0m10:40:33.090665 [debug] [MainThread]: On master: COMMIT
[0m10:40:33.296728 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:40:33.363254 [debug] [MainThread]: On master: Close
[0m10:40:33.386549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:33.404778 [debug] [MainThread]: Connection 'model.data_project_1.mart_fact_air_quality' was properly closed.
[0m10:40:33.410989 [debug] [MainThread]: Connection 'model.data_project_1.mart_alerts' was properly closed.
[0m10:40:33.415826 [debug] [MainThread]: Connection 'model.data_project_1.mart_hourly' was properly closed.
[0m10:40:33.432981 [debug] [MainThread]: Connection 'model.data_project_1.mart_station_summary' was properly closed.
[0m10:40:33.443012 [info ] [MainThread]: 
[0m10:40:33.452327 [info ] [MainThread]: Finished running 8 table models, 8 data tests, 6 view models in 0 hours 0 minutes and 4.79 seconds (4.79s).
[0m10:40:33.484870 [debug] [MainThread]: Command end result
[0m10:40:37.556916 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:40:37.763842 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:40:38.887123 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m10:40:38.994287 [info ] [MainThread]: 
[0m10:40:39.057689 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:40:39.172884 [info ] [MainThread]: 
[0m10:40:39.339543 [error] [MainThread]: [31mFailure in model mart_station_summary (models/marts/mart_station_summary.sql)[0m
[0m10:40:39.436636 [error] [MainThread]:   Database Error in model mart_station_summary (models/marts/mart_station_summary.sql)
  column "first_measurement" does not exist
  LINE 21:     first_measurement,
               ^
  compiled code at target/run/data_project_1/models/marts/mart_station_summary.sql
[0m10:40:39.481539 [info ] [MainThread]: 
[0m10:40:39.558431 [info ] [MainThread]:   compiled code at target/compiled/data_project_1/models/marts/mart_station_summary.sql
[0m10:40:39.638899 [info ] [MainThread]: 
[0m10:40:39.709401 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=22
[0m10:40:39.751225 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 14.089195, "process_in_blocks": "4912", "process_kernel_time": 1.608645, "process_mem_max_rss": "135368", "process_out_blocks": "0", "process_user_time": 7.583021}
[0m10:40:39.777339 [debug] [MainThread]: Command `dbt build` failed at 10:40:39.776638 after 14.12 seconds
[0m10:40:39.810343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7525657e1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7525657e1890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75256549f950>]}
[0m10:40:39.828680 [debug] [MainThread]: Flushing usage events
[0m10:40:41.151365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:46:55.408577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dcdcaa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dcd7e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dd1cc790>]}


============================== 10:46:55.447882 | dccdfa02-e4fd-44a4-83e2-ec0c752dfa73 ==============================
[0m10:46:55.447882 [info ] [MainThread]: Running with dbt=1.10.15
[0m10:46:55.452220 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'introspect': 'True', 'invocation_command': 'dbt deps', 'debug': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'printer_width': '80', 'log_format': 'default', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': '/usr/app/dbt', 'indirect_selection': 'eager', 'empty': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True'}
[0m10:46:55.953626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dccdfa02-e4fd-44a4-83e2-ec0c752dfa73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dcdcb990>]}
[0m10:46:56.032760 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:46:56.057080 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:46:56.063338 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.81277597, "process_in_blocks": "11392", "process_kernel_time": 3.528211, "process_mem_max_rss": "104220", "process_out_blocks": "0", "process_user_time": 5.290204}
[0m10:46:56.065859 [debug] [MainThread]: Command `dbt deps` succeeded at 10:46:56.065568 after 0.82 seconds
[0m10:46:56.069367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dcdc15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e16a6b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dd1cd5d0>]}
[0m10:46:56.071936 [debug] [MainThread]: Flushing usage events
[0m10:46:56.804199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:47:00.807504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dece096dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dece09fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dece0946d0>]}


============================== 10:47:00.818761 | 0ca87a6e-ac78-4ac7-bea2-1b2e93772798 ==============================
[0m10:47:00.818761 [info ] [MainThread]: Running with dbt=1.10.15
[0m10:47:00.821434 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/app/dbt', 'quiet': 'False', 'log_format': 'default', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'printer_width': '80', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_path': '/usr/app/dbt/logs', 'invocation_command': 'dbt build --target dev', 'log_cache_events': 'False', 'target_path': 'None'}
[0m10:47:01.156494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dece027c50>]}
[0m10:47:01.366548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ded0dbae50>]}
[0m10:47:01.376439 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:47:01.642880 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m10:47:02.805580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:47:02.809591 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/marts/schema.yml
[0m10:47:03.110605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ded05f9910>]}
[0m10:47:03.704718 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:47:03.726741 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:47:03.824934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ded0ec7c90>]}
[0m10:47:03.827313 [info ] [MainThread]: Found 14 models, 8 data tests, 1 source, 459 macros
[0m10:47:03.834807 [info ] [MainThread]: 
[0m10:47:03.836972 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:47:03.839288 [info ] [MainThread]: 
[0m10:47:03.842050 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:47:03.850749 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1'
[0m10:47:03.923024 [debug] [ThreadPool]: Using postgres connection "list_data_project_1"
[0m10:47:03.925886 [debug] [ThreadPool]: On list_data_project_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1"} */

    select distinct nspname from pg_namespace
  
[0m10:47:03.928027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:03.962128 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.034 seconds
[0m10:47:03.966665 [debug] [ThreadPool]: On list_data_project_1: Close
[0m10:47:03.972693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_project_1, now list_data_project_1_analytics)
[0m10:47:03.986029 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_analytics"
[0m10:47:03.989964 [debug] [ThreadPool]: On list_data_project_1_analytics: BEGIN
[0m10:47:03.992641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:47:04.013474 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m10:47:04.017070 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_analytics"
[0m10:47:04.019895 [debug] [ThreadPool]: On list_data_project_1_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1_analytics"} */
select
      'data_project_1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'data_project_1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'data_project_1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m10:47:04.080342 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.058 seconds
[0m10:47:04.085111 [debug] [ThreadPool]: On list_data_project_1_analytics: ROLLBACK
[0m10:47:04.088407 [debug] [ThreadPool]: On list_data_project_1_analytics: Close
[0m10:47:04.102351 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:04.105770 [debug] [MainThread]: On master: BEGIN
[0m10:47:04.109677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:47:04.137705 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m10:47:04.142325 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:04.146217 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:47:04.286931 [debug] [MainThread]: SQL status: SELECT 11 in 0.135 seconds
[0m10:47:04.301133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77decadaafd0>]}
[0m10:47:04.305748 [debug] [MainThread]: On master: ROLLBACK
[0m10:47:04.321572 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:04.326754 [debug] [MainThread]: On master: BEGIN
[0m10:47:04.334469 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m10:47:04.339255 [debug] [MainThread]: On master: COMMIT
[0m10:47:04.343286 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:04.347087 [debug] [MainThread]: On master: COMMIT
[0m10:47:04.351596 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:47:04.356171 [debug] [MainThread]: On master: Close
[0m10:47:04.402929 [debug] [Thread-1 (]: Began running node model.data_project_1.stg_mediciones_madrid
[0m10:47:04.406663 [debug] [Thread-2 (]: Began running node model.data_project_1.stg_mediciones_valencia
[0m10:47:04.411014 [info ] [Thread-1 (]: 1 of 22 START sql view model analytics.stg_mediciones_madrid ................... [RUN]
[0m10:47:04.418799 [info ] [Thread-2 (]: 2 of 22 START sql view model analytics.stg_mediciones_valencia ................. [RUN]
[0m10:47:04.424818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_project_1_analytics, now model.data_project_1.stg_mediciones_madrid)
[0m10:47:04.444306 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.data_project_1.stg_mediciones_valencia'
[0m10:47:04.457388 [debug] [Thread-1 (]: Began compiling node model.data_project_1.stg_mediciones_madrid
[0m10:47:04.463842 [debug] [Thread-2 (]: Began compiling node model.data_project_1.stg_mediciones_valencia
[0m10:47:04.496761 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_madrid"
[0m10:47:04.508516 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_valencia"
[0m10:47:04.540954 [debug] [Thread-2 (]: Began executing node model.data_project_1.stg_mediciones_valencia
[0m10:47:04.558250 [debug] [Thread-1 (]: Began executing node model.data_project_1.stg_mediciones_madrid
[0m10:47:04.737568 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_madrid"
[0m10:47:04.739257 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_valencia"
[0m10:47:04.758723 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:47:04.761893 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: BEGIN
[0m10:47:04.766238 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:47:04.767445 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:47:04.770810 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: BEGIN
[0m10:47:04.776312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:04.793198 [debug] [Thread-2 (]: SQL status: BEGIN in 0.026 seconds
[0m10:47:04.796294 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:47:04.799479 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */

  create view "data_project_1"."analytics"."stg_mediciones_valencia__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'valencia' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='valencia'
  );
[0m10:47:04.801978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m10:47:04.804970 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:47:04.807565 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */

  create view "data_project_1"."analytics"."stg_mediciones_madrid__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'madrid' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='madrid'
  );
[0m10:47:04.850777 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m10:47:04.852006 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.049 seconds
[0m10:47:04.864661 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:47:04.871037 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:47:04.873331 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."analytics"."stg_mediciones_madrid" rename to "stg_mediciones_madrid__dbt_backup"
[0m10:47:04.875622 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."analytics"."stg_mediciones_valencia" rename to "stg_mediciones_valencia__dbt_backup"
[0m10:47:04.896385 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m10:47:04.897334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m10:47:04.904298 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:47:04.910603 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:47:04.913489 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."analytics"."stg_mediciones_valencia__dbt_tmp" rename to "stg_mediciones_valencia"
[0m10:47:04.915830 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."analytics"."stg_mediciones_madrid__dbt_tmp" rename to "stg_mediciones_madrid"
[0m10:47:04.920886 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:47:04.922927 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:47:04.942920 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m10:47:04.945118 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m10:47:04.948314 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:47:04.951335 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:47:04.954880 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m10:47:04.957774 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m10:47:04.964587 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m10:47:04.977650 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."stg_mediciones_valencia__dbt_backup"
[0m10:47:04.978365 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m10:47:04.987584 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:47:04.991893 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."stg_mediciones_madrid__dbt_backup"
[0m10:47:04.994229 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
drop view if exists "data_project_1"."analytics"."stg_mediciones_valencia__dbt_backup" cascade
[0m10:47:04.997130 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:47:05.000600 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
drop view if exists "data_project_1"."analytics"."stg_mediciones_madrid__dbt_backup" cascade
[0m10:47:05.026417 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.027 seconds
[0m10:47:05.032659 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: Close
[0m10:47:05.037761 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.034 seconds
[0m10:47:05.038578 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77decacc3b50>]}
[0m10:47:05.041631 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: Close
[0m10:47:05.044518 [info ] [Thread-2 (]: 2 of 22 OK created sql view model analytics.stg_mediciones_valencia ............ [[32mCREATE VIEW[0m in 0.59s]
[0m10:47:05.047083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77decac8c6d0>]}
[0m10:47:05.050432 [debug] [Thread-2 (]: Finished running node model.data_project_1.stg_mediciones_valencia
[0m10:47:05.054243 [info ] [Thread-1 (]: 1 of 22 OK created sql view model analytics.stg_mediciones_madrid .............. [[32mCREATE VIEW[0m in 0.62s]
[0m10:47:05.057840 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:47:05.058653 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:47:05.059454 [debug] [Thread-2 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:47:05.061029 [debug] [Thread-1 (]: Finished running node model.data_project_1.stg_mediciones_madrid
[0m10:47:05.063385 [info ] [Thread-4 (]: 3 of 22 START test not_null_stg_mediciones_valencia_fecha_carg ................. [RUN]
[0m10:47:05.066231 [info ] [Thread-3 (]: 4 of 22 START test not_null_stg_mediciones_valencia_id ......................... [RUN]
[0m10:47:05.069448 [info ] [Thread-2 (]: 5 of 22 START test not_null_stg_mediciones_valencia_nombre_estacion ............ [RUN]
[0m10:47:05.071918 [debug] [Thread-1 (]: Began running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:47:05.074296 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e'
[0m10:47:05.076964 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e'
[0m10:47:05.079792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_valencia, now test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046)
[0m10:47:05.082706 [info ] [Thread-1 (]: 6 of 22 START test unique_stg_mediciones_valencia_id ........................... [RUN]
[0m10:47:05.085979 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:47:05.089382 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:47:05.092518 [debug] [Thread-2 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:47:05.095587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_madrid, now test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170)
[0m10:47:05.115826 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:47:05.124945 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:47:05.131514 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:47:05.134916 [debug] [Thread-1 (]: Began compiling node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:47:05.153573 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:47:05.181085 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:47:05.182175 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:47:05.192250 [debug] [Thread-1 (]: Began executing node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:47:05.199750 [debug] [Thread-2 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:47:05.328306 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:47:05.356128 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:47:05.359599 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:47:05.372899 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:47:05.418719 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:47:05.424831 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:47:05.426357 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:47:05.429159 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: BEGIN
[0m10:47:05.434154 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: BEGIN
[0m10:47:05.435978 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:47:05.439718 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: BEGIN
[0m10:47:05.442815 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:47:05.445961 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:47:05.448486 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: BEGIN
[0m10:47:05.450795 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:47:05.457867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:05.478616 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m10:47:05.481566 [debug] [Thread-4 (]: SQL status: BEGIN in 0.038 seconds
[0m10:47:05.483758 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:47:05.484846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m10:47:05.486741 [debug] [Thread-2 (]: SQL status: BEGIN in 0.036 seconds
[0m10:47:05.488075 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:47:05.490278 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."analytics"."stg_mediciones_valencia"
where id is null



  
  
      
    ) dbt_internal_test
[0m10:47:05.492790 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:47:05.494986 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:47:05.497104 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."analytics"."stg_mediciones_valencia"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m10:47:05.500819 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."analytics"."stg_mediciones_valencia"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:47:05.502610 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."analytics"."stg_mediciones_valencia"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m10:47:05.522438 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m10:47:05.523444 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.025 seconds
[0m10:47:05.524365 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m10:47:05.525129 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m10:47:05.531730 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: ROLLBACK
[0m10:47:05.535910 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: ROLLBACK
[0m10:47:05.539642 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: ROLLBACK
[0m10:47:05.543704 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: ROLLBACK
[0m10:47:05.547199 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: Close
[0m10:47:05.549398 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: Close
[0m10:47:05.550846 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: Close
[0m10:47:05.553068 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: Close
[0m10:47:05.555852 [info ] [Thread-4 (]: 3 of 22 PASS not_null_stg_mediciones_valencia_fecha_carg ....................... [[32mPASS[0m in 0.48s]
[0m10:47:05.559625 [info ] [Thread-3 (]: 4 of 22 PASS not_null_stg_mediciones_valencia_id ............................... [[32mPASS[0m in 0.48s]
[0m10:47:05.562371 [info ] [Thread-1 (]: 6 of 22 PASS unique_stg_mediciones_valencia_id ................................. [[32mPASS[0m in 0.47s]
[0m10:47:05.565454 [info ] [Thread-2 (]: 5 of 22 PASS not_null_stg_mediciones_valencia_nombre_estacion .................. [[32mPASS[0m in 0.49s]
[0m10:47:05.568289 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:47:05.571637 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:47:05.575153 [debug] [Thread-1 (]: Finished running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:47:05.578049 [debug] [Thread-2 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:47:05.580745 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:47:05.583599 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:47:05.586208 [debug] [Thread-1 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:47:05.588739 [debug] [Thread-2 (]: Began running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:47:05.592032 [info ] [Thread-4 (]: 7 of 22 START test not_null_stg_mediciones_madrid_fecha_carg ................... [RUN]
[0m10:47:05.595011 [info ] [Thread-3 (]: 8 of 22 START test not_null_stg_mediciones_madrid_id ........................... [RUN]
[0m10:47:05.597887 [info ] [Thread-1 (]: 9 of 22 START test not_null_stg_mediciones_madrid_nombre_estacion .............. [RUN]
[0m10:47:05.600376 [info ] [Thread-2 (]: 10 of 22 START test unique_stg_mediciones_madrid_id ............................ [RUN]
[0m10:47:05.602810 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e, now test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf)
[0m10:47:05.605296 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e, now test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515)
[0m10:47:05.608192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170, now test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2)
[0m10:47:05.611077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046, now test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c)
[0m10:47:05.613743 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:47:05.616405 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:47:05.618979 [debug] [Thread-1 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:47:05.621398 [debug] [Thread-2 (]: Began compiling node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:47:05.632910 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:47:05.644085 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:47:05.655610 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:47:05.665027 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:47:05.687852 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:47:05.688890 [debug] [Thread-1 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:47:05.695572 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:47:05.696240 [debug] [Thread-2 (]: Began executing node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:47:05.696897 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:47:05.710158 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:47:05.717550 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:47:05.727444 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:47:05.746889 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:47:05.751914 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: BEGIN
[0m10:47:05.750919 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:47:05.748552 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:47:05.754515 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:47:05.758222 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: BEGIN
[0m10:47:05.759211 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:47:05.761636 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: BEGIN
[0m10:47:05.767821 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:47:05.771979 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: BEGIN
[0m10:47:05.775497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:05.782339 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m10:47:05.783766 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:47:05.790984 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:47:05.800420 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m10:47:05.802147 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."analytics"."stg_mediciones_madrid"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m10:47:05.805395 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m10:47:05.806197 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:47:05.813247 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:47:05.814495 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m10:47:05.817862 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m10:47:05.818713 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."analytics"."stg_mediciones_madrid"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:47:05.822308 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."analytics"."stg_mediciones_madrid"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m10:47:05.826256 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:47:05.831754 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: ROLLBACK
[0m10:47:05.841655 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:47:05.842579 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."analytics"."stg_mediciones_madrid"
where id is null



  
  
      
    ) dbt_internal_test
[0m10:47:05.845667 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:47:05.847322 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: Close
[0m10:47:05.852120 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: ROLLBACK
[0m10:47:05.860794 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: ROLLBACK
[0m10:47:05.861730 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:47:05.865957 [info ] [Thread-4 (]: 7 of 22 PASS not_null_stg_mediciones_madrid_fecha_carg ......................... [[32mPASS[0m in 0.26s]
[0m10:47:05.873914 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: Close
[0m10:47:05.881768 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: Close
[0m10:47:05.887340 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: ROLLBACK
[0m10:47:05.892193 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:47:05.896989 [info ] [Thread-2 (]: 10 of 22 PASS unique_stg_mediciones_madrid_id .................................. [[32mPASS[0m in 0.29s]
[0m10:47:05.901804 [info ] [Thread-1 (]: 9 of 22 PASS not_null_stg_mediciones_madrid_nombre_estacion .................... [[32mPASS[0m in 0.29s]
[0m10:47:05.905306 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: Close
[0m10:47:05.916160 [debug] [Thread-2 (]: Finished running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:47:05.921913 [debug] [Thread-1 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:47:05.927034 [info ] [Thread-3 (]: 8 of 22 PASS not_null_stg_mediciones_madrid_id ................................. [[32mPASS[0m in 0.32s]
[0m10:47:05.938040 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:47:05.945058 [debug] [Thread-4 (]: Began running node model.data_project_1.int_daily_avg
[0m10:47:05.946426 [debug] [Thread-2 (]: Began running node model.data_project_1.int_hourly_avg
[0m10:47:05.947457 [debug] [Thread-1 (]: Began running node model.data_project_1.int_monthly_avg
[0m10:47:05.949229 [debug] [Thread-3 (]: Began running node model.data_project_1.int_station_summary
[0m10:47:05.952057 [info ] [Thread-4 (]: 11 of 22 START sql view model analytics.int_daily_avg .......................... [RUN]
[0m10:47:05.956737 [info ] [Thread-2 (]: 12 of 22 START sql view model analytics.int_hourly_avg ......................... [RUN]
[0m10:47:05.960752 [info ] [Thread-1 (]: 13 of 22 START sql view model analytics.int_monthly_avg ........................ [RUN]
[0m10:47:05.965080 [info ] [Thread-3 (]: 14 of 22 START sql view model analytics.int_station_summary .................... [RUN]
[0m10:47:05.969246 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf, now model.data_project_1.int_daily_avg)
[0m10:47:05.973661 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c, now model.data_project_1.int_hourly_avg)
[0m10:47:05.978115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2, now model.data_project_1.int_monthly_avg)
[0m10:47:05.982207 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515, now model.data_project_1.int_station_summary)
[0m10:47:05.987056 [debug] [Thread-4 (]: Began compiling node model.data_project_1.int_daily_avg
[0m10:47:05.992329 [debug] [Thread-2 (]: Began compiling node model.data_project_1.int_hourly_avg
[0m10:47:05.996231 [debug] [Thread-1 (]: Began compiling node model.data_project_1.int_monthly_avg
[0m10:47:06.000242 [debug] [Thread-3 (]: Began compiling node model.data_project_1.int_station_summary
[0m10:47:06.013685 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.int_daily_avg"
[0m10:47:06.023022 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.int_hourly_avg"
[0m10:47:06.034563 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.int_monthly_avg"
[0m10:47:06.043819 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.int_station_summary"
[0m10:47:06.066413 [debug] [Thread-2 (]: Began executing node model.data_project_1.int_hourly_avg
[0m10:47:06.074936 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.int_hourly_avg"
[0m10:47:06.081916 [debug] [Thread-3 (]: Began executing node model.data_project_1.int_station_summary
[0m10:47:06.083490 [debug] [Thread-1 (]: Began executing node model.data_project_1.int_monthly_avg
[0m10:47:06.092618 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.int_station_summary"
[0m10:47:06.099651 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.int_monthly_avg"
[0m10:47:06.100259 [debug] [Thread-4 (]: Began executing node model.data_project_1.int_daily_avg
[0m10:47:06.110484 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.int_daily_avg"
[0m10:47:06.114204 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:47:06.116672 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: BEGIN
[0m10:47:06.120078 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:47:06.120925 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:47:06.121677 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:47:06.126636 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:47:06.127795 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: BEGIN
[0m10:47:06.130361 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: BEGIN
[0m10:47:06.132835 [debug] [Thread-4 (]: On model.data_project_1.int_daily_avg: BEGIN
[0m10:47:06.135059 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:47:06.137403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:06.139642 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m10:47:06.140431 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:47:06.147589 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:47:06.152299 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */

  create view "data_project_1"."analytics"."int_hourly_avg__dbt_tmp"
    
    
  as (
    with all_data as (
    select * from "data_project_1"."analytics"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."analytics"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    avg(no2) as no2_avg,
    avg(o3) as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by 1,2,3
order by fecha_hour, city, nombre_estacion
  );
[0m10:47:06.156611 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m10:47:06.160330 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:47:06.163519 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */

  create view "data_project_1"."analytics"."int_station_summary__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."analytics"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."analytics"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m10:47:06.172428 [debug] [Thread-4 (]: SQL status: BEGIN in 0.032 seconds
[0m10:47:06.174219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m10:47:06.176632 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:47:06.179436 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:47:06.181829 [debug] [Thread-4 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */

  create view "data_project_1"."analytics"."int_daily_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."analytics"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."analytics"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m10:47:06.183520 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m10:47:06.184286 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m10:47:06.185459 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */

  create view "data_project_1"."analytics"."int_monthly_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."analytics"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."analytics"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_month,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_month
order by city, nombre_estacion, fecha_month
  );
[0m10:47:06.196814 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:47:06.205408 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m10:47:06.212514 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:47:06.221437 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
alter table "data_project_1"."analytics"."int_station_summary__dbt_tmp" rename to "int_station_summary"
[0m10:47:06.234138 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:47:06.240291 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
alter table "data_project_1"."analytics"."int_hourly_avg__dbt_tmp" rename to "int_hourly_avg"
[0m10:47:06.246889 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m10:47:06.250047 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:47:06.251586 [debug] [Thread-4 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
alter table "data_project_1"."analytics"."int_daily_avg__dbt_tmp" rename to "int_daily_avg"
[0m10:47:06.259559 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:47:06.273633 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:47:06.279344 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: COMMIT
[0m10:47:06.291897 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m10:47:06.293338 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m10:47:06.296319 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
alter table "data_project_1"."analytics"."int_monthly_avg__dbt_tmp" rename to "int_monthly_avg"
[0m10:47:06.300269 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:47:06.303445 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:47:06.309553 [debug] [Thread-4 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m10:47:06.318004 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:47:06.332019 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: COMMIT
[0m10:47:06.337708 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m10:47:06.342606 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:47:06.349612 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m10:47:06.359600 [debug] [Thread-4 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m10:47:06.364491 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m10:47:06.366534 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:47:06.377796 [debug] [Thread-2 (]: SQL status: COMMIT in 0.023 seconds
[0m10:47:06.379664 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."analytics"."int_station_summary__dbt_backup"
[0m10:47:06.382440 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m10:47:06.391391 [debug] [Thread-4 (]: SQL status: COMMIT in 0.021 seconds
[0m10:47:06.394090 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."int_hourly_avg__dbt_backup"
[0m10:47:06.397697 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:47:06.405571 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."analytics"."int_daily_avg__dbt_backup"
[0m10:47:06.406816 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:47:06.410212 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:47:06.412732 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
drop view if exists "data_project_1"."analytics"."int_station_summary__dbt_backup" cascade
[0m10:47:06.415733 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:47:06.420906 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."int_monthly_avg__dbt_backup"
[0m10:47:06.423706 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
drop view if exists "data_project_1"."analytics"."int_hourly_avg__dbt_backup" cascade
[0m10:47:06.429209 [debug] [Thread-4 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
drop view if exists "data_project_1"."analytics"."int_daily_avg__dbt_backup" cascade
[0m10:47:06.432570 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:47:06.433433 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m10:47:06.436181 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:47:06.439333 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:47:06.441222 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
drop view if exists "data_project_1"."analytics"."int_monthly_avg__dbt_backup" cascade
[0m10:47:06.445296 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: Close
[0m10:47:06.449878 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: Close
[0m10:47:06.453294 [debug] [Thread-4 (]: On model.data_project_1.int_daily_avg: Close
[0m10:47:06.456146 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:47:06.458577 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77decacb0510>]}
[0m10:47:06.461123 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77decac65850>]}
[0m10:47:06.463507 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dec835b8d0>]}
[0m10:47:06.467429 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: Close
[0m10:47:06.470394 [info ] [Thread-3 (]: 14 of 22 OK created sql view model analytics.int_station_summary ............... [[32mCREATE VIEW[0m in 0.48s]
[0m10:47:06.473071 [info ] [Thread-2 (]: 12 of 22 OK created sql view model analytics.int_hourly_avg .................... [[32mCREATE VIEW[0m in 0.49s]
[0m10:47:06.475922 [info ] [Thread-4 (]: 11 of 22 OK created sql view model analytics.int_daily_avg ..................... [[32mCREATE VIEW[0m in 0.49s]
[0m10:47:06.479545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77decac51dd0>]}
[0m10:47:06.482304 [debug] [Thread-3 (]: Finished running node model.data_project_1.int_station_summary
[0m10:47:06.485232 [debug] [Thread-2 (]: Finished running node model.data_project_1.int_hourly_avg
[0m10:47:06.488450 [debug] [Thread-4 (]: Finished running node model.data_project_1.int_daily_avg
[0m10:47:06.491396 [info ] [Thread-1 (]: 13 of 22 OK created sql view model analytics.int_monthly_avg ................... [[32mCREATE VIEW[0m in 0.50s]
[0m10:47:06.494439 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_station_summary
[0m10:47:06.496790 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_alerts
[0m10:47:06.498876 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_hourly
[0m10:47:06.501457 [debug] [Thread-1 (]: Finished running node model.data_project_1.int_monthly_avg
[0m10:47:06.504621 [info ] [Thread-3 (]: 15 of 22 START sql table model analytics.mart_station_summary .................. [RUN]
[0m10:47:06.507396 [info ] [Thread-2 (]: 16 of 22 START sql table model analytics.mart_alerts ........................... [RUN]
[0m10:47:06.510464 [info ] [Thread-4 (]: 17 of 22 START sql table model analytics.mart_hourly ........................... [RUN]
[0m10:47:06.513675 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_daily_promedio
[0m10:47:06.517222 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_station_summary, now model.data_project_1.mart_station_summary)
[0m10:47:06.520005 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_hourly_avg, now model.data_project_1.mart_alerts)
[0m10:47:06.522614 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_daily_avg, now model.data_project_1.mart_hourly)
[0m10:47:06.525963 [info ] [Thread-1 (]: 18 of 22 START sql table model analytics.mart_daily_promedio ................... [RUN]
[0m10:47:06.528982 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_station_summary
[0m10:47:06.531057 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_alerts
[0m10:47:06.533120 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_hourly
[0m10:47:06.535844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_monthly_avg, now model.data_project_1.mart_daily_promedio)
[0m10:47:06.542663 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_station_summary"
[0m10:47:06.550314 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_alerts"
[0m10:47:06.556538 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_hourly"
[0m10:47:06.559645 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_daily_promedio
[0m10:47:06.576631 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_daily_promedio"
[0m10:47:06.593062 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_alerts
[0m10:47:06.594149 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_station_summary
[0m10:47:06.602199 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_hourly
[0m10:47:06.617275 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_daily_promedio
[0m10:47:06.645739 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_alerts"
[0m10:47:06.650164 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_station_summary"
[0m10:47:06.656540 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_hourly"
[0m10:47:06.664257 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_daily_promedio"
[0m10:47:06.683274 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:47:06.685444 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:47:06.686257 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: BEGIN
[0m10:47:06.688111 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: BEGIN
[0m10:47:06.691402 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:47:06.693739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:06.696083 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:47:06.703544 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: BEGIN
[0m10:47:06.704947 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m10:47:06.708056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:47:06.711097 [debug] [Thread-3 (]: On model.data_project_1.mart_station_summary: BEGIN
[0m10:47:06.713352 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m10:47:06.717124 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:47:06.718139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m10:47:06.720328 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:47:06.726313 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:47:06.729976 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */

  
    

  create  table "data_project_1"."analytics"."mart_hourly__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select * 
    from "data_project_1"."analytics"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Ãndice de contaminaciÃ³n por hora
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n de NO2 por niveles
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por hora dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_hour order by pm25_avg desc) as ranking_pm25
from hourly_data
order by fecha_hour, city, nombre_estacion
  );
  
[0m10:47:06.731593 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m10:47:06.734390 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */

  
    

  create  table "data_project_1"."analytics"."mart_daily_promedio__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * 
    from "data_project_1"."analytics"."int_daily_avg"
)

select
    city,
    nombre_estacion,
    fecha_day,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Calculamos un Ã­ndice de contaminaciÃ³n promedio
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n del nivel de NO2
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por dÃ­a dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_day order by pm25_avg desc) as ranking_pm25
from daily_data
order by fecha_day, city, nombre_estacion
  );
  
[0m10:47:06.739418 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m10:47:06.743109 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:47:06.747818 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m10:47:06.750753 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */

  
    

  create  table "data_project_1"."analytics"."mart_alerts__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select *
    from "data_project_1"."analytics"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    case 
        when no2_avg > 200 then 'Alerta NO2'
        when o3_avg > 180 then 'Alerta O3'
        when pm10_avg > 150 then 'Alerta PM10'
        when pm25_avg > 75 then 'Alerta PM2.5'
        else null
    end as alerta
from hourly_data
where no2_avg > 200
   or o3_avg > 180
   or pm10_avg > 150
   or pm25_avg > 75
order by fecha_hour, city, nombre_estacion
  );
  
[0m10:47:06.754321 [debug] [Thread-3 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */

  
    

  create  table "data_project_1"."analytics"."mart_station_summary__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    nombre_estacion,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    first_measurement,
    last_measurement,
    case
        when pm25_avg > 50 then 'Alto'
        when pm25_avg > 25 then 'Moderado'
        else 'Bajo'
    end as nivel_pm25
from "data_project_1"."analytics"."int_station_summary"
  );
  
[0m10:47:06.767398 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "first_measurement" does not exist
LINE 21:     first_measurement,
             ^

[0m10:47:06.771610 [debug] [Thread-3 (]: On model.data_project_1.mart_station_summary: ROLLBACK
[0m10:47:06.776485 [debug] [Thread-3 (]: On model.data_project_1.mart_station_summary: Close
[0m10:47:06.780448 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.022 seconds
[0m10:47:06.783645 [debug] [Thread-1 (]: SQL status: SELECT 68 in 0.037 seconds
[0m10:47:06.784817 [debug] [Thread-4 (]: SQL status: SELECT 136 in 0.044 seconds
[0m10:47:06.798186 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:47:06.804756 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:47:06.810111 [debug] [Thread-3 (]: Database Error in model mart_station_summary (models/marts/mart_station_summary.sql)
  column "first_measurement" does not exist
  LINE 21:     first_measurement,
               ^
  compiled code at target/run/data_project_1/models/marts/mart_station_summary.sql
[0m10:47:06.815628 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:47:06.818824 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."analytics"."mart_alerts" rename to "mart_alerts__dbt_backup"
[0m10:47:06.821494 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."analytics"."mart_daily_promedio" rename to "mart_daily_promedio__dbt_backup"
[0m10:47:06.824617 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dece047250>]}
[0m10:47:06.827076 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."analytics"."mart_hourly" rename to "mart_hourly__dbt_backup"
[0m10:47:06.831036 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:47:06.835384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:47:06.834652 [error] [Thread-3 (]: 15 of 22 ERROR creating sql table model analytics.mart_station_summary ......... [[31mERROR[0m in 0.31s]
[0m10:47:06.840021 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:47:06.844842 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:47:06.853772 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:47:06.856691 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_station_summary
[0m10:47:06.863669 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:47:06.865874 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."analytics"."mart_alerts__dbt_tmp" rename to "mart_alerts"
[0m10:47:06.868456 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."analytics"."mart_daily_promedio__dbt_tmp" rename to "mart_daily_promedio"
[0m10:47:06.870714 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_top_polluted_stations
[0m10:47:06.871504 [debug] [Thread-7 (]: Marking all children of 'model.data_project_1.mart_station_summary' to be skipped because of status 'error'.  Reason: Database Error in model mart_station_summary (models/marts/mart_station_summary.sql)
  column "first_measurement" does not exist
  LINE 21:     first_measurement,
               ^
  compiled code at target/run/data_project_1/models/marts/mart_station_summary.sql.
[0m10:47:06.873610 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."analytics"."mart_hourly__dbt_tmp" rename to "mart_hourly"
[0m10:47:06.877439 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:47:06.879356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:47:06.880898 [info ] [Thread-3 (]: 19 of 22 START sql table model analytics.mart_top_polluted_stations ............ [RUN]
[0m10:47:06.888564 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: COMMIT
[0m10:47:06.889499 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:47:06.894059 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m10:47:06.896992 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_station_summary, now model.data_project_1.mart_top_polluted_stations)
[0m10:47:06.899080 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:47:06.902822 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: COMMIT
[0m10:47:06.905143 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:47:06.908293 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_top_polluted_stations
[0m10:47:06.910680 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: COMMIT
[0m10:47:06.912844 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:47:06.914959 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m10:47:06.921558 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_top_polluted_stations"
[0m10:47:06.926240 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: COMMIT
[0m10:47:06.926959 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m10:47:06.941179 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:47:06.948765 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."mart_alerts__dbt_backup"
[0m10:47:06.954592 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."mart_daily_promedio__dbt_backup"
[0m10:47:06.955834 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m10:47:06.963254 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:47:06.965873 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:47:06.971253 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."analytics"."mart_hourly__dbt_backup"
[0m10:47:06.974279 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
drop table if exists "data_project_1"."analytics"."mart_alerts__dbt_backup" cascade
[0m10:47:06.978330 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
drop table if exists "data_project_1"."analytics"."mart_daily_promedio__dbt_backup" cascade
[0m10:47:06.979697 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_top_polluted_stations
[0m10:47:06.983868 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:47:06.999199 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_top_polluted_stations"
[0m10:47:07.002279 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
drop table if exists "data_project_1"."analytics"."mart_hourly__dbt_backup" cascade
[0m10:47:07.031391 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.040 seconds
[0m10:47:07.032170 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.022 seconds
[0m10:47:07.032839 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.045 seconds
[0m10:47:07.034312 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:47:07.036764 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: Close
[0m10:47:07.040838 [debug] [Thread-4 (]: On model.data_project_1.mart_hourly: Close
[0m10:47:07.045136 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: Close
[0m10:47:07.048270 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: BEGIN
[0m10:47:07.051554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dec8221650>]}
[0m10:47:07.053948 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77decad53450>]}
[0m10:47:07.057083 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dec83b6c10>]}
[0m10:47:07.059615 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:47:07.062650 [info ] [Thread-1 (]: 18 of 22 OK created sql table model analytics.mart_daily_promedio .............. [[32mSELECT 68[0m in 0.52s]
[0m10:47:07.066415 [info ] [Thread-4 (]: 17 of 22 OK created sql table model analytics.mart_hourly ...................... [[32mSELECT 136[0m in 0.53s]
[0m10:47:07.070067 [info ] [Thread-2 (]: 16 of 22 OK created sql table model analytics.mart_alerts ...................... [[32mSELECT 0[0m in 0.54s]
[0m10:47:07.076117 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_daily_promedio
[0m10:47:07.079775 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_hourly
[0m10:47:07.082863 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_alerts
[0m10:47:07.086592 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_weekly_extended
[0m10:47:07.089600 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m10:47:07.090724 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_monthly_promedio
[0m10:47:07.096379 [info ] [Thread-1 (]: 20 of 22 START sql table model analytics.mart_weekly_extended .................. [RUN]
[0m10:47:07.098487 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:47:07.101339 [info ] [Thread-4 (]: 21 of 22 START sql table model analytics.mart_monthly_promedio ................. [RUN]
[0m10:47:07.104139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_daily_promedio, now model.data_project_1.mart_weekly_extended)
[0m10:47:07.107662 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */

  
    

  create  table "data_project_1"."analytics"."mart_top_polluted_stations__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."analytics"."int_daily_avg"
),

ranked as (
    select
        city,
        nombre_estacion,
        fecha_day,
        no2_avg,
        o3_avg,
        pm10_avg,
        pm25_avg,
        rank() over (partition by city, fecha_day order by pm25_avg desc) as rank_pm25,
        rank() over (partition by city, fecha_day order by pm10_avg desc) as rank_pm10
    from daily_data
)

select *
from ranked
where rank_pm25 <= 5 or rank_pm10 <= 5
order by fecha_day, city, rank_pm25, rank_pm10
  );
  
[0m10:47:07.110703 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_hourly, now model.data_project_1.mart_monthly_promedio)
[0m10:47:07.113814 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_weekly_extended
[0m10:47:07.117961 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_monthly_promedio
[0m10:47:07.124597 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_weekly_extended"
[0m10:47:07.132447 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_monthly_promedio"
[0m10:47:07.138548 [debug] [Thread-3 (]: SQL status: SELECT 36 in 0.022 seconds
[0m10:47:07.145333 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:47:07.147701 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."analytics"."mart_top_polluted_stations" rename to "mart_top_polluted_stations__dbt_backup"
[0m10:47:07.151627 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:47:07.161160 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:47:07.164584 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."analytics"."mart_top_polluted_stations__dbt_tmp" rename to "mart_top_polluted_stations"
[0m10:47:07.166005 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_weekly_extended
[0m10:47:07.168436 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_monthly_promedio
[0m10:47:07.169132 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:47:07.176750 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_weekly_extended"
[0m10:47:07.184562 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_monthly_promedio"
[0m10:47:07.188675 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m10:47:07.195929 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:47:07.199317 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m10:47:07.205735 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m10:47:07.214213 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."analytics"."mart_top_polluted_stations__dbt_backup"
[0m10:47:07.215100 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:47:07.216270 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:47:07.219026 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:47:07.221710 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: BEGIN
[0m10:47:07.225034 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: BEGIN
[0m10:47:07.228461 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
drop table if exists "data_project_1"."analytics"."mart_top_polluted_stations__dbt_backup" cascade
[0m10:47:07.231250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:47:07.233972 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:47:07.246205 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m10:47:07.252713 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: Close
[0m10:47:07.257861 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dec8146e90>]}
[0m10:47:07.261670 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m10:47:07.262778 [debug] [Thread-4 (]: SQL status: BEGIN in 0.029 seconds
[0m10:47:07.266946 [info ] [Thread-3 (]: 19 of 22 OK created sql table model analytics.mart_top_polluted_stations ....... [[32mSELECT 36[0m in 0.36s]
[0m10:47:07.270218 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:47:07.274255 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:47:07.279990 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_top_polluted_stations
[0m10:47:07.283771 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */

  
    

  create  table "data_project_1"."analytics"."mart_weekly_extended__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."analytics"."int_daily_avg"
),

weekly_data as (
    select
        city,
        nombre_estacion,
        date_trunc('week', fecha_day) as fecha_week,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg
    from daily_data
    group by city, nombre_estacion, date_trunc('week', fecha_day)
)

select
    *,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2
from weekly_data
order by fecha_week, city, nombre_estacion
  );
  
[0m10:47:07.286681 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */

  
    

  create  table "data_project_1"."analytics"."mart_monthly_promedio__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    nombre_estacion,
    fecha_month,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as contaminacion_promedio
from "data_project_1"."analytics"."int_monthly_avg"
  );
  
[0m10:47:07.318701 [debug] [Thread-4 (]: SQL status: SELECT 34 in 0.022 seconds
[0m10:47:07.326705 [debug] [Thread-1 (]: SQL status: SELECT 34 in 0.032 seconds
[0m10:47:07.340576 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:47:07.364247 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:47:07.369265 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."analytics"."mart_monthly_promedio" rename to "mart_monthly_promedio__dbt_backup"
[0m10:47:07.379839 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."analytics"."mart_weekly_extended" rename to "mart_weekly_extended__dbt_backup"
[0m10:47:07.390437 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:47:07.405356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:47:07.426640 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:47:07.439589 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:47:07.446811 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."analytics"."mart_monthly_promedio__dbt_tmp" rename to "mart_monthly_promedio"
[0m10:47:07.461543 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."analytics"."mart_weekly_extended__dbt_tmp" rename to "mart_weekly_extended"
[0m10:47:07.471962 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:47:07.485653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:47:07.509083 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m10:47:07.540643 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m10:47:07.548206 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:47:07.561622 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:47:07.575801 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m10:47:07.602165 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m10:47:07.624558 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m10:47:07.646279 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."analytics"."mart_monthly_promedio__dbt_backup"
[0m10:47:07.647374 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m10:47:07.655911 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:47:07.665259 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."mart_weekly_extended__dbt_backup"
[0m10:47:07.672260 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
drop table if exists "data_project_1"."analytics"."mart_monthly_promedio__dbt_backup" cascade
[0m10:47:07.681270 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:47:07.692777 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
drop table if exists "data_project_1"."analytics"."mart_weekly_extended__dbt_backup" cascade
[0m10:47:07.705467 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.020 seconds
[0m10:47:07.720587 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: Close
[0m10:47:07.734258 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77decc1cd790>]}
[0m10:47:07.757745 [info ] [Thread-4 (]: 21 of 22 OK created sql table model analytics.mart_monthly_promedio ............ [[32mSELECT 34[0m in 0.62s]
[0m10:47:07.762289 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.065 seconds
[0m10:47:07.765827 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_monthly_promedio
[0m10:47:07.789092 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: Close
[0m10:47:07.822710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77decacc3c50>]}
[0m10:47:07.851815 [info ] [Thread-1 (]: 20 of 22 OK created sql table model analytics.mart_weekly_extended ............. [[32mSELECT 34[0m in 0.72s]
[0m10:47:07.867870 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_weekly_extended
[0m10:47:07.901663 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_fact_air_quality
[0m10:47:07.922694 [info ] [Thread-2 (]: 22 of 22 START sql table model analytics.mart_fact_air_quality ................. [RUN]
[0m10:47:07.951362 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_alerts, now model.data_project_1.mart_fact_air_quality)
[0m10:47:08.017437 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_fact_air_quality
[0m10:47:08.077945 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_fact_air_quality"
[0m10:47:08.230893 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_fact_air_quality
[0m10:47:08.257625 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_fact_air_quality"
[0m10:47:08.495991 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:47:08.512982 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: BEGIN
[0m10:47:08.529820 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:47:08.653212 [debug] [Thread-2 (]: SQL status: BEGIN in 0.123 seconds
[0m10:47:08.717169 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:47:08.770934 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */

  
    

  create  table "data_project_1"."analytics"."mart_fact_air_quality__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * from "data_project_1"."analytics"."int_daily_avg"
),
weekly_data as (
    select * from "data_project_1"."analytics"."mart_weekly_extended"
),
monthly_data as (
    select * from "data_project_1"."analytics"."int_monthly_avg"
)

select
    coalesce(d.city, w.city, m.city) as city,
    coalesce(d.nombre_estacion, w.nombre_estacion, m.nombre_estacion) as nombre_estacion,
    d.fecha_day,
    w.fecha_week,
    m.fecha_month,
    d.no2_avg as daily_no2,
    d.o3_avg as daily_o3,
    d.pm10_avg as daily_pm10,
    d.pm25_avg as daily_pm25,
    w.no2_avg as weekly_no2,
    w.o3_avg as weekly_o3,
    w.pm10_avg as weekly_pm10,
    w.pm25_avg as weekly_pm25,
    m.no2_avg as monthly_no2,
    m.o3_avg as monthly_o3,
    m.pm10_avg as monthly_pm10,
    m.pm25_avg as monthly_pm25
from daily_data d
full outer join weekly_data w
    on d.city = w.city
    and d.nombre_estacion = w.nombre_estacion
    and date_trunc('week', d.fecha_day) = w.fecha_week
full outer join monthly_data m
    on coalesce(d.city, w.city) = m.city
    and coalesce(d.nombre_estacion, w.nombre_estacion) = m.nombre_estacion
    and date_trunc('month', d.fecha_day) = m.fecha_month
order by city, nombre_estacion, d.fecha_day
  );
  
[0m10:47:09.084509 [debug] [Thread-2 (]: SQL status: SELECT 68 in 0.286 seconds
[0m10:47:09.120695 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:47:09.125345 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."analytics"."mart_fact_air_quality" rename to "mart_fact_air_quality__dbt_backup"
[0m10:47:09.139513 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m10:47:09.164540 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:47:09.187424 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."analytics"."mart_fact_air_quality__dbt_tmp" rename to "mart_fact_air_quality"
[0m10:47:09.302695 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:47:09.370293 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m10:47:09.440003 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:47:09.529626 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m10:47:09.637585 [debug] [Thread-2 (]: SQL status: COMMIT in 0.048 seconds
[0m10:47:09.737799 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."mart_fact_air_quality__dbt_backup"
[0m10:47:09.839068 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:47:09.996130 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
drop table if exists "data_project_1"."analytics"."mart_fact_air_quality__dbt_backup" cascade
[0m10:47:10.170905 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.053 seconds
[0m10:47:10.212452 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: Close
[0m10:47:10.233285 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ca87a6e-ac78-4ac7-bea2-1b2e93772798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dec8182510>]}
[0m10:47:10.254491 [info ] [Thread-2 (]: 22 of 22 OK created sql table model analytics.mart_fact_air_quality ............ [[32mSELECT 68[0m in 2.28s]
[0m10:47:10.269260 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_fact_air_quality
[0m10:47:10.388161 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:10.519588 [debug] [MainThread]: On master: BEGIN
[0m10:47:10.666750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:47:10.801721 [debug] [MainThread]: SQL status: BEGIN in 0.135 seconds
[0m10:47:10.833559 [debug] [MainThread]: On master: COMMIT
[0m10:47:10.903454 [debug] [MainThread]: Using postgres connection "master"
[0m10:47:11.003575 [debug] [MainThread]: On master: COMMIT
[0m10:47:11.100850 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:47:11.217328 [debug] [MainThread]: On master: Close
[0m10:47:11.316690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:11.451800 [debug] [MainThread]: Connection 'model.data_project_1.mart_weekly_extended' was properly closed.
[0m10:47:11.511695 [debug] [MainThread]: Connection 'model.data_project_1.mart_fact_air_quality' was properly closed.
[0m10:47:11.540330 [debug] [MainThread]: Connection 'model.data_project_1.mart_monthly_promedio' was properly closed.
[0m10:47:11.544927 [debug] [MainThread]: Connection 'model.data_project_1.mart_top_polluted_stations' was properly closed.
[0m10:47:11.549805 [info ] [MainThread]: 
[0m10:47:11.555532 [info ] [MainThread]: Finished running 8 table models, 8 data tests, 6 view models in 0 hours 0 minutes and 7.71 seconds (7.71s).
[0m10:47:11.568425 [debug] [MainThread]: Command end result
[0m10:47:12.334702 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:47:13.164662 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:47:13.774500 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m10:47:13.865144 [info ] [MainThread]: 
[0m10:47:13.925431 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:47:14.000048 [info ] [MainThread]: 
[0m10:47:14.095182 [error] [MainThread]: [31mFailure in model mart_station_summary (models/marts/mart_station_summary.sql)[0m
[0m10:47:14.177278 [error] [MainThread]:   Database Error in model mart_station_summary (models/marts/mart_station_summary.sql)
  column "first_measurement" does not exist
  LINE 21:     first_measurement,
               ^
  compiled code at target/run/data_project_1/models/marts/mart_station_summary.sql
[0m10:47:14.255420 [info ] [MainThread]: 
[0m10:47:14.346047 [info ] [MainThread]:   compiled code at target/compiled/data_project_1/models/marts/mart_station_summary.sql
[0m10:47:14.461352 [info ] [MainThread]: 
[0m10:47:14.540503 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=22
[0m10:47:14.599404 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 13.948283, "process_in_blocks": "3808", "process_kernel_time": 1.328125, "process_mem_max_rss": "133316", "process_out_blocks": "0", "process_user_time": 7.40592}
[0m10:47:14.670190 [debug] [MainThread]: Command `dbt build` failed at 10:47:14.669575 after 14.02 seconds
[0m10:47:14.739961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77decaeea1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77ded289b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77dece2e8590>]}
[0m10:47:14.810549 [debug] [MainThread]: Flushing usage events
[0m10:47:16.205837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:56:51.114342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756498fa72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564964c85d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756498fbeb10>]}


============================== 10:56:51.131272 | 1d9ec21a-fa28-4378-a8e6-133f04800fe9 ==============================
[0m10:56:51.131272 [info ] [MainThread]: Running with dbt=1.10.15
[0m10:56:51.134978 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'log_path': '/usr/app/dbt/logs', 'invocation_command': 'dbt deps', 'indirect_selection': 'eager', 'introspect': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'printer_width': '80', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False'}
[0m10:56:51.445739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d9ec21a-fa28-4378-a8e6-133f04800fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756498b0f950>]}
[0m10:56:51.545195 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:56:51.621258 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:56:51.630826 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7119769, "process_in_blocks": "27480", "process_kernel_time": 2.917998, "process_mem_max_rss": "103612", "process_out_blocks": "0", "process_user_time": 4.899561}
[0m10:56:51.639311 [debug] [MainThread]: Command `dbt deps` succeeded at 10:56:51.638938 after 0.72 seconds
[0m10:56:51.644544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564989c32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564962b92d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756497132790>]}
[0m10:56:51.648689 [debug] [MainThread]: Flushing usage events
[0m10:56:52.541093 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:56:57.920716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ad46c0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ad49f9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ad4673b10>]}


============================== 10:56:57.932701 | c902803a-c3e4-45d2-b674-1990f4e49575 ==============================
[0m10:56:57.932701 [info ] [MainThread]: Running with dbt=1.10.15
[0m10:56:57.935497 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'quiet': 'False', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/usr/app/dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target dev', 'printer_width': '80', 'log_format': 'default', 'introspect': 'True', 'empty': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'write_json': 'True', 'log_path': '/usr/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False'}
[0m10:56:58.331539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ad3bf4e50>]}
[0m10:56:58.447741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ad73dea90>]}
[0m10:56:58.453006 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:56:58.666076 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m10:56:59.713677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:56:59.718518 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/marts/schema.yml
[0m10:56:59.720933 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/marts/mart_station_summary.sql
[0m10:57:00.629593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ad00ff610>]}
[0m10:57:01.079554 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:57:01.126175 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:57:01.290718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ad00ffc50>]}
[0m10:57:01.294604 [info ] [MainThread]: Found 14 models, 8 data tests, 1 source, 459 macros
[0m10:57:01.309686 [info ] [MainThread]: 
[0m10:57:01.314896 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:57:01.319171 [info ] [MainThread]: 
[0m10:57:01.323890 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:01.341382 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1'
[0m10:57:01.459527 [debug] [ThreadPool]: Using postgres connection "list_data_project_1"
[0m10:57:01.463383 [debug] [ThreadPool]: On list_data_project_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1"} */

    select distinct nspname from pg_namespace
  
[0m10:57:01.466053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:01.512928 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.047 seconds
[0m10:57:01.518937 [debug] [ThreadPool]: On list_data_project_1: Close
[0m10:57:01.524520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_project_1, now list_data_project_1_analytics)
[0m10:57:01.536597 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_analytics"
[0m10:57:01.539323 [debug] [ThreadPool]: On list_data_project_1_analytics: BEGIN
[0m10:57:01.541551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:01.566573 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m10:57:01.569617 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_analytics"
[0m10:57:01.571557 [debug] [ThreadPool]: On list_data_project_1_analytics: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1_analytics"} */
select
      'data_project_1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'data_project_1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'data_project_1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m10:57:01.649873 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.076 seconds
[0m10:57:01.655263 [debug] [ThreadPool]: On list_data_project_1_analytics: ROLLBACK
[0m10:57:01.658731 [debug] [ThreadPool]: On list_data_project_1_analytics: Close
[0m10:57:01.676525 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:01.679905 [debug] [MainThread]: On master: BEGIN
[0m10:57:01.683478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:01.707905 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m10:57:01.711359 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:01.715344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:57:01.759549 [debug] [MainThread]: SQL status: SELECT 11 in 0.040 seconds
[0m10:57:01.767564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ad012fe10>]}
[0m10:57:01.771381 [debug] [MainThread]: On master: ROLLBACK
[0m10:57:01.775096 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:01.778206 [debug] [MainThread]: On master: BEGIN
[0m10:57:01.782652 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:57:01.785969 [debug] [MainThread]: On master: COMMIT
[0m10:57:01.787998 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:01.790175 [debug] [MainThread]: On master: COMMIT
[0m10:57:01.793049 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:57:01.795739 [debug] [MainThread]: On master: Close
[0m10:57:01.810872 [debug] [Thread-1 (]: Began running node model.data_project_1.stg_mediciones_madrid
[0m10:57:01.811611 [debug] [Thread-2 (]: Began running node model.data_project_1.stg_mediciones_valencia
[0m10:57:01.813976 [info ] [Thread-1 (]: 1 of 22 START sql view model analytics.stg_mediciones_madrid ................... [RUN]
[0m10:57:01.817166 [info ] [Thread-2 (]: 2 of 22 START sql view model analytics.stg_mediciones_valencia ................. [RUN]
[0m10:57:01.821778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_project_1_analytics, now model.data_project_1.stg_mediciones_madrid)
[0m10:57:01.825597 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.data_project_1.stg_mediciones_valencia'
[0m10:57:01.829000 [debug] [Thread-1 (]: Began compiling node model.data_project_1.stg_mediciones_madrid
[0m10:57:01.831171 [debug] [Thread-2 (]: Began compiling node model.data_project_1.stg_mediciones_valencia
[0m10:57:01.848539 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_madrid"
[0m10:57:01.855760 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_valencia"
[0m10:57:01.895715 [debug] [Thread-1 (]: Began executing node model.data_project_1.stg_mediciones_madrid
[0m10:57:01.909558 [debug] [Thread-2 (]: Began executing node model.data_project_1.stg_mediciones_valencia
[0m10:57:02.046115 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_madrid"
[0m10:57:02.049873 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_valencia"
[0m10:57:02.082024 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:57:02.091075 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: BEGIN
[0m10:57:02.095589 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:57:02.093662 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:57:02.105582 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: BEGIN
[0m10:57:02.113795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:02.155582 [debug] [Thread-2 (]: SQL status: BEGIN in 0.059 seconds
[0m10:57:02.171104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m10:57:02.174618 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:57:02.182936 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:57:02.188756 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */

  create view "data_project_1"."analytics"."stg_mediciones_valencia__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'valencia' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='valencia'
  );
[0m10:57:02.193242 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */

  create view "data_project_1"."analytics"."stg_mediciones_madrid__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'madrid' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='madrid'
  );
[0m10:57:02.413043 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.216 seconds
[0m10:57:02.459546 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.256 seconds
[0m10:57:02.508234 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:57:02.525350 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:57:02.539282 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."analytics"."stg_mediciones_valencia" rename to "stg_mediciones_valencia__dbt_backup"
[0m10:57:02.548677 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."analytics"."stg_mediciones_madrid" rename to "stg_mediciones_madrid__dbt_backup"
[0m10:57:02.565568 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:57:02.569545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:57:02.586001 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:57:02.603657 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:57:02.607968 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."analytics"."stg_mediciones_valencia__dbt_tmp" rename to "stg_mediciones_valencia"
[0m10:57:02.612776 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."analytics"."stg_mediciones_madrid__dbt_tmp" rename to "stg_mediciones_madrid"
[0m10:57:02.622435 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:57:02.631420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:57:02.722857 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m10:57:02.730657 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m10:57:02.736794 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:57:02.742763 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:57:02.748164 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m10:57:02.752777 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m10:57:02.774507 [debug] [Thread-2 (]: SQL status: COMMIT in 0.018 seconds
[0m10:57:02.776514 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m10:57:02.792603 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."stg_mediciones_valencia__dbt_backup"
[0m10:57:02.797664 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."stg_mediciones_madrid__dbt_backup"
[0m10:57:02.811439 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m10:57:02.813573 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m10:57:02.816191 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
drop view if exists "data_project_1"."analytics"."stg_mediciones_valencia__dbt_backup" cascade
[0m10:57:02.818773 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
drop view if exists "data_project_1"."analytics"."stg_mediciones_madrid__dbt_backup" cascade
[0m10:57:02.865500 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.041 seconds
[0m10:57:02.881750 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: Close
[0m10:57:02.882557 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.061 seconds
[0m10:57:02.887795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725aca753350>]}
[0m10:57:02.891468 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: Close
[0m10:57:02.894512 [info ] [Thread-1 (]: 1 of 22 OK created sql view model analytics.stg_mediciones_madrid .............. [[32mCREATE VIEW[0m in 1.06s]
[0m10:57:02.897652 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725aca63b050>]}
[0m10:57:02.900432 [debug] [Thread-1 (]: Finished running node model.data_project_1.stg_mediciones_madrid
[0m10:57:02.903569 [info ] [Thread-2 (]: 2 of 22 OK created sql view model analytics.stg_mediciones_valencia ............ [[32mCREATE VIEW[0m in 1.07s]
[0m10:57:02.908610 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:57:02.909545 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:57:02.910932 [debug] [Thread-1 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:57:02.913215 [debug] [Thread-2 (]: Finished running node model.data_project_1.stg_mediciones_valencia
[0m10:57:02.916494 [info ] [Thread-4 (]: 3 of 22 START test not_null_stg_mediciones_madrid_fecha_carg ................... [RUN]
[0m10:57:02.921755 [info ] [Thread-3 (]: 4 of 22 START test not_null_stg_mediciones_madrid_id ........................... [RUN]
[0m10:57:02.926356 [info ] [Thread-1 (]: 5 of 22 START test not_null_stg_mediciones_madrid_nombre_estacion .............. [RUN]
[0m10:57:02.929827 [debug] [Thread-2 (]: Began running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:57:02.934072 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf'
[0m10:57:02.938019 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515'
[0m10:57:02.942514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_madrid, now test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2)
[0m10:57:02.946534 [info ] [Thread-2 (]: 6 of 22 START test unique_stg_mediciones_madrid_id ............................. [RUN]
[0m10:57:02.950728 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:57:02.955413 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:57:02.960415 [debug] [Thread-1 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:57:02.966824 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_valencia, now test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c)
[0m10:57:03.003426 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:57:03.005846 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:57:03.021173 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:57:03.023670 [debug] [Thread-2 (]: Began compiling node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:57:03.051490 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:57:03.063771 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:57:03.067189 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:57:03.074730 [debug] [Thread-1 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:57:03.085906 [debug] [Thread-2 (]: Began executing node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:57:03.137690 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:57:03.146592 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:57:03.151863 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:57:03.161733 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:57:03.185841 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:57:03.187949 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:57:03.192075 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: BEGIN
[0m10:57:03.193103 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:57:03.195665 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: BEGIN
[0m10:57:03.197178 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:57:03.200627 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:03.203359 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: BEGIN
[0m10:57:03.206519 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:57:03.209308 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: BEGIN
[0m10:57:03.214503 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:57:03.220217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:03.233826 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m10:57:03.238302 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m10:57:03.243370 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."analytics"."stg_mediciones_madrid"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:57:03.252412 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m10:57:03.253406 [debug] [Thread-3 (]: SQL status: BEGIN in 0.039 seconds
[0m10:57:03.256184 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m10:57:03.260011 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m10:57:03.263135 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."analytics"."stg_mediciones_madrid"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m10:57:03.266177 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m10:57:03.268234 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.020 seconds
[0m10:57:03.269136 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."analytics"."stg_mediciones_madrid"
where id is null



  
  
      
    ) dbt_internal_test
[0m10:57:03.275495 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m10:57:03.287969 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: ROLLBACK
[0m10:57:03.289128 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m10:57:03.294003 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."analytics"."stg_mediciones_madrid"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m10:57:03.297781 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:57:03.298807 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: Close
[0m10:57:03.304793 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: ROLLBACK
[0m10:57:03.314347 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: ROLLBACK
[0m10:57:03.316877 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m10:57:03.320416 [info ] [Thread-2 (]: 6 of 22 PASS unique_stg_mediciones_madrid_id ................................... [[32mPASS[0m in 0.35s]
[0m10:57:03.325351 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: Close
[0m10:57:03.328624 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: Close
[0m10:57:03.334890 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: ROLLBACK
[0m10:57:03.340992 [debug] [Thread-2 (]: Finished running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m10:57:03.344836 [info ] [Thread-4 (]: 3 of 22 PASS not_null_stg_mediciones_madrid_fecha_carg ......................... [[32mPASS[0m in 0.41s]
[0m10:57:03.348915 [info ] [Thread-3 (]: 4 of 22 PASS not_null_stg_mediciones_madrid_id ................................. [[32mPASS[0m in 0.41s]
[0m10:57:03.353664 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: Close
[0m10:57:03.356333 [debug] [Thread-2 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:57:03.361310 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m10:57:03.365629 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m10:57:03.370236 [info ] [Thread-1 (]: 5 of 22 PASS not_null_stg_mediciones_madrid_nombre_estacion .................... [[32mPASS[0m in 0.43s]
[0m10:57:03.378287 [info ] [Thread-2 (]: 7 of 22 START test not_null_stg_mediciones_valencia_fecha_carg ................. [RUN]
[0m10:57:03.382491 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:57:03.385843 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:57:03.391262 [debug] [Thread-1 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m10:57:03.395115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c, now test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e)
[0m10:57:03.398812 [info ] [Thread-4 (]: 8 of 22 START test not_null_stg_mediciones_valencia_id ......................... [RUN]
[0m10:57:03.402401 [info ] [Thread-3 (]: 9 of 22 START test not_null_stg_mediciones_valencia_nombre_estacion ............ [RUN]
[0m10:57:03.409360 [debug] [Thread-1 (]: Began running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:57:03.413628 [debug] [Thread-2 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:57:03.416897 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf, now test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e)
[0m10:57:03.419753 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515, now test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046)
[0m10:57:03.425660 [info ] [Thread-1 (]: 10 of 22 START test unique_stg_mediciones_valencia_id .......................... [RUN]
[0m10:57:03.441292 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:57:03.444774 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:57:03.447792 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:57:03.451479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2, now test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170)
[0m10:57:03.471961 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:57:03.487094 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:57:03.489159 [debug] [Thread-1 (]: Began compiling node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:57:03.492571 [debug] [Thread-2 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:57:03.506882 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:57:03.517183 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:57:03.518228 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:57:03.519305 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:57:03.533697 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:57:03.542522 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:57:03.551363 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:57:03.555322 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: BEGIN
[0m10:57:03.556726 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:57:03.557702 [debug] [Thread-1 (]: Began executing node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:57:03.559367 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:57:03.561072 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:03.563828 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: BEGIN
[0m10:57:03.573730 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:57:03.576193 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: BEGIN
[0m10:57:03.581855 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:03.588008 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:03.605311 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m10:57:03.608682 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m10:57:03.612166 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."analytics"."stg_mediciones_valencia"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m10:57:03.614832 [debug] [Thread-4 (]: SQL status: BEGIN in 0.027 seconds
[0m10:57:03.619245 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:57:03.622624 [debug] [Thread-3 (]: SQL status: BEGIN in 0.041 seconds
[0m10:57:03.623889 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:57:03.624614 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m10:57:03.627669 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: BEGIN
[0m10:57:03.631222 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m10:57:03.637977 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: ROLLBACK
[0m10:57:03.641615 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."analytics"."stg_mediciones_valencia"
where id is null



  
  
      
    ) dbt_internal_test
[0m10:57:03.644630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:03.647275 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."analytics"."stg_mediciones_valencia"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m10:57:03.650729 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: Close
[0m10:57:03.658120 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:57:03.661837 [info ] [Thread-2 (]: 7 of 22 PASS not_null_stg_mediciones_valencia_fecha_carg ....................... [[32mPASS[0m in 0.27s]
[0m10:57:03.663412 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:57:03.667807 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: ROLLBACK
[0m10:57:03.671100 [debug] [Thread-2 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m10:57:03.676314 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: ROLLBACK
[0m10:57:03.679525 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: Close
[0m10:57:03.686076 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: Close
[0m10:57:03.687701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m10:57:03.689436 [info ] [Thread-4 (]: 8 of 22 PASS not_null_stg_mediciones_valencia_id ............................... [[32mPASS[0m in 0.27s]
[0m10:57:03.693577 [info ] [Thread-3 (]: 9 of 22 PASS not_null_stg_mediciones_valencia_nombre_estacion .................. [[32mPASS[0m in 0.27s]
[0m10:57:03.697718 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m10:57:03.701219 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m10:57:03.705325 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m10:57:03.708325 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."analytics"."stg_mediciones_valencia"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:57:03.727621 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.010 seconds
[0m10:57:03.735520 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: ROLLBACK
[0m10:57:03.742029 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: Close
[0m10:57:03.748915 [info ] [Thread-1 (]: 10 of 22 PASS unique_stg_mediciones_valencia_id ................................ [[32mPASS[0m in 0.30s]
[0m10:57:03.753992 [debug] [Thread-1 (]: Finished running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m10:57:03.761354 [debug] [Thread-2 (]: Began running node model.data_project_1.int_daily_avg
[0m10:57:03.763145 [debug] [Thread-4 (]: Began running node model.data_project_1.int_hourly_avg
[0m10:57:03.764469 [debug] [Thread-3 (]: Began running node model.data_project_1.int_monthly_avg
[0m10:57:03.765317 [debug] [Thread-1 (]: Began running node model.data_project_1.int_station_summary
[0m10:57:03.769663 [info ] [Thread-2 (]: 11 of 22 START sql view model analytics.int_daily_avg .......................... [RUN]
[0m10:57:03.777649 [info ] [Thread-4 (]: 12 of 22 START sql view model analytics.int_hourly_avg ......................... [RUN]
[0m10:57:03.788811 [info ] [Thread-3 (]: 13 of 22 START sql view model analytics.int_monthly_avg ........................ [RUN]
[0m10:57:03.794675 [info ] [Thread-1 (]: 14 of 22 START sql view model analytics.int_station_summary .................... [RUN]
[0m10:57:03.801941 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e, now model.data_project_1.int_daily_avg)
[0m10:57:03.808436 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e, now model.data_project_1.int_hourly_avg)
[0m10:57:03.813817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046, now model.data_project_1.int_monthly_avg)
[0m10:57:03.820435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170, now model.data_project_1.int_station_summary)
[0m10:57:03.824361 [debug] [Thread-2 (]: Began compiling node model.data_project_1.int_daily_avg
[0m10:57:03.828577 [debug] [Thread-4 (]: Began compiling node model.data_project_1.int_hourly_avg
[0m10:57:03.834196 [debug] [Thread-3 (]: Began compiling node model.data_project_1.int_monthly_avg
[0m10:57:03.838235 [debug] [Thread-1 (]: Began compiling node model.data_project_1.int_station_summary
[0m10:57:03.849777 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.int_daily_avg"
[0m10:57:03.859656 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.int_hourly_avg"
[0m10:57:03.866980 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.int_monthly_avg"
[0m10:57:03.874455 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.int_station_summary"
[0m10:57:03.895719 [debug] [Thread-4 (]: Began executing node model.data_project_1.int_hourly_avg
[0m10:57:03.899648 [debug] [Thread-2 (]: Began executing node model.data_project_1.int_daily_avg
[0m10:57:03.900857 [debug] [Thread-3 (]: Began executing node model.data_project_1.int_monthly_avg
[0m10:57:03.912549 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.int_hourly_avg"
[0m10:57:03.921010 [debug] [Thread-1 (]: Began executing node model.data_project_1.int_station_summary
[0m10:57:03.923844 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.int_daily_avg"
[0m10:57:03.930637 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.int_monthly_avg"
[0m10:57:03.941624 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.int_station_summary"
[0m10:57:03.959623 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:57:03.962231 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:57:03.964588 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: BEGIN
[0m10:57:03.965957 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:57:03.968159 [debug] [Thread-3 (]: On model.data_project_1.int_monthly_avg: BEGIN
[0m10:57:03.970300 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:57:03.970990 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:03.973737 [debug] [Thread-2 (]: On model.data_project_1.int_daily_avg: BEGIN
[0m10:57:03.976904 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:03.981269 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: BEGIN
[0m10:57:03.987287 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:03.992843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:04.003874 [debug] [Thread-4 (]: SQL status: BEGIN in 0.032 seconds
[0m10:57:04.007983 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:57:04.011886 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */

  create view "data_project_1"."analytics"."int_hourly_avg__dbt_tmp"
    
    
  as (
    with all_data as (
    select * from "data_project_1"."analytics"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."analytics"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    avg(no2) as no2_avg,
    avg(o3) as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by 1,2,3
order by fecha_hour, city, nombre_estacion
  );
[0m10:57:04.016476 [debug] [Thread-3 (]: SQL status: BEGIN in 0.039 seconds
[0m10:57:04.018373 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m10:57:04.021718 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:57:04.026101 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:57:04.029234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m10:57:04.034196 [debug] [Thread-3 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */

  create view "data_project_1"."analytics"."int_monthly_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."analytics"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."analytics"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_month,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_month
order by city, nombre_estacion, fecha_month
  );
[0m10:57:04.038034 [debug] [Thread-2 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */

  create view "data_project_1"."analytics"."int_daily_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."analytics"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."analytics"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m10:57:04.041502 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:57:04.051932 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */

  create view "data_project_1"."analytics"."int_station_summary__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."analytics"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."analytics"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m10:57:04.066466 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.048 seconds
[0m10:57:04.078473 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:57:04.082945 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
alter table "data_project_1"."analytics"."int_hourly_avg__dbt_tmp" rename to "int_hourly_avg"
[0m10:57:04.084600 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.039 seconds
[0m10:57:04.087909 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m10:57:04.089643 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m10:57:04.091193 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:57:04.100702 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:57:04.109686 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:57:04.117555 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:57:04.122597 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m10:57:04.125972 [debug] [Thread-3 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
alter table "data_project_1"."analytics"."int_monthly_avg__dbt_tmp" rename to "int_monthly_avg"
[0m10:57:04.129040 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
alter table "data_project_1"."analytics"."int_station_summary__dbt_tmp" rename to "int_station_summary"
[0m10:57:04.131885 [debug] [Thread-2 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
alter table "data_project_1"."analytics"."int_daily_avg__dbt_tmp" rename to "int_daily_avg"
[0m10:57:04.134818 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:57:04.141859 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:57:04.143968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:57:04.147556 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:57:04.149469 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m10:57:04.155952 [debug] [Thread-3 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m10:57:04.162145 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: COMMIT
[0m10:57:04.169062 [debug] [Thread-2 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m10:57:04.176009 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:57:04.178835 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m10:57:04.181621 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:57:04.185498 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:57:04.189895 [debug] [Thread-3 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m10:57:04.198658 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."analytics"."int_hourly_avg__dbt_backup"
[0m10:57:04.201645 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: COMMIT
[0m10:57:04.205931 [debug] [Thread-2 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m10:57:04.213391 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m10:57:04.214605 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m10:57:04.224233 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:57:04.225170 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
drop view if exists "data_project_1"."analytics"."int_hourly_avg__dbt_backup" cascade
[0m10:57:04.232738 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."analytics"."int_monthly_avg__dbt_backup"
[0m10:57:04.233857 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m10:57:04.246674 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."int_station_summary__dbt_backup"
[0m10:57:04.252724 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:57:04.256293 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m10:57:04.265255 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."int_daily_avg__dbt_backup"
[0m10:57:04.269995 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m10:57:04.278169 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: Close
[0m10:57:04.283810 [debug] [Thread-3 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
drop view if exists "data_project_1"."analytics"."int_monthly_avg__dbt_backup" cascade
[0m10:57:04.289681 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m10:57:04.295857 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
drop view if exists "data_project_1"."analytics"."int_station_summary__dbt_backup" cascade
[0m10:57:04.304015 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725aca5d4d50>]}
[0m10:57:04.311658 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:57:04.318600 [debug] [Thread-2 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
drop view if exists "data_project_1"."analytics"."int_daily_avg__dbt_backup" cascade
[0m10:57:04.327112 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:57:04.336988 [info ] [Thread-4 (]: 12 of 22 OK created sql view model analytics.int_hourly_avg .................... [[32mCREATE VIEW[0m in 0.50s]
[0m10:57:04.343163 [debug] [Thread-3 (]: On model.data_project_1.int_monthly_avg: Close
[0m10:57:04.350300 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:57:04.357644 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: Close
[0m10:57:04.362576 [debug] [Thread-4 (]: Finished running node model.data_project_1.int_hourly_avg
[0m10:57:04.369129 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ac844ca50>]}
[0m10:57:04.375842 [debug] [Thread-2 (]: On model.data_project_1.int_daily_avg: Close
[0m10:57:04.382368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725aca549b90>]}
[0m10:57:04.387446 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_station_summary
[0m10:57:04.393169 [info ] [Thread-3 (]: 13 of 22 OK created sql view model analytics.int_monthly_avg ................... [[32mCREATE VIEW[0m in 0.56s]
[0m10:57:04.407660 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725acb15ef90>]}
[0m10:57:04.418951 [info ] [Thread-1 (]: 14 of 22 OK created sql view model analytics.int_station_summary ............... [[32mCREATE VIEW[0m in 0.56s]
[0m10:57:04.431629 [info ] [Thread-4 (]: 15 of 22 START sql table model analytics.mart_station_summary .................. [RUN]
[0m10:57:04.438676 [debug] [Thread-3 (]: Finished running node model.data_project_1.int_monthly_avg
[0m10:57:04.446460 [info ] [Thread-2 (]: 11 of 22 OK created sql view model analytics.int_daily_avg ..................... [[32mCREATE VIEW[0m in 0.61s]
[0m10:57:04.452146 [debug] [Thread-1 (]: Finished running node model.data_project_1.int_station_summary
[0m10:57:04.460927 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_hourly_avg, now model.data_project_1.mart_station_summary)
[0m10:57:04.468194 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_alerts
[0m10:57:04.473613 [debug] [Thread-2 (]: Finished running node model.data_project_1.int_daily_avg
[0m10:57:04.477278 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_hourly
[0m10:57:04.483435 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_station_summary
[0m10:57:04.489992 [info ] [Thread-3 (]: 16 of 22 START sql table model analytics.mart_alerts ........................... [RUN]
[0m10:57:04.500268 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_monthly_promedio
[0m10:57:04.511336 [info ] [Thread-1 (]: 17 of 22 START sql table model analytics.mart_hourly ........................... [RUN]
[0m10:57:04.527874 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_station_summary"
[0m10:57:04.532850 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_monthly_avg, now model.data_project_1.mart_alerts)
[0m10:57:04.537012 [info ] [Thread-2 (]: 18 of 22 START sql table model analytics.mart_monthly_promedio ................. [RUN]
[0m10:57:04.541362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_station_summary, now model.data_project_1.mart_hourly)
[0m10:57:04.548585 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_alerts
[0m10:57:04.552553 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_daily_avg, now model.data_project_1.mart_monthly_promedio)
[0m10:57:04.556288 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_hourly
[0m10:57:04.566755 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_alerts"
[0m10:57:04.569542 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_monthly_promedio
[0m10:57:04.579948 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_hourly"
[0m10:57:04.585148 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_station_summary
[0m10:57:04.590888 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_monthly_promedio"
[0m10:57:04.595754 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_alerts
[0m10:57:04.629137 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_hourly
[0m10:57:04.648596 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_station_summary"
[0m10:57:04.655217 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_monthly_promedio
[0m10:57:04.656496 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_alerts"
[0m10:57:04.663040 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_hourly"
[0m10:57:04.681050 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_monthly_promedio"
[0m10:57:04.694784 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m10:57:04.698333 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:57:04.700366 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: BEGIN
[0m10:57:04.701508 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:57:04.703437 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: BEGIN
[0m10:57:04.704956 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:57:04.706436 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:04.708700 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: BEGIN
[0m10:57:04.711394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:04.714327 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: BEGIN
[0m10:57:04.719640 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:04.724786 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:04.736188 [debug] [Thread-4 (]: SQL status: BEGIN in 0.029 seconds
[0m10:57:04.738562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m10:57:04.741121 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m10:57:04.745346 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:57:04.749087 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */

  
    

  create  table "data_project_1"."analytics"."mart_station_summary__dbt_tmp"
  
  
    as
  
  (
    

with all_data as (
    select * from "data_project_1"."analytics"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."analytics"."stg_mediciones_valencia"
),

daily_avg as (
    select
        city,
        nombre_estacion,
        fecha_day,
        avg(no2)  as no2_avg,
        avg(o3)   as o3_avg,
        avg(pm10) as pm10_avg,
        avg(pm25) as pm25_avg
    from all_data
    group by city, nombre_estacion, fecha_day
),

station_summary as (
    select
        city,
        nombre_estacion,
        min(fecha_day) as first_measurement,
        max(fecha_day) as last_measurement,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg,
        case
            when avg(pm25_avg) > 50 then 'Alto'
            when avg(pm25_avg) > 25 then 'Moderado'
            else 'Bajo'
        end as nivel_pm25
    from daily_avg
    group by city, nombre_estacion
)

select *
from station_summary
order by city, nombre_estacion
  );
  
[0m10:57:04.750617 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m10:57:04.753324 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */

  
    

  create  table "data_project_1"."analytics"."mart_hourly__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select * 
    from "data_project_1"."analytics"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Ãndice de contaminaciÃ³n por hora
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n de NO2 por niveles
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por hora dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_hour order by pm25_avg desc) as ranking_pm25
from hourly_data
order by fecha_hour, city, nombre_estacion
  );
  
[0m10:57:04.754353 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m10:57:04.759832 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:57:04.769442 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:57:04.773729 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */

  
    

  create  table "data_project_1"."analytics"."mart_alerts__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select *
    from "data_project_1"."analytics"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    case 
        when no2_avg > 200 then 'Alerta NO2'
        when o3_avg > 180 then 'Alerta O3'
        when pm10_avg > 150 then 'Alerta PM10'
        when pm25_avg > 75 then 'Alerta PM2.5'
        else null
    end as alerta
from hourly_data
where no2_avg > 200
   or o3_avg > 180
   or pm10_avg > 150
   or pm25_avg > 75
order by fecha_hour, city, nombre_estacion
  );
  
[0m10:57:04.777661 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */

  
    

  create  table "data_project_1"."analytics"."mart_monthly_promedio__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    nombre_estacion,
    fecha_month,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as contaminacion_promedio
from "data_project_1"."analytics"."int_monthly_avg"
  );
  
[0m10:57:04.834912 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.052 seconds
[0m10:57:04.839594 [debug] [Thread-4 (]: SQL status: SELECT 34 in 0.082 seconds
[0m10:57:04.841015 [debug] [Thread-2 (]: SQL status: SELECT 34 in 0.055 seconds
[0m10:57:04.867269 [debug] [Thread-1 (]: SQL status: SELECT 136 in 0.103 seconds
[0m10:57:04.889234 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:57:04.901435 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m10:57:04.912004 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:57:04.922644 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:57:04.929342 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."analytics"."mart_alerts" rename to "mart_alerts__dbt_backup"
[0m10:57:04.933672 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
alter table "data_project_1"."analytics"."mart_station_summary__dbt_tmp" rename to "mart_station_summary"
[0m10:57:04.938024 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."analytics"."mart_monthly_promedio" rename to "mart_monthly_promedio__dbt_backup"
[0m10:57:04.942132 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."analytics"."mart_hourly" rename to "mart_hourly__dbt_backup"
[0m10:57:04.949037 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:57:04.952998 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:57:04.955939 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:57:04.961578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:57:04.972371 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:57:05.021252 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."analytics"."mart_alerts__dbt_tmp" rename to "mart_alerts"
[0m10:57:04.997887 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:57:05.013101 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:57:04.978571 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: COMMIT
[0m10:57:05.032355 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:57:05.037466 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."analytics"."mart_monthly_promedio__dbt_tmp" rename to "mart_monthly_promedio"
[0m10:57:05.042448 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."analytics"."mart_hourly__dbt_tmp" rename to "mart_hourly"
[0m10:57:05.052779 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m10:57:05.066666 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: COMMIT
[0m10:57:05.093303 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:57:05.082110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:57:05.087603 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: COMMIT
[0m10:57:05.076221 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:57:05.100505 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: COMMIT
[0m10:57:05.106529 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: COMMIT
[0m10:57:05.118465 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m10:57:05.139717 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m10:57:05.159209 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:57:05.162946 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m10:57:05.188664 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."analytics"."mart_station_summary__dbt_backup"
[0m10:57:05.193601 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:57:05.199806 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: COMMIT
[0m10:57:05.223903 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."analytics"."mart_alerts__dbt_backup"
[0m10:57:05.255800 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m10:57:05.345921 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m10:57:05.478755 [debug] [Thread-1 (]: SQL status: COMMIT in 0.056 seconds
[0m10:57:05.507505 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m10:57:05.565080 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
drop table if exists "data_project_1"."analytics"."mart_station_summary__dbt_backup" cascade
[0m10:57:05.638530 [debug] [Thread-2 (]: SQL status: COMMIT in 0.017 seconds
[0m10:57:05.744214 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."mart_hourly__dbt_backup"
[0m10:57:05.802677 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
drop table if exists "data_project_1"."analytics"."mart_alerts__dbt_backup" cascade
[0m10:57:05.849688 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:57:06.008812 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: Close
[0m10:57:05.932543 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m10:57:05.894533 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."mart_monthly_promedio__dbt_backup"
[0m10:57:06.068914 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ac8313710>]}
[0m10:57:06.138638 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
drop table if exists "data_project_1"."analytics"."mart_hourly__dbt_backup" cascade
[0m10:57:06.184476 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m10:57:06.206650 [info ] [Thread-4 (]: 15 of 22 OK created sql table model analytics.mart_station_summary ............. [[32mSELECT 34[0m in 1.61s]
[0m10:57:06.294910 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.323 seconds
[0m10:57:06.430674 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.102 seconds
[0m10:57:06.463256 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
drop table if exists "data_project_1"."analytics"."mart_monthly_promedio__dbt_backup" cascade
[0m10:57:06.635771 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_station_summary
[0m10:57:06.759506 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: Close
[0m10:57:06.961862 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: Close
[0m10:57:07.109801 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_daily_promedio
[0m10:57:07.111750 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.051 seconds
[0m10:57:07.221261 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ac8306350>]}
[0m10:57:07.298017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ac8305a50>]}
[0m10:57:07.440620 [info ] [Thread-4 (]: 19 of 22 START sql table model analytics.mart_daily_promedio ................... [RUN]
[0m10:57:07.540153 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: Close
[0m10:57:07.597909 [info ] [Thread-3 (]: 16 of 22 OK created sql table model analytics.mart_alerts ...................... [[32mSELECT 0[0m in 2.69s]
[0m10:57:07.660731 [info ] [Thread-1 (]: 17 of 22 OK created sql table model analytics.mart_hourly ...................... [[32mSELECT 136[0m in 2.76s]
[0m10:57:07.684897 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_station_summary, now model.data_project_1.mart_daily_promedio)
[0m10:57:07.780688 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ac832ad50>]}
[0m10:57:07.924826 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_alerts
[0m10:57:08.038292 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_hourly
[0m10:57:08.227290 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_daily_promedio
[0m10:57:08.280397 [info ] [Thread-2 (]: 18 of 22 OK created sql table model analytics.mart_monthly_promedio ............ [[32mSELECT 34[0m in 3.23s]
[0m10:57:08.384432 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_top_polluted_stations
[0m10:57:08.471402 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_weekly_extended
[0m10:57:08.580346 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_daily_promedio"
[0m10:57:08.674580 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_monthly_promedio
[0m10:57:08.746348 [info ] [Thread-3 (]: 20 of 22 START sql table model analytics.mart_top_polluted_stations ............ [RUN]
[0m10:57:08.778768 [info ] [Thread-1 (]: 21 of 22 START sql table model analytics.mart_weekly_extended .................. [RUN]
[0m10:57:08.934812 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_alerts, now model.data_project_1.mart_top_polluted_stations)
[0m10:57:08.994225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_hourly, now model.data_project_1.mart_weekly_extended)
[0m10:57:09.040274 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_top_polluted_stations
[0m10:57:09.123084 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_weekly_extended
[0m10:57:09.176744 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_top_polluted_stations"
[0m10:57:09.330506 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_weekly_extended"
[0m10:57:09.399780 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_daily_promedio
[0m10:57:09.499190 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_daily_promedio"
[0m10:57:09.693884 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_top_polluted_stations
[0m10:57:09.810293 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_top_polluted_stations"
[0m10:57:09.858915 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_weekly_extended
[0m10:57:09.985790 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_weekly_extended"
[0m10:57:10.153247 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:57:10.175050 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: BEGIN
[0m10:57:10.182910 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:57:10.186995 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:57:10.192426 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:57:10.193908 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: BEGIN
[0m10:57:10.213845 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: BEGIN
[0m10:57:10.222243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:10.229930 [debug] [Thread-4 (]: SQL status: BEGIN in 0.043 seconds
[0m10:57:10.233306 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:57:10.257553 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:57:10.262066 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m10:57:10.278934 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */

  
    

  create  table "data_project_1"."analytics"."mart_daily_promedio__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * 
    from "data_project_1"."analytics"."int_daily_avg"
)

select
    city,
    nombre_estacion,
    fecha_day,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Calculamos un Ã­ndice de contaminaciÃ³n promedio
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n del nivel de NO2
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por dÃ­a dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_day order by pm25_avg desc) as ranking_pm25
from daily_data
order by fecha_day, city, nombre_estacion
  );
  
[0m10:57:10.285867 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:57:10.299073 [debug] [Thread-3 (]: SQL status: BEGIN in 0.066 seconds
[0m10:57:10.318743 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */

  
    

  create  table "data_project_1"."analytics"."mart_weekly_extended__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."analytics"."int_daily_avg"
),

weekly_data as (
    select
        city,
        nombre_estacion,
        date_trunc('week', fecha_day) as fecha_week,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg
    from daily_data
    group by city, nombre_estacion, date_trunc('week', fecha_day)
)

select
    *,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2
from weekly_data
order by fecha_week, city, nombre_estacion
  );
  
[0m10:57:10.325018 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:57:10.359169 [debug] [Thread-4 (]: SQL status: SELECT 68 in 0.049 seconds
[0m10:57:10.366693 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */

  
    

  create  table "data_project_1"."analytics"."mart_top_polluted_stations__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."analytics"."int_daily_avg"
),

ranked as (
    select
        city,
        nombre_estacion,
        fecha_day,
        no2_avg,
        o3_avg,
        pm10_avg,
        pm25_avg,
        rank() over (partition by city, fecha_day order by pm25_avg desc) as rank_pm25,
        rank() over (partition by city, fecha_day order by pm10_avg desc) as rank_pm10
    from daily_data
)

select *
from ranked
where rank_pm25 <= 5 or rank_pm10 <= 5
order by fecha_day, city, rank_pm25, rank_pm10
  );
  
[0m10:57:10.382741 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:57:10.386967 [debug] [Thread-1 (]: SQL status: SELECT 34 in 0.053 seconds
[0m10:57:10.408352 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."analytics"."mart_daily_promedio" rename to "mart_daily_promedio__dbt_backup"
[0m10:57:10.448843 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:57:10.467263 [debug] [Thread-3 (]: SQL status: SELECT 36 in 0.077 seconds
[0m10:57:10.511599 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:57:10.559844 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."analytics"."mart_weekly_extended" rename to "mart_weekly_extended__dbt_backup"
[0m10:57:10.632605 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:57:10.766061 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."analytics"."mart_top_polluted_stations" rename to "mart_top_polluted_stations__dbt_backup"
[0m10:57:10.728098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:57:10.681447 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:57:10.790570 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:57:10.791484 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m10:57:10.797125 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."analytics"."mart_daily_promedio__dbt_tmp" rename to "mart_daily_promedio"
[0m10:57:10.803027 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."analytics"."mart_weekly_extended__dbt_tmp" rename to "mart_weekly_extended"
[0m10:57:10.814885 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:57:10.925176 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:57:11.005341 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:57:11.075578 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."analytics"."mart_top_polluted_stations__dbt_tmp" rename to "mart_top_polluted_stations"
[0m10:57:11.174270 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m10:57:11.226961 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m10:57:11.250116 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:57:11.264403 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:57:11.274195 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:57:11.336297 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m10:57:11.415435 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m10:57:11.451312 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m10:57:11.484823 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:57:11.520474 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m10:57:11.537545 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:57:11.549744 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m10:57:11.576710 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."analytics"."mart_daily_promedio__dbt_backup"
[0m10:57:11.593252 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."analytics"."mart_weekly_extended__dbt_backup"
[0m10:57:11.627569 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m10:57:11.644579 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m10:57:11.667942 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m10:57:11.694341 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."analytics"."mart_top_polluted_stations__dbt_backup"
[0m10:57:11.721174 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
drop table if exists "data_project_1"."analytics"."mart_daily_promedio__dbt_backup" cascade
[0m10:57:11.730875 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
drop table if exists "data_project_1"."analytics"."mart_weekly_extended__dbt_backup" cascade
[0m10:57:11.737836 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m10:57:11.765760 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.020 seconds
[0m10:57:11.767405 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
drop table if exists "data_project_1"."analytics"."mart_top_polluted_stations__dbt_backup" cascade
[0m10:57:11.770090 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m10:57:11.776185 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: Close
[0m10:57:11.813611 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: Close
[0m10:57:11.815199 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.023 seconds
[0m10:57:11.826841 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ac831c410>]}
[0m10:57:11.840412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ac84d4fd0>]}
[0m10:57:11.859925 [debug] [Thread-3 (]: On model.data_project_1.mart_top_polluted_stations: Close
[0m10:57:11.871728 [info ] [Thread-4 (]: 19 of 22 OK created sql table model analytics.mart_daily_promedio .............. [[32mSELECT 68[0m in 4.14s]
[0m10:57:11.875862 [info ] [Thread-1 (]: 21 of 22 OK created sql table model analytics.mart_weekly_extended ............. [[32mSELECT 34[0m in 2.85s]
[0m10:57:11.886078 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ac8313a90>]}
[0m10:57:11.890435 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_daily_promedio
[0m10:57:11.937441 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_weekly_extended
[0m10:57:11.975830 [info ] [Thread-3 (]: 20 of 22 OK created sql table model analytics.mart_top_polluted_stations ....... [[32mSELECT 36[0m in 2.95s]
[0m10:57:12.006563 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_fact_air_quality
[0m10:57:12.106868 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_top_polluted_stations
[0m10:57:12.147957 [info ] [Thread-2 (]: 22 of 22 START sql table model analytics.mart_fact_air_quality ................. [RUN]
[0m10:57:12.174414 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_monthly_promedio, now model.data_project_1.mart_fact_air_quality)
[0m10:57:12.190483 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_fact_air_quality
[0m10:57:12.222765 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_fact_air_quality"
[0m10:57:12.289839 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_fact_air_quality
[0m10:57:12.303464 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_fact_air_quality"
[0m10:57:12.370841 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:57:12.374769 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: BEGIN
[0m10:57:12.378471 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:57:12.399992 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m10:57:12.404744 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:57:12.408272 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */

  
    

  create  table "data_project_1"."analytics"."mart_fact_air_quality__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * from "data_project_1"."analytics"."int_daily_avg"
),
weekly_data as (
    select * from "data_project_1"."analytics"."mart_weekly_extended"
),
monthly_data as (
    select * from "data_project_1"."analytics"."int_monthly_avg"
)

select
    coalesce(d.city, w.city, m.city) as city,
    coalesce(d.nombre_estacion, w.nombre_estacion, m.nombre_estacion) as nombre_estacion,
    d.fecha_day,
    w.fecha_week,
    m.fecha_month,
    d.no2_avg as daily_no2,
    d.o3_avg as daily_o3,
    d.pm10_avg as daily_pm10,
    d.pm25_avg as daily_pm25,
    w.no2_avg as weekly_no2,
    w.o3_avg as weekly_o3,
    w.pm10_avg as weekly_pm10,
    w.pm25_avg as weekly_pm25,
    m.no2_avg as monthly_no2,
    m.o3_avg as monthly_o3,
    m.pm10_avg as monthly_pm10,
    m.pm25_avg as monthly_pm25
from daily_data d
full outer join weekly_data w
    on d.city = w.city
    and d.nombre_estacion = w.nombre_estacion
    and date_trunc('week', d.fecha_day) = w.fecha_week
full outer join monthly_data m
    on coalesce(d.city, w.city) = m.city
    and coalesce(d.nombre_estacion, w.nombre_estacion) = m.nombre_estacion
    and date_trunc('month', d.fecha_day) = m.fecha_month
order by city, nombre_estacion, d.fecha_day
  );
  
[0m10:57:12.446903 [debug] [Thread-2 (]: SQL status: SELECT 68 in 0.035 seconds
[0m10:57:12.457205 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:57:12.465817 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."analytics"."mart_fact_air_quality" rename to "mart_fact_air_quality__dbt_backup"
[0m10:57:12.476988 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:57:12.491696 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:57:12.497937 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."analytics"."mart_fact_air_quality__dbt_tmp" rename to "mart_fact_air_quality"
[0m10:57:12.512003 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:57:12.518636 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m10:57:12.522429 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:57:12.526489 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m10:57:12.543358 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m10:57:12.556185 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."analytics"."mart_fact_air_quality__dbt_backup"
[0m10:57:12.563246 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m10:57:12.573337 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
drop table if exists "data_project_1"."analytics"."mart_fact_air_quality__dbt_backup" cascade
[0m10:57:12.602344 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.026 seconds
[0m10:57:12.611037 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: Close
[0m10:57:12.623920 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c902803a-c3e4-45d2-b674-1990f4e49575', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ac83e2ed0>]}
[0m10:57:12.631998 [info ] [Thread-2 (]: 22 of 22 OK created sql table model analytics.mart_fact_air_quality ............ [[32mSELECT 68[0m in 0.45s]
[0m10:57:12.653275 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_fact_air_quality
[0m10:57:12.666630 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:12.692466 [debug] [MainThread]: On master: BEGIN
[0m10:57:12.713919 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:12.778313 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m10:57:12.804812 [debug] [MainThread]: On master: COMMIT
[0m10:57:12.826985 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:12.834829 [debug] [MainThread]: On master: COMMIT
[0m10:57:12.840375 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:57:12.846163 [debug] [MainThread]: On master: Close
[0m10:57:12.852407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:12.857313 [debug] [MainThread]: Connection 'model.data_project_1.mart_weekly_extended' was properly closed.
[0m10:57:12.862725 [debug] [MainThread]: Connection 'model.data_project_1.mart_fact_air_quality' was properly closed.
[0m10:57:12.867515 [debug] [MainThread]: Connection 'model.data_project_1.mart_daily_promedio' was properly closed.
[0m10:57:12.875647 [debug] [MainThread]: Connection 'model.data_project_1.mart_top_polluted_stations' was properly closed.
[0m10:57:12.881900 [info ] [MainThread]: 
[0m10:57:12.886587 [info ] [MainThread]: Finished running 8 table models, 8 data tests, 6 view models in 0 hours 0 minutes and 11.56 seconds (11.56s).
[0m10:57:12.918996 [debug] [MainThread]: Command end result
[0m10:57:14.265929 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m10:57:14.541925 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m10:57:14.632554 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m10:57:14.638901 [info ] [MainThread]: 
[0m10:57:14.650696 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:14.657401 [info ] [MainThread]: 
[0m10:57:14.682629 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=22
[0m10:57:14.694472 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 16.921453, "process_in_blocks": "4904", "process_kernel_time": 1.522226, "process_mem_max_rss": "135936", "process_out_blocks": "0", "process_user_time": 9.470245}
[0m10:57:14.770194 [debug] [MainThread]: Command `dbt build` succeeded at 10:57:14.769146 after 17.00 seconds
[0m10:57:14.804660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ad8ed3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ad8f83950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725ad551e850>]}
[0m10:57:14.814314 [debug] [MainThread]: Flushing usage events
[0m10:57:15.651664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:18:50.412850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2b627e1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2b627e22d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2b627e3990>]}


============================== 09:18:50.429840 | 8376708c-9992-4620-bb0b-57d6887dd039 ==============================
[0m09:18:50.429840 [info ] [MainThread]: Running with dbt=1.10.15
[0m09:18:50.431542 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'introspect': 'True', 'profiles_dir': '/usr/app/dbt', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'empty': 'None', 'invocation_command': 'dbt deps', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'no_print': 'None', 'version_check': 'True', 'indirect_selection': 'eager'}
[0m09:18:50.597917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8376708c-9992-4620-bb0b-57d6887dd039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2b626d8950>]}
[0m09:18:50.615049 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:18:50.632737 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:18:50.638973 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35318568, "process_in_blocks": "4760", "process_kernel_time": 0.719166, "process_mem_max_rss": "105632", "process_out_blocks": "0", "process_user_time": 2.295643}
[0m09:18:50.640513 [debug] [MainThread]: Command `dbt deps` succeeded at 09:18:50.640333 after 0.36 seconds
[0m09:18:50.641747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2b62829810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2b62834750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2b670f6e10>]}
[0m09:18:50.642975 [debug] [MainThread]: Flushing usage events
[0m09:18:51.173073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:18:53.731571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740104d4fc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7401020702d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7401022db9d0>]}


============================== 09:18:53.745220 | c802f7e0-a201-46a0-b768-8431de965c84 ==============================
[0m09:18:53.745220 [info ] [MainThread]: Running with dbt=1.10.15
[0m09:18:53.747806 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'partial_parse': 'True', 'version_check': 'True', 'fail_fast': 'False', 'write_json': 'True', 'invocation_command': 'dbt build --target dev', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_path': '/usr/app/dbt/logs', 'printer_width': '80', 'use_colors': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'no_print': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/app/dbt', 'empty': 'False', 'introspect': 'True'}
[0m09:18:53.987115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7401011c9b50>]}
[0m09:18:54.081110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740104d74dd0>]}
[0m09:18:54.084480 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:18:54.197225 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m09:18:54.339640 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:18:54.343158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740103177890>]}
[0m09:18:56.265804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400fcd50f10>]}
[0m09:18:56.386678 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m09:18:56.398171 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m09:18:56.542013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400fcd115d0>]}
[0m09:18:56.544285 [info ] [MainThread]: Found 14 models, 8 data tests, 1 source, 459 macros
[0m09:18:56.549897 [info ] [MainThread]: 
[0m09:18:56.551760 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:18:56.554087 [info ] [MainThread]: 
[0m09:18:56.556762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:18:56.563734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1'
[0m09:18:56.615182 [debug] [ThreadPool]: Using postgres connection "list_data_project_1"
[0m09:18:56.617771 [debug] [ThreadPool]: On list_data_project_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1"} */

    select distinct nspname from pg_namespace
  
[0m09:18:56.619872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:56.653772 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.034 seconds
[0m09:18:56.658111 [debug] [ThreadPool]: On list_data_project_1: Close
[0m09:18:56.663653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_project_1, now list_data_project_1_public)
[0m09:18:56.671944 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_public"
[0m09:18:56.674301 [debug] [ThreadPool]: On list_data_project_1_public: BEGIN
[0m09:18:56.676278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:18:56.692400 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m09:18:56.694728 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_public"
[0m09:18:56.697006 [debug] [ThreadPool]: On list_data_project_1_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1_public"} */
select
      'data_project_1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'data_project_1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'data_project_1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:18:56.737390 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.038 seconds
[0m09:18:56.742971 [debug] [ThreadPool]: On list_data_project_1_public: ROLLBACK
[0m09:18:56.746601 [debug] [ThreadPool]: On list_data_project_1_public: Close
[0m09:18:56.757989 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:56.761068 [debug] [MainThread]: On master: BEGIN
[0m09:18:56.763670 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:18:56.781744 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m09:18:56.784105 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:56.786248 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m09:18:56.816317 [debug] [MainThread]: SQL status: SELECT 11 in 0.028 seconds
[0m09:18:56.821178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400fcd375d0>]}
[0m09:18:56.823950 [debug] [MainThread]: On master: ROLLBACK
[0m09:18:56.826733 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:56.828844 [debug] [MainThread]: On master: BEGIN
[0m09:18:56.832229 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:18:56.834874 [debug] [MainThread]: On master: COMMIT
[0m09:18:56.837861 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:56.840661 [debug] [MainThread]: On master: COMMIT
[0m09:18:56.843471 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:18:56.845934 [debug] [MainThread]: On master: Close
[0m09:18:56.861377 [debug] [Thread-1 (]: Began running node model.data_project_1.stg_mediciones_madrid
[0m09:18:56.862182 [debug] [Thread-2 (]: Began running node model.data_project_1.stg_mediciones_valencia
[0m09:18:56.864638 [info ] [Thread-1 (]: 1 of 22 START sql view model public.stg_mediciones_madrid ...................... [RUN]
[0m09:18:56.867621 [info ] [Thread-2 (]: 2 of 22 START sql view model public.stg_mediciones_valencia .................... [RUN]
[0m09:18:56.870431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_project_1_public, now model.data_project_1.stg_mediciones_madrid)
[0m09:18:56.873792 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.data_project_1.stg_mediciones_valencia'
[0m09:18:56.876535 [debug] [Thread-1 (]: Began compiling node model.data_project_1.stg_mediciones_madrid
[0m09:18:56.879090 [debug] [Thread-2 (]: Began compiling node model.data_project_1.stg_mediciones_valencia
[0m09:18:56.889168 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_madrid"
[0m09:18:56.894312 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_valencia"
[0m09:18:56.913511 [debug] [Thread-1 (]: Began executing node model.data_project_1.stg_mediciones_madrid
[0m09:18:56.915513 [debug] [Thread-2 (]: Began executing node model.data_project_1.stg_mediciones_valencia
[0m09:18:56.972751 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_madrid"
[0m09:18:56.975689 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_valencia"
[0m09:18:56.990738 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m09:18:56.991998 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m09:18:56.993081 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: BEGIN
[0m09:18:56.994831 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: BEGIN
[0m09:18:56.996850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:56.998680 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:18:57.013737 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m09:18:57.016109 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m09:18:57.017775 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m09:18:57.019159 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */

  create view "data_project_1"."public"."stg_mediciones_valencia__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'valencia' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='valencia'
  );
[0m09:18:57.020964 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m09:18:57.025179 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */

  create view "data_project_1"."public"."stg_mediciones_madrid__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'madrid' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='madrid'
  );
[0m09:18:57.043898 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m09:18:57.044598 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m09:18:57.053317 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m09:18:57.057278 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m09:18:57.058860 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."public"."stg_mediciones_madrid__dbt_tmp" rename to "stg_mediciones_madrid"
[0m09:18:57.060542 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."public"."stg_mediciones_valencia__dbt_tmp" rename to "stg_mediciones_valencia"
[0m09:18:57.065268 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:18:57.065753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:18:57.085328 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m09:18:57.086971 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m09:18:57.089446 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m09:18:57.091595 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m09:18:57.093377 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m09:18:57.095211 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m09:18:57.101883 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m09:18:57.110748 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."stg_mediciones_valencia__dbt_backup"
[0m09:18:57.111237 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m09:18:57.120154 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m09:18:57.125660 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."stg_mediciones_madrid__dbt_backup"
[0m09:18:57.127451 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
drop view if exists "data_project_1"."public"."stg_mediciones_valencia__dbt_backup" cascade
[0m09:18:57.129463 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m09:18:57.132688 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
drop view if exists "data_project_1"."public"."stg_mediciones_madrid__dbt_backup" cascade
[0m09:18:57.136995 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:18:57.137517 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m09:18:57.141653 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: Close
[0m09:18:57.144519 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: Close
[0m09:18:57.148314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400cfd4a590>]}
[0m09:18:57.149836 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400cfd2bed0>]}
[0m09:18:57.154080 [info ] [Thread-1 (]: 1 of 22 OK created sql view model public.stg_mediciones_madrid ................. [[32mCREATE VIEW[0m in 0.28s]
[0m09:18:57.156617 [info ] [Thread-2 (]: 2 of 22 OK created sql view model public.stg_mediciones_valencia ............... [[32mCREATE VIEW[0m in 0.28s]
[0m09:18:57.158517 [debug] [Thread-1 (]: Finished running node model.data_project_1.stg_mediciones_madrid
[0m09:18:57.160320 [debug] [Thread-2 (]: Finished running node model.data_project_1.stg_mediciones_valencia
[0m09:18:57.163081 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m09:18:57.163630 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m09:18:57.164030 [debug] [Thread-1 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m09:18:57.165273 [debug] [Thread-2 (]: Began running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m09:18:57.166928 [info ] [Thread-4 (]: 3 of 22 START test not_null_stg_mediciones_madrid_fecha_carg ................... [RUN]
[0m09:18:57.168529 [info ] [Thread-3 (]: 4 of 22 START test not_null_stg_mediciones_madrid_id ........................... [RUN]
[0m09:18:57.170139 [info ] [Thread-1 (]: 5 of 22 START test not_null_stg_mediciones_madrid_nombre_estacion .............. [RUN]
[0m09:18:57.171644 [info ] [Thread-2 (]: 6 of 22 START test unique_stg_mediciones_madrid_id ............................. [RUN]
[0m09:18:57.173880 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf'
[0m09:18:57.175553 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515'
[0m09:18:57.177372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_madrid, now test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2)
[0m09:18:57.179015 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_valencia, now test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c)
[0m09:18:57.180498 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m09:18:57.182008 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m09:18:57.183457 [debug] [Thread-1 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m09:18:57.185274 [debug] [Thread-2 (]: Began compiling node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m09:18:57.210714 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m09:18:57.216605 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m09:18:57.225071 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m09:18:57.233720 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m09:18:57.259590 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m09:18:57.260207 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m09:18:57.273726 [debug] [Thread-2 (]: Began executing node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m09:18:57.292844 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m09:18:57.300212 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m09:18:57.300961 [debug] [Thread-1 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m09:18:57.305743 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m09:18:57.314277 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m09:18:57.323480 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m09:18:57.325697 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: BEGIN
[0m09:18:57.326712 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m09:18:57.327336 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m09:18:57.328318 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:18:57.329707 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: BEGIN
[0m09:18:57.330419 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m09:18:57.331250 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: BEGIN
[0m09:18:57.333564 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:18:57.335392 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: BEGIN
[0m09:18:57.336771 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:18:57.340857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:57.342577 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m09:18:57.346576 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m09:18:57.348997 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m09:18:57.349535 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."public"."stg_mediciones_madrid"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m09:18:57.351403 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m09:18:57.353276 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m09:18:57.354889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m09:18:57.355357 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."public"."stg_mediciones_madrid"
where id is null



  
  
      
    ) dbt_internal_test
[0m09:18:57.357923 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m09:18:57.358417 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m09:18:57.359660 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m09:18:57.363383 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."public"."stg_mediciones_madrid"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:18:57.363852 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m09:18:57.368958 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: ROLLBACK
[0m09:18:57.370497 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."public"."stg_mediciones_madrid"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m09:18:57.375242 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: ROLLBACK
[0m09:18:57.376393 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m09:18:57.377810 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: Close
[0m09:18:57.381010 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: Close
[0m09:18:57.382108 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:18:57.383715 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: ROLLBACK
[0m09:18:57.385709 [info ] [Thread-4 (]: 3 of 22 PASS not_null_stg_mediciones_madrid_fecha_carg ......................... [[32mPASS[0m in 0.21s]
[0m09:18:57.387189 [info ] [Thread-3 (]: 4 of 22 PASS not_null_stg_mediciones_madrid_id ................................. [[32mPASS[0m in 0.21s]
[0m09:18:57.391745 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: ROLLBACK
[0m09:18:57.394261 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: Close
[0m09:18:57.395747 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m09:18:57.398355 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m09:18:57.400878 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: Close
[0m09:18:57.402718 [info ] [Thread-2 (]: 6 of 22 PASS unique_stg_mediciones_madrid_id ................................... [[32mPASS[0m in 0.22s]
[0m09:18:57.404123 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m09:18:57.406024 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m09:18:57.408671 [info ] [Thread-1 (]: 5 of 22 PASS not_null_stg_mediciones_madrid_nombre_estacion .................... [[32mPASS[0m in 0.23s]
[0m09:18:57.410386 [debug] [Thread-2 (]: Finished running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m09:18:57.412220 [info ] [Thread-4 (]: 7 of 22 START test not_null_stg_mediciones_valencia_fecha_carg ................. [RUN]
[0m09:18:57.413780 [info ] [Thread-3 (]: 8 of 22 START test not_null_stg_mediciones_valencia_id ......................... [RUN]
[0m09:18:57.415591 [debug] [Thread-1 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m09:18:57.416993 [debug] [Thread-2 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m09:18:57.418760 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf, now test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e)
[0m09:18:57.420846 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515, now test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e)
[0m09:18:57.422448 [debug] [Thread-1 (]: Began running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m09:18:57.424567 [info ] [Thread-2 (]: 9 of 22 START test not_null_stg_mediciones_valencia_nombre_estacion ............ [RUN]
[0m09:18:57.426574 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m09:18:57.428315 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m09:18:57.430098 [info ] [Thread-1 (]: 10 of 22 START test unique_stg_mediciones_valencia_id .......................... [RUN]
[0m09:18:57.431724 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c, now test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046)
[0m09:18:57.440158 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m09:18:57.445028 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m09:18:57.447063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2, now test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170)
[0m09:18:57.448820 [debug] [Thread-2 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m09:18:57.452847 [debug] [Thread-1 (]: Began compiling node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m09:18:57.458659 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m09:18:57.463938 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m09:18:57.467416 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m09:18:57.468296 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m09:18:57.472590 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m09:18:57.475271 [debug] [Thread-2 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m09:18:57.477817 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m09:18:57.478265 [debug] [Thread-1 (]: Began executing node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m09:18:57.482793 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m09:18:57.488016 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m09:18:57.494879 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m09:18:57.496667 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m09:18:57.497206 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: BEGIN
[0m09:18:57.497818 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m09:18:57.498975 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: BEGIN
[0m09:18:57.500032 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m09:18:57.500405 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:18:57.501533 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: BEGIN
[0m09:18:57.502700 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:18:57.503969 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: BEGIN
[0m09:18:57.507146 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:18:57.510506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:57.515671 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m09:18:57.517191 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m09:18:57.517624 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m09:18:57.518981 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m09:18:57.520105 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."public"."stg_mediciones_valencia"
where id is null



  
  
      
    ) dbt_internal_test
[0m09:18:57.522291 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."public"."stg_mediciones_valencia"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m09:18:57.526590 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m09:18:57.530448 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: ROLLBACK
[0m09:18:57.531003 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m09:18:57.532070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m09:18:57.532759 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: Close
[0m09:18:57.533186 [debug] [Thread-2 (]: SQL status: BEGIN in 0.026 seconds
[0m09:18:57.535108 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: ROLLBACK
[0m09:18:57.536588 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m09:18:57.538359 [info ] [Thread-3 (]: 8 of 22 PASS not_null_stg_mediciones_valencia_id ............................... [[32mPASS[0m in 0.12s]
[0m09:18:57.540672 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m09:18:57.542610 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: Close
[0m09:18:57.543663 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."public"."stg_mediciones_valencia"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m09:18:57.545447 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m09:18:57.546730 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."public"."stg_mediciones_valencia"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m09:18:57.548237 [info ] [Thread-4 (]: 7 of 22 PASS not_null_stg_mediciones_valencia_fecha_carg ....................... [[32mPASS[0m in 0.13s]
[0m09:18:57.552953 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m09:18:57.553890 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m09:18:57.557218 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: ROLLBACK
[0m09:18:57.557781 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m09:18:57.560753 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: Close
[0m09:18:57.563238 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: ROLLBACK
[0m09:18:57.564831 [info ] [Thread-1 (]: 10 of 22 PASS unique_stg_mediciones_valencia_id ................................ [[32mPASS[0m in 0.12s]
[0m09:18:57.566206 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: Close
[0m09:18:57.567815 [debug] [Thread-1 (]: Finished running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m09:18:57.569456 [info ] [Thread-2 (]: 9 of 22 PASS not_null_stg_mediciones_valencia_nombre_estacion .................. [[32mPASS[0m in 0.14s]
[0m09:18:57.573090 [debug] [Thread-2 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m09:18:57.575721 [debug] [Thread-3 (]: Began running node model.data_project_1.int_daily_avg
[0m09:18:57.576165 [debug] [Thread-4 (]: Began running node model.data_project_1.int_hourly_avg
[0m09:18:57.576551 [debug] [Thread-1 (]: Began running node model.data_project_1.int_monthly_avg
[0m09:18:57.576994 [debug] [Thread-2 (]: Began running node model.data_project_1.int_station_summary
[0m09:18:57.578184 [info ] [Thread-3 (]: 11 of 22 START sql view model public.int_daily_avg ............................. [RUN]
[0m09:18:57.579823 [info ] [Thread-4 (]: 12 of 22 START sql view model public.int_hourly_avg ............................ [RUN]
[0m09:18:57.582145 [info ] [Thread-1 (]: 13 of 22 START sql view model public.int_monthly_avg ........................... [RUN]
[0m09:18:57.584097 [info ] [Thread-2 (]: 14 of 22 START sql view model public.int_station_summary ....................... [RUN]
[0m09:18:57.586379 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e, now model.data_project_1.int_daily_avg)
[0m09:18:57.588532 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e, now model.data_project_1.int_hourly_avg)
[0m09:18:57.590512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170, now model.data_project_1.int_monthly_avg)
[0m09:18:57.592297 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046, now model.data_project_1.int_station_summary)
[0m09:18:57.594123 [debug] [Thread-3 (]: Began compiling node model.data_project_1.int_daily_avg
[0m09:18:57.595521 [debug] [Thread-4 (]: Began compiling node model.data_project_1.int_hourly_avg
[0m09:18:57.596831 [debug] [Thread-1 (]: Began compiling node model.data_project_1.int_monthly_avg
[0m09:18:57.598468 [debug] [Thread-2 (]: Began compiling node model.data_project_1.int_station_summary
[0m09:18:57.603094 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.int_daily_avg"
[0m09:18:57.607255 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.int_hourly_avg"
[0m09:18:57.611539 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.int_monthly_avg"
[0m09:18:57.617785 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.int_station_summary"
[0m09:18:57.629835 [debug] [Thread-3 (]: Began executing node model.data_project_1.int_daily_avg
[0m09:18:57.631703 [debug] [Thread-4 (]: Began executing node model.data_project_1.int_hourly_avg
[0m09:18:57.635215 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.int_daily_avg"
[0m09:18:57.637017 [debug] [Thread-1 (]: Began executing node model.data_project_1.int_monthly_avg
[0m09:18:57.641544 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.int_hourly_avg"
[0m09:18:57.642179 [debug] [Thread-2 (]: Began executing node model.data_project_1.int_station_summary
[0m09:18:57.647993 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.int_monthly_avg"
[0m09:18:57.654040 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.int_station_summary"
[0m09:18:57.662030 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m09:18:57.664333 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: BEGIN
[0m09:18:57.664898 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m09:18:57.666415 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m09:18:57.667005 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:18:57.668285 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: BEGIN
[0m09:18:57.669921 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m09:18:57.670313 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: BEGIN
[0m09:18:57.674117 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:18:57.675505 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: BEGIN
[0m09:18:57.677155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:57.679527 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:18:57.681120 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m09:18:57.684164 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m09:18:57.686111 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */

  create view "data_project_1"."public"."int_daily_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m09:18:57.687681 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m09:18:57.689283 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:18:57.689707 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m09:18:57.691368 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m09:18:57.693215 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */

  create view "data_project_1"."public"."int_hourly_avg__dbt_tmp"
    
    
  as (
    with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    avg(no2) as no2_avg,
    avg(o3) as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by 1,2,3
order by fecha_hour, city, nombre_estacion
  );
[0m09:18:57.694401 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */

  create view "data_project_1"."public"."int_monthly_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_month,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_month
order by city, nombre_estacion, fecha_month
  );
[0m09:18:57.705603 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:18:57.706693 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m09:18:57.707475 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:18:57.708557 [debug] [Thread-2 (]: SQL status: BEGIN in 0.029 seconds
[0m09:18:57.712276 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m09:18:57.717683 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m09:18:57.722522 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m09:18:57.724890 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m09:18:57.727398 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
alter table "data_project_1"."public"."int_monthly_avg__dbt_tmp" rename to "int_monthly_avg"
[0m09:18:57.729569 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
alter table "data_project_1"."public"."int_daily_avg__dbt_tmp" rename to "int_daily_avg"
[0m09:18:57.732129 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
alter table "data_project_1"."public"."int_hourly_avg__dbt_tmp" rename to "int_hourly_avg"
[0m09:18:57.734832 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */

  create view "data_project_1"."public"."int_station_summary__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m09:18:57.740806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:18:57.743327 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:18:57.744285 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:18:57.749986 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m09:18:57.754595 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m09:18:57.760008 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m09:18:57.761347 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m09:18:57.763132 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m09:18:57.765011 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m09:18:57.766961 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m09:18:57.773586 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m09:18:57.775645 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m09:18:57.778103 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m09:18:57.780081 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m09:18:57.782622 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
alter table "data_project_1"."public"."int_station_summary__dbt_tmp" rename to "int_station_summary"
[0m09:18:57.787737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:18:57.796540 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m09:18:57.796134 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."int_monthly_avg__dbt_backup"
[0m09:18:57.801675 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: COMMIT
[0m09:18:57.802873 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m09:18:57.805075 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m09:18:57.808197 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m09:18:57.810919 [debug] [Thread-4 (]: SQL status: COMMIT in 0.023 seconds
[0m09:18:57.820445 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."int_daily_avg__dbt_backup"
[0m09:18:57.823107 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
drop view if exists "data_project_1"."public"."int_monthly_avg__dbt_backup" cascade
[0m09:18:57.825245 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: COMMIT
[0m09:18:57.831064 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."int_hourly_avg__dbt_backup"
[0m09:18:57.833560 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m09:18:57.836498 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:18:57.842986 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m09:18:57.844105 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m09:18:57.857581 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
drop view if exists "data_project_1"."public"."int_daily_avg__dbt_backup" cascade
[0m09:18:57.861118 [debug] [Thread-1 (]: On model.data_project_1.int_monthly_avg: Close
[0m09:18:57.863705 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
drop view if exists "data_project_1"."public"."int_hourly_avg__dbt_backup" cascade
[0m09:18:57.869267 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."int_station_summary__dbt_backup"
[0m09:18:57.871995 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:18:57.874016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400cfd8a490>]}
[0m09:18:57.876302 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:18:57.877552 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m09:18:57.882165 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: Close
[0m09:18:57.886104 [info ] [Thread-1 (]: 13 of 22 OK created sql view model public.int_monthly_avg ...................... [[32mCREATE VIEW[0m in 0.28s]
[0m09:18:57.892387 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: Close
[0m09:18:57.894669 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
drop view if exists "data_project_1"."public"."int_station_summary__dbt_backup" cascade
[0m09:18:57.897609 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400cfde2f10>]}
[0m09:18:57.900612 [debug] [Thread-1 (]: Finished running node model.data_project_1.int_monthly_avg
[0m09:18:57.903440 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400cfde1250>]}
[0m09:18:57.908347 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:18:57.911540 [info ] [Thread-3 (]: 11 of 22 OK created sql view model public.int_daily_avg ........................ [[32mCREATE VIEW[0m in 0.31s]
[0m09:18:57.926045 [debug] [Thread-3 (]: Finished running node model.data_project_1.int_daily_avg
[0m09:18:57.918592 [info ] [Thread-4 (]: 12 of 22 OK created sql view model public.int_hourly_avg ....................... [[32mCREATE VIEW[0m in 0.31s]
[0m09:18:57.922170 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: Close
[0m09:18:57.914820 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_station_summary
[0m09:18:57.933157 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_monthly_promedio
[0m09:18:57.936490 [debug] [Thread-4 (]: Finished running node model.data_project_1.int_hourly_avg
[0m09:18:57.940423 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400fcdccad0>]}
[0m09:18:57.942599 [info ] [Thread-1 (]: 15 of 22 START sql table model public.mart_station_summary ..................... [RUN]
[0m09:18:57.945195 [info ] [Thread-3 (]: 16 of 22 START sql table model public.mart_monthly_promedio .................... [RUN]
[0m09:18:57.947204 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_daily_promedio
[0m09:18:57.951221 [info ] [Thread-2 (]: 14 of 22 OK created sql view model public.int_station_summary .................. [[32mCREATE VIEW[0m in 0.35s]
[0m09:18:57.955009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_monthly_avg, now model.data_project_1.mart_station_summary)
[0m09:18:57.957981 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_daily_avg, now model.data_project_1.mart_monthly_promedio)
[0m09:18:57.960456 [info ] [Thread-4 (]: 17 of 22 START sql table model public.mart_daily_promedio ...................... [RUN]
[0m09:18:57.962964 [debug] [Thread-2 (]: Finished running node model.data_project_1.int_station_summary
[0m09:18:57.965468 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_station_summary
[0m09:18:57.967394 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_monthly_promedio
[0m09:18:57.969886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_hourly_avg, now model.data_project_1.mart_daily_promedio)
[0m09:18:57.972141 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_top_polluted_stations
[0m09:18:57.980184 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_station_summary"
[0m09:18:57.985680 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_monthly_promedio"
[0m09:18:57.987837 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_daily_promedio
[0m09:18:57.990565 [info ] [Thread-2 (]: 18 of 22 START sql table model public.mart_top_polluted_stations ............... [RUN]
[0m09:18:58.004442 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_daily_promedio"
[0m09:18:58.006862 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_station_summary, now model.data_project_1.mart_top_polluted_stations)
[0m09:18:58.011787 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_top_polluted_stations
[0m09:18:58.020386 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_monthly_promedio
[0m09:18:58.019296 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_top_polluted_stations"
[0m09:18:58.022084 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_station_summary
[0m09:18:58.035372 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_daily_promedio
[0m09:18:58.063218 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_monthly_promedio"
[0m09:18:58.074063 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_station_summary"
[0m09:18:58.081757 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_top_polluted_stations
[0m09:18:58.084068 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_daily_promedio"
[0m09:18:58.092885 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_top_polluted_stations"
[0m09:18:58.112132 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m09:18:58.113197 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m09:18:58.114954 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m09:18:58.115696 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: BEGIN
[0m09:18:58.117737 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m09:18:58.118454 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: BEGIN
[0m09:18:58.120392 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: BEGIN
[0m09:18:58.122606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:58.124406 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: BEGIN
[0m09:18:58.126523 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:18:58.128364 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:18:58.131593 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:18:58.145367 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m09:18:58.148373 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m09:18:58.149245 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m09:18:58.150554 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */

  
    

  create  table "data_project_1"."public"."mart_monthly_promedio__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    nombre_estacion,
    fecha_month,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as contaminacion_promedio
from "data_project_1"."public"."int_monthly_avg"
  );
  
[0m09:18:58.151229 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m09:18:58.151781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m09:18:58.152944 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m09:18:58.156155 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m09:18:58.158021 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m09:18:58.159808 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */

  
    

  create  table "data_project_1"."public"."mart_daily_promedio__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * 
    from "data_project_1"."public"."int_daily_avg"
)

select
    city,
    nombre_estacion,
    fecha_day,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Calculamos un Ã­ndice de contaminaciÃ³n promedio
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n del nivel de NO2
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por dÃ­a dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_day order by pm25_avg desc) as ranking_pm25
from daily_data
order by fecha_day, city, nombre_estacion
  );
  
[0m09:18:58.161830 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */

  
    

  create  table "data_project_1"."public"."mart_top_polluted_stations__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."public"."int_daily_avg"
),

ranked as (
    select
        city,
        nombre_estacion,
        fecha_day,
        no2_avg,
        o3_avg,
        pm10_avg,
        pm25_avg,
        rank() over (partition by city, fecha_day order by pm25_avg desc) as rank_pm25,
        rank() over (partition by city, fecha_day order by pm10_avg desc) as rank_pm10
    from daily_data
)

select *
from ranked
where rank_pm25 <= 5 or rank_pm10 <= 5
order by fecha_day, city, rank_pm25, rank_pm10
  );
  
[0m09:18:58.163672 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */

  
    

  create  table "data_project_1"."public"."mart_station_summary__dbt_tmp"
  
  
    as
  
  (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
),

daily_avg as (
    select
        city,
        nombre_estacion,
        fecha_day,
        avg(no2)  as no2_avg,
        avg(o3)   as o3_avg,
        avg(pm10) as pm10_avg,
        avg(pm25) as pm25_avg
    from all_data
    group by city, nombre_estacion, fecha_day
),

station_summary as (
    select
        city,
        nombre_estacion,
        min(fecha_day) as first_measurement,
        max(fecha_day) as last_measurement,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg,
        case
            when avg(pm25_avg) > 50 then 'Alto'
            when avg(pm25_avg) > 25 then 'Moderado'
            else 'Bajo'
        end as nivel_pm25
    from daily_avg
    group by city, nombre_estacion
)

select *
from station_summary
order by city, nombre_estacion
  );
  
[0m09:18:58.172673 [debug] [Thread-3 (]: SQL status: SELECT 34 in 0.018 seconds
[0m09:18:58.181304 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m09:18:58.183007 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."public"."mart_monthly_promedio__dbt_tmp" rename to "mart_monthly_promedio"
[0m09:18:58.183902 [debug] [Thread-4 (]: SQL status: SELECT 68 in 0.019 seconds
[0m09:18:58.184539 [debug] [Thread-1 (]: SQL status: SELECT 34 in 0.014 seconds
[0m09:18:58.185103 [debug] [Thread-2 (]: SQL status: SELECT 36 in 0.019 seconds
[0m09:18:58.186320 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:18:58.189850 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m09:18:58.193916 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m09:18:58.198149 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m09:18:58.200503 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m09:18:58.202152 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."public"."mart_daily_promedio__dbt_tmp" rename to "mart_daily_promedio"
[0m09:18:58.203425 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
alter table "data_project_1"."public"."mart_station_summary__dbt_tmp" rename to "mart_station_summary"
[0m09:18:58.205146 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."public"."mart_top_polluted_stations__dbt_tmp" rename to "mart_top_polluted_stations"
[0m09:18:58.206485 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m09:18:58.208914 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:18:58.209615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:18:58.210562 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:18:58.211491 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m09:18:58.213706 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m09:18:58.216072 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: COMMIT
[0m09:18:58.218368 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m09:18:58.221674 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m09:18:58.222133 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:18:58.223995 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m09:18:58.225553 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m09:18:58.226913 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m09:18:58.230366 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."mart_monthly_promedio__dbt_backup"
[0m09:18:58.232096 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: COMMIT
[0m09:18:58.233911 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m09:18:58.240319 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m09:18:58.244486 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m09:18:58.246342 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
drop table if exists "data_project_1"."public"."mart_monthly_promedio__dbt_backup" cascade
[0m09:18:58.250664 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."mart_daily_promedio__dbt_backup"
[0m09:18:58.253110 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:18:58.254659 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m09:18:58.256193 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m09:18:58.257726 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: Close
[0m09:18:58.258222 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m09:18:58.259591 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
drop table if exists "data_project_1"."public"."mart_daily_promedio__dbt_backup" cascade
[0m09:18:58.263498 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."mart_station_summary__dbt_backup"
[0m09:18:58.265952 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400cfd78cd0>]}
[0m09:18:58.270878 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."mart_top_polluted_stations__dbt_backup"
[0m09:18:58.273279 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:18:58.274443 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m09:18:58.276473 [info ] [Thread-3 (]: 16 of 22 OK created sql table model public.mart_monthly_promedio ............... [[32mSELECT 34[0m in 0.31s]
[0m09:18:58.278470 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m09:18:58.281265 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: Close
[0m09:18:58.283513 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
drop table if exists "data_project_1"."public"."mart_station_summary__dbt_backup" cascade
[0m09:18:58.285371 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_monthly_promedio
[0m09:18:58.287246 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
drop table if exists "data_project_1"."public"."mart_top_polluted_stations__dbt_backup" cascade
[0m09:18:58.289704 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400ccc84e50>]}
[0m09:18:58.291832 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:18:58.292958 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_weekly_extended
[0m09:18:58.295382 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:18:58.296660 [info ] [Thread-4 (]: 17 of 22 OK created sql table model public.mart_daily_promedio ................. [[32mSELECT 68[0m in 0.32s]
[0m09:18:58.299357 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: Close
[0m09:18:58.301963 [info ] [Thread-3 (]: 19 of 22 START sql table model public.mart_weekly_extended ..................... [RUN]
[0m09:18:58.307447 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: Close
[0m09:18:58.309492 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_daily_promedio
[0m09:18:58.311600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400ccc95c50>]}
[0m09:18:58.313017 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_monthly_promedio, now model.data_project_1.mart_weekly_extended)
[0m09:18:58.315045 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400ccc84150>]}
[0m09:18:58.316350 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_alerts
[0m09:18:58.318571 [info ] [Thread-1 (]: 15 of 22 OK created sql table model public.mart_station_summary ................ [[32mSELECT 34[0m in 0.36s]
[0m09:18:58.320247 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_weekly_extended
[0m09:18:58.321870 [info ] [Thread-2 (]: 18 of 22 OK created sql table model public.mart_top_polluted_stations .......... [[32mSELECT 36[0m in 0.31s]
[0m09:18:58.323508 [info ] [Thread-4 (]: 20 of 22 START sql table model public.mart_alerts .............................. [RUN]
[0m09:18:58.326925 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_station_summary
[0m09:18:58.331457 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_weekly_extended"
[0m09:18:58.333522 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_top_polluted_stations
[0m09:18:58.335329 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_daily_promedio, now model.data_project_1.mart_alerts)
[0m09:18:58.337247 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_hourly
[0m09:18:58.342649 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_alerts
[0m09:18:58.346154 [info ] [Thread-1 (]: 21 of 22 START sql table model public.mart_hourly .............................. [RUN]
[0m09:18:58.351257 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_alerts"
[0m09:18:58.352928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_station_summary, now model.data_project_1.mart_hourly)
[0m09:18:58.356169 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_hourly
[0m09:18:58.360618 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_hourly"
[0m09:18:58.361260 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_weekly_extended
[0m09:18:58.364201 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_alerts
[0m09:18:58.367665 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_weekly_extended"
[0m09:18:58.372459 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_alerts"
[0m09:18:58.375861 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_hourly
[0m09:18:58.381980 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_hourly"
[0m09:18:58.384457 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m09:18:58.384953 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m09:18:58.386832 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: BEGIN
[0m09:18:58.388426 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: BEGIN
[0m09:18:58.390065 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:18:58.391159 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m09:18:58.391912 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:18:58.395799 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: BEGIN
[0m09:18:58.398890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:18:58.403305 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m09:18:58.407615 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m09:18:58.411023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m09:18:58.418073 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m09:18:58.419665 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m09:18:58.421653 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m09:18:58.424160 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */

  
    

  create  table "data_project_1"."public"."mart_weekly_extended__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."public"."int_daily_avg"
),

weekly_data as (
    select
        city,
        nombre_estacion,
        date_trunc('week', fecha_day) as fecha_week,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg
    from daily_data
    group by city, nombre_estacion, date_trunc('week', fecha_day)
)

select
    *,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2
from weekly_data
order by fecha_week, city, nombre_estacion
  );
  
[0m09:18:58.426509 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */

  
    

  create  table "data_project_1"."public"."mart_alerts__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select *
    from "data_project_1"."public"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    case 
        when no2_avg > 200 then 'Alerta NO2'
        when o3_avg > 180 then 'Alerta O3'
        when pm10_avg > 150 then 'Alerta PM10'
        when pm25_avg > 75 then 'Alerta PM2.5'
        else null
    end as alerta
from hourly_data
where no2_avg > 200
   or o3_avg > 180
   or pm10_avg > 150
   or pm25_avg > 75
order by fecha_hour, city, nombre_estacion
  );
  
[0m09:18:58.429078 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */

  
    

  create  table "data_project_1"."public"."mart_hourly__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select * 
    from "data_project_1"."public"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Ãndice de contaminaciÃ³n por hora
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n de NO2 por niveles
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por hora dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_hour order by pm25_avg desc) as ranking_pm25
from hourly_data
order by fecha_hour, city, nombre_estacion
  );
  
[0m09:18:58.455356 [debug] [Thread-3 (]: SQL status: SELECT 34 in 0.020 seconds
[0m09:18:58.457001 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.020 seconds
[0m09:18:58.466463 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m09:18:58.474360 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m09:18:58.476686 [debug] [Thread-1 (]: SQL status: SELECT 170 in 0.035 seconds
[0m09:18:58.477822 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."public"."mart_weekly_extended__dbt_tmp" rename to "mart_weekly_extended"
[0m09:18:58.480189 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."public"."mart_alerts__dbt_tmp" rename to "mart_alerts"
[0m09:18:58.485845 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m09:18:58.489664 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:18:58.490742 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:18:58.492480 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."public"."mart_hourly__dbt_tmp" rename to "mart_hourly"
[0m09:18:58.495838 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m09:18:58.500100 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: COMMIT
[0m09:18:58.503053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:18:58.504374 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m09:18:58.506723 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m09:18:58.510295 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: COMMIT
[0m09:18:58.512386 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m09:18:58.514666 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: COMMIT
[0m09:18:58.516875 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m09:18:58.524762 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:18:58.526221 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: COMMIT
[0m09:18:58.527506 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:18:58.543637 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."mart_weekly_extended__dbt_backup"
[0m09:18:58.549591 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."mart_alerts__dbt_backup"
[0m09:18:58.550140 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m09:18:58.552283 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m09:18:58.554461 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m09:18:58.558254 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."mart_hourly__dbt_backup"
[0m09:18:58.560189 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
drop table if exists "data_project_1"."public"."mart_weekly_extended__dbt_backup" cascade
[0m09:18:58.562617 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
drop table if exists "data_project_1"."public"."mart_alerts__dbt_backup" cascade
[0m09:18:58.565722 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m09:18:58.568461 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:18:58.572073 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:18:58.573246 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
drop table if exists "data_project_1"."public"."mart_hourly__dbt_backup" cascade
[0m09:18:58.576357 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: Close
[0m09:18:58.579159 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: Close
[0m09:18:58.582186 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:18:58.584780 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400ccca7ed0>]}
[0m09:18:58.587127 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400cccd0bd0>]}
[0m09:18:58.589987 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: Close
[0m09:18:58.592557 [info ] [Thread-3 (]: 19 of 22 OK created sql table model public.mart_weekly_extended ................ [[32mSELECT 34[0m in 0.27s]
[0m09:18:58.595342 [info ] [Thread-4 (]: 20 of 22 OK created sql table model public.mart_alerts ......................... [[32mSELECT 0[0m in 0.25s]
[0m09:18:58.598190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400cccbe990>]}
[0m09:18:58.602326 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_weekly_extended
[0m09:18:58.604342 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_alerts
[0m09:18:58.606419 [info ] [Thread-1 (]: 21 of 22 OK created sql table model public.mart_hourly ......................... [[32mSELECT 170[0m in 0.25s]
[0m09:18:58.608864 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_fact_air_quality
[0m09:18:58.612534 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_hourly
[0m09:18:58.615012 [info ] [Thread-2 (]: 22 of 22 START sql table model public.mart_fact_air_quality .................... [RUN]
[0m09:18:58.618806 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_top_polluted_stations, now model.data_project_1.mart_fact_air_quality)
[0m09:18:58.620624 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_fact_air_quality
[0m09:18:58.626623 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_fact_air_quality"
[0m09:18:58.646911 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_fact_air_quality
[0m09:18:58.652808 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_fact_air_quality"
[0m09:18:58.673255 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m09:18:58.674703 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: BEGIN
[0m09:18:58.676456 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:18:58.686984 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m09:18:58.688852 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m09:18:58.690679 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */

  
    

  create  table "data_project_1"."public"."mart_fact_air_quality__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * from "data_project_1"."public"."int_daily_avg"
),
weekly_data as (
    select * from "data_project_1"."public"."mart_weekly_extended"
),
monthly_data as (
    select * from "data_project_1"."public"."int_monthly_avg"
)

select
    coalesce(d.city, w.city, m.city) as city,
    coalesce(d.nombre_estacion, w.nombre_estacion, m.nombre_estacion) as nombre_estacion,
    d.fecha_day,
    w.fecha_week,
    m.fecha_month,
    d.no2_avg as daily_no2,
    d.o3_avg as daily_o3,
    d.pm10_avg as daily_pm10,
    d.pm25_avg as daily_pm25,
    w.no2_avg as weekly_no2,
    w.o3_avg as weekly_o3,
    w.pm10_avg as weekly_pm10,
    w.pm25_avg as weekly_pm25,
    m.no2_avg as monthly_no2,
    m.o3_avg as monthly_o3,
    m.pm10_avg as monthly_pm10,
    m.pm25_avg as monthly_pm25
from daily_data d
full outer join weekly_data w
    on d.city = w.city
    and d.nombre_estacion = w.nombre_estacion
    and date_trunc('week', d.fecha_day) = w.fecha_week
full outer join monthly_data m
    on coalesce(d.city, w.city) = m.city
    and coalesce(d.nombre_estacion, w.nombre_estacion) = m.nombre_estacion
    and date_trunc('month', d.fecha_day) = m.fecha_month
order by city, nombre_estacion, d.fecha_day
  );
  
[0m09:18:58.705460 [debug] [Thread-2 (]: SQL status: SELECT 68 in 0.013 seconds
[0m09:18:58.711186 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m09:18:58.712625 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."public"."mart_fact_air_quality__dbt_tmp" rename to "mart_fact_air_quality"
[0m09:18:58.715504 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:18:58.717953 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m09:18:58.719381 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m09:18:58.721059 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m09:18:58.724397 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:18:58.728016 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."mart_fact_air_quality__dbt_backup"
[0m09:18:58.729945 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m09:18:58.731415 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
drop table if exists "data_project_1"."public"."mart_fact_air_quality__dbt_backup" cascade
[0m09:18:58.733520 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:18:58.735921 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: Close
[0m09:18:58.737980 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c802f7e0-a201-46a0-b768-8431de965c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7400cfe66e10>]}
[0m09:18:58.740079 [info ] [Thread-2 (]: 22 of 22 OK created sql table model public.mart_fact_air_quality ............... [[32mSELECT 68[0m in 0.12s]
[0m09:18:58.742005 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_fact_air_quality
[0m09:18:58.745849 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:58.746924 [debug] [MainThread]: On master: BEGIN
[0m09:18:58.748185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:18:58.757952 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m09:18:58.759785 [debug] [MainThread]: On master: COMMIT
[0m09:18:58.761324 [debug] [MainThread]: Using postgres connection "master"
[0m09:18:58.762838 [debug] [MainThread]: On master: COMMIT
[0m09:18:58.764457 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:18:58.765825 [debug] [MainThread]: On master: Close
[0m09:18:58.767288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:18:58.768545 [debug] [MainThread]: Connection 'model.data_project_1.mart_hourly' was properly closed.
[0m09:18:58.770044 [debug] [MainThread]: Connection 'model.data_project_1.mart_fact_air_quality' was properly closed.
[0m09:18:58.771435 [debug] [MainThread]: Connection 'model.data_project_1.mart_alerts' was properly closed.
[0m09:18:58.772870 [debug] [MainThread]: Connection 'model.data_project_1.mart_weekly_extended' was properly closed.
[0m09:18:58.774962 [info ] [MainThread]: 
[0m09:18:58.776528 [info ] [MainThread]: Finished running 8 table models, 8 data tests, 6 view models in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m09:18:58.780806 [debug] [MainThread]: Command end result
[0m09:18:58.849496 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m09:18:58.859803 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m09:18:58.876500 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m09:18:58.878007 [info ] [MainThread]: 
[0m09:18:58.879441 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:18:58.880923 [info ] [MainThread]: 
[0m09:18:58.882504 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=22
[0m09:18:58.884748 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.29515, "process_in_blocks": "3016", "process_kernel_time": 0.664259, "process_mem_max_rss": "137156", "process_out_blocks": "0", "process_user_time": 5.131809}
[0m09:18:58.886106 [debug] [MainThread]: Command `dbt build` succeeded at 09:18:58.885978 after 5.30 seconds
[0m09:18:58.887495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740102072550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740102070690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740106b7b910>]}
[0m09:18:58.889142 [debug] [MainThread]: Flushing usage events
[0m09:18:59.420783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:48:17.349854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a90750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a92a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a90910>]}


============================== 21:48:17.354144 | c45ce241-04f5-4e15-99b6-9a785ed8a845 ==============================
[0m21:48:17.354144 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:48:17.355939 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'write_json': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'log_path': '/usr/app/dbt/logs', 'introspect': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'indirect_selection': 'eager'}
[0m21:48:17.466392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c45ce241-04f5-4e15-99b6-9a785ed8a845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a93a50>]}
[0m21:48:17.473061 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:48:17.474110 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:48:17.474844 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15276162, "process_in_blocks": "13240", "process_kernel_time": 0.082671, "process_mem_max_rss": "104484", "process_out_blocks": "3", "process_user_time": 0.787932}
[0m21:48:17.475147 [debug] [MainThread]: Command `dbt deps` succeeded at 21:48:17.475093 after 0.15 seconds
[0m21:48:17.475485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85996290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a895d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86074410>]}
[0m21:48:17.475733 [debug] [MainThread]: Flushing usage events
[0m21:48:18.135818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:48:18.838798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e292d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e290790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e196c10>]}


============================== 21:48:18.841261 | 30976036-c2c8-4c00-bcb1-edc0ab11256f ==============================
[0m21:48:18.841261 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:48:18.841533 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'empty': 'False', 'static_parser': 'True', 'profiles_dir': '/usr/app/dbt', 'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'debug': 'False', 'partial_parse': 'True', 'target_path': 'None', 'introspect': 'True', 'log_path': '/usr/app/dbt/logs', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target dev', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None'}
[0m21:48:18.893688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d3be1d0>]}
[0m21:48:18.914297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9109ed10>]}
[0m21:48:18.914626 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:48:18.938351 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m21:48:18.985058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 18 files changed.
[0m21:48:18.985357 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/staging/sources.yml
[0m21:48:18.985550 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/staging/schema.yml
[0m21:48:18.985794 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/marts/schema.yml
[0m21:48:18.985993 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/intermediate/schema.yml
[0m21:48:18.986184 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/marts/mart_daily_promedio.sql
[0m21:48:18.986367 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/staging/stg_mediciones_valencia.sql
[0m21:48:18.986534 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/intermediate/int_hourly_avg.sql
[0m21:48:18.986695 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/intermediate/int_station_summary.sql
[0m21:48:18.986861 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/marts/mart_weekly_extended.sql
[0m21:48:18.987023 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/staging/stg_mediciones_madrid.sql
[0m21:48:18.987188 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/marts/mart_hourly.sql
[0m21:48:18.987350 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/marts/mart_station_summary.sql
[0m21:48:18.987503 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/intermediate/int_monthly_avg.sql
[0m21:48:18.987660 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/marts/mart_top_polluted_stations.sql
[0m21:48:18.987811 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/marts/mart_monthly_promedio.sql
[0m21:48:18.987963 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/intermediate/int_daily_avg.sql
[0m21:48:18.988116 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/marts/mart_fact_air_quality.sql
[0m21:48:18.988276 [debug] [MainThread]: Partial parsing: updated file: data_project_1://models/marts/mart_alerts.sql
[0m21:48:19.177949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e350ad0>]}
[0m21:48:19.214258 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m21:48:19.215302 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m21:48:19.228927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c5c10d0>]}
[0m21:48:19.229153 [info ] [MainThread]: Found 14 models, 8 data tests, 1 source, 459 macros
[0m21:48:19.230496 [info ] [MainThread]: 
[0m21:48:19.230673 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:48:19.230805 [info ] [MainThread]: 
[0m21:48:19.231014 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:48:19.232792 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1'
[0m21:48:19.246709 [debug] [ThreadPool]: Using postgres connection "list_data_project_1"
[0m21:48:19.246913 [debug] [ThreadPool]: On list_data_project_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1"} */

    select distinct nspname from pg_namespace
  
[0m21:48:19.247023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:19.251763 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m21:48:19.252299 [debug] [ThreadPool]: On list_data_project_1: Close
[0m21:48:19.253257 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1_public'
[0m21:48:19.255836 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_public"
[0m21:48:19.255999 [debug] [ThreadPool]: On list_data_project_1_public: BEGIN
[0m21:48:19.257020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:19.260497 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:48:19.260726 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_public"
[0m21:48:19.260875 [debug] [ThreadPool]: On list_data_project_1_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1_public"} */
select
      'data_project_1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'data_project_1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'data_project_1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:48:19.262730 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m21:48:19.263504 [debug] [ThreadPool]: On list_data_project_1_public: ROLLBACK
[0m21:48:19.263725 [debug] [ThreadPool]: On list_data_project_1_public: Close
[0m21:48:19.266570 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:19.266733 [debug] [MainThread]: On master: BEGIN
[0m21:48:19.266885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:19.270453 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:48:19.270648 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:19.270827 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:48:19.273343 [debug] [MainThread]: SQL status: SELECT 20 in 0.002 seconds
[0m21:48:19.275287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1bfb50>]}
[0m21:48:19.275799 [debug] [MainThread]: On master: ROLLBACK
[0m21:48:19.276082 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:19.276201 [debug] [MainThread]: On master: BEGIN
[0m21:48:19.276431 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:48:19.276580 [debug] [MainThread]: On master: COMMIT
[0m21:48:19.276702 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:19.276804 [debug] [MainThread]: On master: COMMIT
[0m21:48:19.277001 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:48:19.277159 [debug] [MainThread]: On master: Close
[0m21:48:19.280066 [debug] [Thread-1 (]: Began running node model.data_project_1.stg_mediciones_madrid
[0m21:48:19.280239 [debug] [Thread-2 (]: Began running node model.data_project_1.stg_mediciones_valencia
[0m21:48:19.280503 [info ] [Thread-1 (]: 1 of 22 START sql view model public.stg_mediciones_madrid ...................... [RUN]
[0m21:48:19.280762 [info ] [Thread-2 (]: 2 of 22 START sql view model public.stg_mediciones_valencia .................... [RUN]
[0m21:48:19.281006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_project_1_public, now model.data_project_1.stg_mediciones_madrid)
[0m21:48:19.281212 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_data_project_1, now model.data_project_1.stg_mediciones_valencia)
[0m21:48:19.281381 [debug] [Thread-1 (]: Began compiling node model.data_project_1.stg_mediciones_madrid
[0m21:48:19.281555 [debug] [Thread-2 (]: Began compiling node model.data_project_1.stg_mediciones_valencia
[0m21:48:19.284652 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_madrid"
[0m21:48:19.285874 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_valencia"
[0m21:48:19.286970 [debug] [Thread-1 (]: Began executing node model.data_project_1.stg_mediciones_madrid
[0m21:48:19.287158 [debug] [Thread-2 (]: Began executing node model.data_project_1.stg_mediciones_valencia
[0m21:48:19.299830 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_madrid"
[0m21:48:19.301215 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_valencia"
[0m21:48:19.302264 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:48:19.302557 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: BEGIN
[0m21:48:19.302698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:19.302466 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:48:19.303020 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: BEGIN
[0m21:48:19.303356 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:48:19.306194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m21:48:19.306341 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:48:19.306480 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */

  create view "data_project_1"."public"."stg_mediciones_madrid__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'madrid' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='madrid'
  );
[0m21:48:19.307576 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m21:48:19.307736 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:48:19.307962 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */

  create view "data_project_1"."public"."stg_mediciones_valencia__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'valencia' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='valencia'
  );
[0m21:48:19.307839 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m21:48:19.310455 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:48:19.310735 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."public"."stg_mediciones_madrid" rename to "stg_mediciones_madrid__dbt_backup"
[0m21:48:19.310572 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:48:19.311920 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:48:19.312168 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."public"."stg_mediciones_valencia" rename to "stg_mediciones_valencia__dbt_backup"
[0m21:48:19.312030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:48:19.313286 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:48:19.313599 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."public"."stg_mediciones_madrid__dbt_tmp" rename to "stg_mediciones_madrid"
[0m21:48:19.313428 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:48:19.314687 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:48:19.314966 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."public"."stg_mediciones_valencia__dbt_tmp" rename to "stg_mediciones_valencia"
[0m21:48:19.314817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:48:19.321443 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m21:48:19.321732 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:48:19.321896 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m21:48:19.321579 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:48:19.322541 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m21:48:19.322789 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:48:19.322918 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m21:48:19.322655 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:48:19.325168 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."stg_mediciones_madrid__dbt_backup"
[0m21:48:19.325303 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m21:48:19.327714 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."stg_mediciones_valencia__dbt_backup"
[0m21:48:19.327952 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:48:19.328070 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
drop view if exists "data_project_1"."public"."stg_mediciones_valencia__dbt_backup" cascade
[0m21:48:19.326885 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:48:19.328265 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
drop view if exists "data_project_1"."public"."stg_mediciones_madrid__dbt_backup" cascade
[0m21:48:19.330096 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:48:19.331015 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: Close
[0m21:48:19.331761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87717290>]}
[0m21:48:19.332035 [info ] [Thread-2 (]: 2 of 22 OK created sql view model public.stg_mediciones_valencia ............... [[32mCREATE VIEW[0m in 0.05s]
[0m21:48:19.332275 [debug] [Thread-2 (]: Finished running node model.data_project_1.stg_mediciones_valencia
[0m21:48:19.331137 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:48:19.332898 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: Close
[0m21:48:19.333058 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:48:19.333181 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:48:19.333756 [info ] [Thread-3 (]: 4 of 22 START test not_null_stg_mediciones_valencia_id ......................... [RUN]
[0m21:48:19.333944 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e'
[0m21:48:19.333608 [info ] [Thread-4 (]: 3 of 22 START test not_null_stg_mediciones_valencia_fecha_carg ................. [RUN]
[0m21:48:19.333276 [debug] [Thread-2 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:48:19.334478 [info ] [Thread-2 (]: 5 of 22 START test not_null_stg_mediciones_valencia_nombre_estacion ............ [RUN]
[0m21:48:19.334081 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:48:19.334300 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e'
[0m21:48:19.333453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87bf3750>]}
[0m21:48:19.339626 [info ] [Thread-1 (]: 1 of 22 OK created sql view model public.stg_mediciones_madrid ................. [[32mCREATE VIEW[0m in 0.05s]
[0m21:48:19.339136 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:48:19.339361 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:48:19.334716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_valencia, now test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046)
[0m21:48:19.339841 [debug] [Thread-1 (]: Finished running node model.data_project_1.stg_mediciones_madrid
[0m21:48:19.341511 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:48:19.341697 [debug] [Thread-2 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:48:19.341960 [debug] [Thread-1 (]: Began running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:48:19.342071 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:48:19.343776 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:48:19.343990 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:48:19.344122 [info ] [Thread-1 (]: 6 of 22 START test unique_stg_mediciones_valencia_id ........................... [RUN]
[0m21:48:19.350513 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:48:19.351647 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:48:19.351895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_madrid, now test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170)
[0m21:48:19.352039 [debug] [Thread-2 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:48:19.352466 [debug] [Thread-1 (]: Began compiling node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:48:19.353483 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:48:19.353653 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:48:19.353771 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:48:19.356764 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:48:19.357115 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: BEGIN
[0m21:48:19.357376 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:48:19.357497 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: BEGIN
[0m21:48:19.357771 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:48:19.357946 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: BEGIN
[0m21:48:19.358073 [debug] [Thread-1 (]: Began executing node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:48:19.358206 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:48:19.358558 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:48:19.359704 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:48:19.362121 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m21:48:19.364296 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:48:19.364706 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:48:19.365316 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: BEGIN
[0m21:48:19.365207 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m21:48:19.364905 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."public"."stg_mediciones_valencia"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m21:48:19.365441 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m21:48:19.365655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:19.365854 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:48:19.366111 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:48:19.366607 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."public"."stg_mediciones_valencia"
where id is null



  
  
      
    ) dbt_internal_test
[0m21:48:19.366853 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:48:19.366984 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."public"."stg_mediciones_valencia"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m21:48:19.368922 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: ROLLBACK
[0m21:48:19.369162 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:48:19.370595 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: ROLLBACK
[0m21:48:19.370730 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: Close
[0m21:48:19.370870 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:48:19.371147 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: Close
[0m21:48:19.372499 [info ] [Thread-3 (]: 4 of 22 PASS not_null_stg_mediciones_valencia_id ............................... [[32mPASS[0m in 0.04s]
[0m21:48:19.372796 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:48:19.372191 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: ROLLBACK
[0m21:48:19.371277 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m21:48:19.373397 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:48:19.372961 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:48:19.373282 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: Close
[0m21:48:19.371571 [info ] [Thread-4 (]: 3 of 22 PASS not_null_stg_mediciones_valencia_fecha_carg ....................... [[32mPASS[0m in 0.04s]
[0m21:48:19.373545 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."public"."stg_mediciones_valencia"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:48:19.373723 [info ] [Thread-3 (]: 7 of 22 START test not_null_stg_mediciones_madrid_fecha_carg ................... [RUN]
[0m21:48:19.374024 [info ] [Thread-2 (]: 5 of 22 PASS not_null_stg_mediciones_valencia_nombre_estacion .................. [[32mPASS[0m in 0.04s]
[0m21:48:19.374276 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:48:19.374562 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e, now test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf)
[0m21:48:19.374851 [debug] [Thread-2 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:48:19.375045 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:48:19.376052 [info ] [Thread-4 (]: 8 of 22 START test not_null_stg_mediciones_madrid_id ........................... [RUN]
[0m21:48:19.375506 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:48:19.375825 [debug] [Thread-2 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:48:19.375335 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:48:19.378834 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: ROLLBACK
[0m21:48:19.378024 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:48:19.378287 [info ] [Thread-2 (]: 9 of 22 START test not_null_stg_mediciones_madrid_nombre_estacion .............. [RUN]
[0m21:48:19.376249 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e, now test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515)
[0m21:48:19.379720 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:48:19.379493 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046, now test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2)
[0m21:48:19.379088 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: Close
[0m21:48:19.381284 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:48:19.381553 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:48:19.381672 [debug] [Thread-2 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:48:19.381975 [info ] [Thread-1 (]: 6 of 22 PASS unique_stg_mediciones_valencia_id ................................. [[32mPASS[0m in 0.03s]
[0m21:48:19.383243 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:48:19.384999 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:48:19.385225 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:48:19.385400 [debug] [Thread-1 (]: Finished running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:48:19.386569 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:48:19.386786 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:48:19.386933 [debug] [Thread-2 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:48:19.387044 [debug] [Thread-1 (]: Began running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:48:19.387354 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: BEGIN
[0m21:48:19.388189 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:48:19.388390 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:48:19.388511 [info ] [Thread-1 (]: 10 of 22 START test unique_stg_mediciones_madrid_id ............................ [RUN]
[0m21:48:19.388719 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:48:19.388982 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: BEGIN
[0m21:48:19.389169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170, now test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c)
[0m21:48:19.389312 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:48:19.390035 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: BEGIN
[0m21:48:19.389881 [debug] [Thread-1 (]: Began compiling node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:48:19.389616 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:48:19.390206 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:48:19.391869 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:48:19.393138 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m21:48:19.393662 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:48:19.394456 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."public"."stg_mediciones_madrid"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m21:48:19.394710 [debug] [Thread-1 (]: Began executing node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:48:19.395716 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:48:19.396818 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:48:19.397128 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m21:48:19.397709 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: ROLLBACK
[0m21:48:19.397830 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m21:48:19.398212 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:48:19.398465 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: Close
[0m21:48:19.398593 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:48:19.399304 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: BEGIN
[0m21:48:19.398883 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."public"."stg_mediciones_madrid"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m21:48:19.398722 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:48:19.399195 [info ] [Thread-3 (]: 7 of 22 PASS not_null_stg_mediciones_madrid_fecha_carg ......................... [[32mPASS[0m in 0.02s]
[0m21:48:19.399502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:19.399788 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."public"."stg_mediciones_madrid"
where id is null



  
  
      
    ) dbt_internal_test
[0m21:48:19.400092 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:48:19.400366 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:48:19.401357 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: ROLLBACK
[0m21:48:19.401492 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:48:19.402838 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: Close
[0m21:48:19.403311 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: ROLLBACK
[0m21:48:19.403653 [info ] [Thread-2 (]: 9 of 22 PASS not_null_stg_mediciones_madrid_nombre_estacion .................... [[32mPASS[0m in 0.02s]
[0m21:48:19.403828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:48:19.404464 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:48:19.404186 [debug] [Thread-2 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:48:19.403968 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: Close
[0m21:48:19.404622 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."public"."stg_mediciones_madrid"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:48:19.405073 [info ] [Thread-4 (]: 8 of 22 PASS not_null_stg_mediciones_madrid_id ................................. [[32mPASS[0m in 0.03s]
[0m21:48:19.405647 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:48:19.406161 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:48:19.406689 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: ROLLBACK
[0m21:48:19.406864 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: Close
[0m21:48:19.407098 [info ] [Thread-1 (]: 10 of 22 PASS unique_stg_mediciones_madrid_id .................................. [[32mPASS[0m in 0.02s]
[0m21:48:19.407356 [debug] [Thread-1 (]: Finished running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:48:19.407792 [debug] [Thread-3 (]: Began running node model.data_project_1.int_daily_avg
[0m21:48:19.407921 [debug] [Thread-2 (]: Began running node model.data_project_1.int_hourly_avg
[0m21:48:19.408028 [debug] [Thread-4 (]: Began running node model.data_project_1.int_monthly_avg
[0m21:48:19.408157 [debug] [Thread-1 (]: Began running node model.data_project_1.int_station_summary
[0m21:48:19.408334 [info ] [Thread-3 (]: 11 of 22 START sql view model public.int_daily_avg ............................. [RUN]
[0m21:48:19.408577 [info ] [Thread-2 (]: 12 of 22 START sql view model public.int_hourly_avg ............................ [RUN]
[0m21:48:19.408771 [info ] [Thread-4 (]: 13 of 22 START sql view model public.int_monthly_avg ........................... [RUN]
[0m21:48:19.409500 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515, now model.data_project_1.int_monthly_avg)
[0m21:48:19.409159 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf, now model.data_project_1.int_daily_avg)
[0m21:48:19.409342 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2, now model.data_project_1.int_hourly_avg)
[0m21:48:19.409920 [debug] [Thread-2 (]: Began compiling node model.data_project_1.int_hourly_avg
[0m21:48:19.409637 [debug] [Thread-4 (]: Began compiling node model.data_project_1.int_monthly_avg
[0m21:48:19.409783 [debug] [Thread-3 (]: Began compiling node model.data_project_1.int_daily_avg
[0m21:48:19.408952 [info ] [Thread-1 (]: 14 of 22 START sql view model public.int_station_summary ....................... [RUN]
[0m21:48:19.411196 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.int_hourly_avg"
[0m21:48:19.413218 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.int_monthly_avg"
[0m21:48:19.414291 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.int_daily_avg"
[0m21:48:19.414490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c, now model.data_project_1.int_station_summary)
[0m21:48:19.415268 [debug] [Thread-1 (]: Began compiling node model.data_project_1.int_station_summary
[0m21:48:19.415534 [debug] [Thread-4 (]: Began executing node model.data_project_1.int_monthly_avg
[0m21:48:19.416580 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.int_station_summary"
[0m21:48:19.416809 [debug] [Thread-2 (]: Began executing node model.data_project_1.int_hourly_avg
[0m21:48:19.416942 [debug] [Thread-3 (]: Began executing node model.data_project_1.int_daily_avg
[0m21:48:19.418085 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.int_monthly_avg"
[0m21:48:19.419394 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.int_hourly_avg"
[0m21:48:19.420642 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.int_daily_avg"
[0m21:48:19.420776 [debug] [Thread-1 (]: Began executing node model.data_project_1.int_station_summary
[0m21:48:19.422352 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.int_station_summary"
[0m21:48:19.422514 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:48:19.422731 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:48:19.422889 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:48:19.422984 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: BEGIN
[0m21:48:19.423160 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:48:19.423253 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: BEGIN
[0m21:48:19.423821 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:48:19.423562 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:48:19.423707 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: BEGIN
[0m21:48:19.423407 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: BEGIN
[0m21:48:19.424206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:19.424375 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:48:19.428652 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m21:48:19.428797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:48:19.428973 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:48:19.429098 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m21:48:19.429326 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:48:19.429461 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m21:48:19.430109 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:48:19.429768 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:48:19.429952 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */

  create view "data_project_1"."public"."int_station_summary__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m21:48:19.429601 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */

  create view "data_project_1"."public"."int_hourly_avg__dbt_tmp"
    
    
  as (
    with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    avg(no2) as no2_avg,
    avg(o3) as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by 1,2,3
order by fecha_hour, city, nombre_estacion
  );
[0m21:48:19.430250 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */

  create view "data_project_1"."public"."int_monthly_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_month,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_month
order by city, nombre_estacion, fecha_month
  );
[0m21:48:19.430440 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */

  create view "data_project_1"."public"."int_daily_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m21:48:19.432432 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:48:19.432560 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:48:19.432670 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:48:19.433977 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:48:19.434119 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:48:19.435165 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:48:19.436212 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:48:19.438297 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
alter table "data_project_1"."public"."int_monthly_avg__dbt_tmp" rename to "int_monthly_avg"
[0m21:48:19.437925 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:48:19.438118 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
alter table "data_project_1"."public"."int_daily_avg__dbt_tmp" rename to "int_daily_avg"
[0m21:48:19.436397 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
alter table "data_project_1"."public"."int_hourly_avg__dbt_tmp" rename to "int_hourly_avg"
[0m21:48:19.438529 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
alter table "data_project_1"."public"."int_station_summary__dbt_tmp" rename to "int_station_summary"
[0m21:48:19.438687 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.439047 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.439472 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m21:48:19.440291 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:48:19.439675 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:48:19.440122 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m21:48:19.439571 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:48:19.440422 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m21:48:19.440952 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: COMMIT
[0m21:48:19.441138 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:48:19.441590 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m21:48:19.441834 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:48:19.442009 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m21:48:19.442131 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m21:48:19.442265 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:48:19.442429 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: COMMIT
[0m21:48:19.443409 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."int_monthly_avg__dbt_backup"
[0m21:48:19.443518 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:48:19.443657 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m21:48:19.443994 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:48:19.444108 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:48:19.444978 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."int_daily_avg__dbt_backup"
[0m21:48:19.445238 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
drop view if exists "data_project_1"."public"."int_monthly_avg__dbt_backup" cascade
[0m21:48:19.445341 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m21:48:19.446104 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."int_station_summary__dbt_backup"
[0m21:48:19.446375 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:48:19.447233 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."int_hourly_avg__dbt_backup"
[0m21:48:19.448027 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:48:19.447623 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:48:19.447809 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
drop view if exists "data_project_1"."public"."int_daily_avg__dbt_backup" cascade
[0m21:48:19.447342 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:48:19.448921 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: Close
[0m21:48:19.448333 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
drop view if exists "data_project_1"."public"."int_station_summary__dbt_backup" cascade
[0m21:48:19.448157 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
drop view if exists "data_project_1"."public"."int_hourly_avg__dbt_backup" cascade
[0m21:48:19.449031 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:48:19.449314 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87bf0950>]}
[0m21:48:19.449558 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:48:19.449678 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:48:19.450115 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: Close
[0m21:48:19.450403 [info ] [Thread-4 (]: 13 of 22 OK created sql view model public.int_monthly_avg ...................... [[32mCREATE VIEW[0m in 0.04s]
[0m21:48:19.450890 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: Close
[0m21:48:19.451340 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: Close
[0m21:48:19.451585 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87790990>]}
[0m21:48:19.451779 [debug] [Thread-4 (]: Finished running node model.data_project_1.int_monthly_avg
[0m21:48:19.452035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877bb910>]}
[0m21:48:19.452227 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b037d0>]}
[0m21:48:19.452477 [info ] [Thread-3 (]: 11 of 22 OK created sql view model public.int_daily_avg ........................ [[32mCREATE VIEW[0m in 0.04s]
[0m21:48:19.452723 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_station_summary
[0m21:48:19.453056 [info ] [Thread-1 (]: 14 of 22 OK created sql view model public.int_station_summary .................. [[32mCREATE VIEW[0m in 0.04s]
[0m21:48:19.453339 [info ] [Thread-2 (]: 12 of 22 OK created sql view model public.int_hourly_avg ....................... [[32mCREATE VIEW[0m in 0.04s]
[0m21:48:19.453583 [debug] [Thread-3 (]: Finished running node model.data_project_1.int_daily_avg
[0m21:48:19.453774 [info ] [Thread-4 (]: 15 of 22 START sql table model public.mart_station_summary ..................... [RUN]
[0m21:48:19.454012 [debug] [Thread-1 (]: Finished running node model.data_project_1.int_station_summary
[0m21:48:19.454204 [debug] [Thread-2 (]: Finished running node model.data_project_1.int_hourly_avg
[0m21:48:19.454394 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_monthly_promedio
[0m21:48:19.454635 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_monthly_avg, now model.data_project_1.mart_station_summary)
[0m21:48:19.454831 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_daily_promedio
[0m21:48:19.454994 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_top_polluted_stations
[0m21:48:19.455250 [info ] [Thread-3 (]: 16 of 22 START sql table model public.mart_monthly_promedio .................... [RUN]
[0m21:48:19.455425 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_station_summary
[0m21:48:19.455643 [info ] [Thread-1 (]: 17 of 22 START sql table model public.mart_daily_promedio ...................... [RUN]
[0m21:48:19.455841 [info ] [Thread-2 (]: 18 of 22 START sql table model public.mart_top_polluted_stations ............... [RUN]
[0m21:48:19.456041 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_daily_avg, now model.data_project_1.mart_monthly_promedio)
[0m21:48:19.457386 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_station_summary"
[0m21:48:19.457585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_station_summary, now model.data_project_1.mart_daily_promedio)
[0m21:48:19.457744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_hourly_avg, now model.data_project_1.mart_top_polluted_stations)
[0m21:48:19.457911 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_monthly_promedio
[0m21:48:19.458158 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_daily_promedio
[0m21:48:19.458322 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_top_polluted_stations
[0m21:48:19.459426 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_monthly_promedio"
[0m21:48:19.459566 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_station_summary
[0m21:48:19.460602 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_daily_promedio"
[0m21:48:19.461648 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_top_polluted_stations"
[0m21:48:19.497048 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_station_summary"
[0m21:48:19.497538 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_monthly_promedio
[0m21:48:19.498004 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_daily_promedio
[0m21:48:19.500807 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_daily_promedio"
[0m21:48:19.499559 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_top_polluted_stations
[0m21:48:19.499429 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_monthly_promedio"
[0m21:48:19.501066 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:48:19.502750 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: BEGIN
[0m21:48:19.502536 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:48:19.502310 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_top_polluted_stations"
[0m21:48:19.502894 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:48:19.503094 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:48:19.503213 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: BEGIN
[0m21:48:19.503626 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: BEGIN
[0m21:48:19.503977 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:48:19.504133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:19.504302 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:48:19.504468 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: BEGIN
[0m21:48:19.506403 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:48:19.506748 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m21:48:19.507147 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:48:19.507387 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */

  
    

  create  table "data_project_1"."public"."mart_station_summary__dbt_tmp"
  
  
    as
  
  (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
),

daily_avg as (
    select
        city,
        nombre_estacion,
        fecha_day,
        avg(no2)  as no2_avg,
        avg(o3)   as o3_avg,
        avg(pm10) as pm10_avg,
        avg(pm25) as pm25_avg
    from all_data
    group by city, nombre_estacion, fecha_day
),

station_summary as (
    select
        city,
        nombre_estacion,
        min(fecha_day) as first_measurement,
        max(fecha_day) as last_measurement,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg,
        case
            when avg(pm25_avg) > 50 then 'Alto'
            when avg(pm25_avg) > 25 then 'Moderado'
            else 'Bajo'
        end as nivel_pm25
    from daily_avg
    group by city, nombre_estacion
)

select *
from station_summary
order by city, nombre_estacion
  );
  
[0m21:48:19.510300 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m21:48:19.510463 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m21:48:19.510640 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:48:19.510770 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m21:48:19.511342 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:48:19.511077 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */

  
    

  create  table "data_project_1"."public"."mart_top_polluted_stations__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."public"."int_daily_avg"
),

ranked as (
    select
        city,
        nombre_estacion,
        fecha_day,
        no2_avg,
        o3_avg,
        pm10_avg,
        pm25_avg,
        rank() over (partition by city, fecha_day order by pm25_avg desc) as rank_pm25,
        rank() over (partition by city, fecha_day order by pm10_avg desc) as rank_pm10
    from daily_data
)

select *
from ranked
where rank_pm25 <= 5 or rank_pm10 <= 5
order by fecha_day, city, rank_pm25, rank_pm10
  );
  
[0m21:48:19.511216 [debug] [Thread-4 (]: SQL status: SELECT 34 in 0.004 seconds
[0m21:48:19.510901 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:48:19.514933 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */

  
    

  create  table "data_project_1"."public"."mart_monthly_promedio__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    nombre_estacion,
    fecha_month,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as contaminacion_promedio
from "data_project_1"."public"."int_monthly_avg"
  );
  
[0m21:48:19.514639 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:48:19.514779 [debug] [Thread-2 (]: SQL status: SELECT 56 in 0.003 seconds
[0m21:48:19.511487 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */

  
    

  create  table "data_project_1"."public"."mart_daily_promedio__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * 
    from "data_project_1"."public"."int_daily_avg"
)

select
    city,
    nombre_estacion,
    fecha_day,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Calculamos un Ã­ndice de contaminaciÃ³n promedio
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n del nivel de NO2
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por dÃ­a dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_day order by pm25_avg desc) as ranking_pm25
from daily_data
order by fecha_day, city, nombre_estacion
  );
  
[0m21:48:19.515185 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
alter table "data_project_1"."public"."mart_station_summary" rename to "mart_station_summary__dbt_backup"
[0m21:48:19.516317 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:48:19.516744 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."public"."mart_top_polluted_stations" rename to "mart_top_polluted_stations__dbt_backup"
[0m21:48:19.516861 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.517003 [debug] [Thread-3 (]: SQL status: SELECT 34 in 0.002 seconds
[0m21:48:19.518034 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:48:19.518160 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:48:19.519255 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:48:19.520677 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."public"."mart_monthly_promedio" rename to "mart_monthly_promedio__dbt_backup"
[0m21:48:19.519523 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
alter table "data_project_1"."public"."mart_station_summary__dbt_tmp" rename to "mart_station_summary"
[0m21:48:19.520509 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:48:19.519378 [debug] [Thread-1 (]: SQL status: SELECT 102 in 0.003 seconds
[0m21:48:19.520973 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.521106 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.521231 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."public"."mart_top_polluted_stations__dbt_tmp" rename to "mart_top_polluted_stations"
[0m21:48:19.522325 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:48:19.524614 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."public"."mart_daily_promedio" rename to "mart_daily_promedio__dbt_backup"
[0m21:48:19.524353 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: COMMIT
[0m21:48:19.523775 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:48:19.524748 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.525033 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:48:19.525146 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.525278 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."public"."mart_monthly_promedio__dbt_tmp" rename to "mart_monthly_promedio"
[0m21:48:19.525729 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m21:48:19.525900 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: COMMIT
[0m21:48:19.526845 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:48:19.527111 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:48:19.527254 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.528243 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m21:48:19.527713 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m21:48:19.527818 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m21:48:19.527505 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."public"."mart_daily_promedio__dbt_tmp" rename to "mart_daily_promedio"
[0m21:48:19.528400 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:48:19.529187 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."mart_station_summary__dbt_backup"
[0m21:48:19.529541 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m21:48:19.529644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.529761 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m21:48:19.530782 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:48:19.531350 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m21:48:19.532605 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:48:19.532291 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."mart_top_polluted_stations__dbt_backup"
[0m21:48:19.532474 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
drop table if exists "data_project_1"."public"."mart_station_summary__dbt_backup" cascade
[0m21:48:19.531447 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:48:19.532712 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m21:48:19.532951 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:48:19.533918 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."mart_monthly_promedio__dbt_backup"
[0m21:48:19.534147 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:48:19.534281 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
drop table if exists "data_project_1"."public"."mart_top_polluted_stations__dbt_backup" cascade
[0m21:48:19.534391 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:48:19.536111 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."mart_daily_promedio__dbt_backup"
[0m21:48:19.535146 [debug] [Thread-4 (]: On model.data_project_1.mart_station_summary: Close
[0m21:48:19.534677 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:48:19.536230 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:48:19.536451 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:48:19.536754 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87795a90>]}
[0m21:48:19.536922 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
drop table if exists "data_project_1"."public"."mart_monthly_promedio__dbt_backup" cascade
[0m21:48:19.537460 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: Close
[0m21:48:19.537636 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
drop table if exists "data_project_1"."public"."mart_daily_promedio__dbt_backup" cascade
[0m21:48:19.537927 [info ] [Thread-4 (]: 15 of 22 OK created sql table model public.mart_station_summary ................ [[32mSELECT 34[0m in 0.08s]
[0m21:48:19.538277 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff873e86d0>]}
[0m21:48:19.538591 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_station_summary
[0m21:48:19.538883 [info ] [Thread-2 (]: 18 of 22 OK created sql table model public.mart_top_polluted_stations .......... [[32mSELECT 56[0m in 0.08s]
[0m21:48:19.539110 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:48:19.539313 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_weekly_extended
[0m21:48:19.539444 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:48:19.539670 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_top_polluted_stations
[0m21:48:19.540109 [debug] [Thread-3 (]: On model.data_project_1.mart_monthly_promedio: Close
[0m21:48:19.540328 [info ] [Thread-4 (]: 19 of 22 START sql table model public.mart_weekly_extended ..................... [RUN]
[0m21:48:19.540799 [debug] [Thread-1 (]: On model.data_project_1.mart_daily_promedio: Close
[0m21:48:19.540986 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_alerts
[0m21:48:19.541235 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd6ad90>]}
[0m21:48:19.541408 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_station_summary, now model.data_project_1.mart_weekly_extended)
[0m21:48:19.541641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cde3bd0>]}
[0m21:48:19.541837 [info ] [Thread-2 (]: 20 of 22 START sql table model public.mart_alerts .............................. [RUN]
[0m21:48:19.542114 [info ] [Thread-3 (]: 16 of 22 OK created sql table model public.mart_monthly_promedio ............... [[32mSELECT 34[0m in 0.09s]
[0m21:48:19.542380 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_weekly_extended
[0m21:48:19.542625 [info ] [Thread-1 (]: 17 of 22 OK created sql table model public.mart_daily_promedio ................. [[32mSELECT 102[0m in 0.08s]
[0m21:48:19.542832 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_top_polluted_stations, now model.data_project_1.mart_alerts)
[0m21:48:19.543049 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_monthly_promedio
[0m21:48:19.544344 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_weekly_extended"
[0m21:48:19.544560 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_daily_promedio
[0m21:48:19.544725 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_alerts
[0m21:48:19.544894 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_hourly
[0m21:48:19.546154 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_alerts"
[0m21:48:19.546398 [info ] [Thread-3 (]: 21 of 22 START sql table model public.mart_hourly .............................. [RUN]
[0m21:48:19.546583 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_weekly_extended
[0m21:48:19.546853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_monthly_promedio, now model.data_project_1.mart_hourly)
[0m21:48:19.548119 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_weekly_extended"
[0m21:48:19.548252 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_alerts
[0m21:48:19.548378 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_hourly
[0m21:48:19.551646 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_hourly"
[0m21:48:19.550551 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_alerts"
[0m21:48:19.551783 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:48:19.552118 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: BEGIN
[0m21:48:19.552287 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_hourly
[0m21:48:19.552393 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:48:19.552524 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:48:19.553694 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_hourly"
[0m21:48:19.554034 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: BEGIN
[0m21:48:19.554379 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:48:19.554791 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:48:19.554976 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: BEGIN
[0m21:48:19.555134 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:48:19.557361 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m21:48:19.557609 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:48:19.558296 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */

  
    

  create  table "data_project_1"."public"."mart_weekly_extended__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."public"."int_daily_avg"
),

weekly_data as (
    select
        city,
        nombre_estacion,
        date_trunc('week', fecha_day) as fecha_week,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg
    from daily_data
    group by city, nombre_estacion, date_trunc('week', fecha_day)
)

select
    *,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2
from weekly_data
order by fecha_week, city, nombre_estacion
  );
  
[0m21:48:19.558497 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m21:48:19.558707 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:48:19.558855 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */

  
    

  create  table "data_project_1"."public"."mart_alerts__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select *
    from "data_project_1"."public"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    case 
        when no2_avg > 200 then 'Alerta NO2'
        when o3_avg > 180 then 'Alerta O3'
        when pm10_avg > 150 then 'Alerta PM10'
        when pm25_avg > 75 then 'Alerta PM2.5'
        else null
    end as alerta
from hourly_data
where no2_avg > 200
   or o3_avg > 180
   or pm10_avg > 150
   or pm25_avg > 75
order by fecha_hour, city, nombre_estacion
  );
  
[0m21:48:19.560108 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m21:48:19.560296 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:48:19.560449 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */

  
    

  create  table "data_project_1"."public"."mart_hourly__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select * 
    from "data_project_1"."public"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Ãndice de contaminaciÃ³n por hora
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n de NO2 por niveles
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por hora dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_hour order by pm25_avg desc) as ranking_pm25
from hourly_data
order by fecha_hour, city, nombre_estacion
  );
  
[0m21:48:19.561751 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.003 seconds
[0m21:48:19.561875 [debug] [Thread-4 (]: SQL status: SELECT 34 in 0.003 seconds
[0m21:48:19.563361 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:48:19.564527 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:48:19.564975 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."public"."mart_weekly_extended" rename to "mart_weekly_extended__dbt_backup"
[0m21:48:19.564801 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."public"."mart_alerts" rename to "mart_alerts__dbt_backup"
[0m21:48:19.564655 [debug] [Thread-3 (]: SQL status: SELECT 306 in 0.004 seconds
[0m21:48:19.565265 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.566405 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:48:19.566516 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:48:19.567506 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:48:19.568765 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."public"."mart_weekly_extended__dbt_tmp" rename to "mart_weekly_extended"
[0m21:48:19.568596 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:48:19.567656 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."public"."mart_hourly" rename to "mart_hourly__dbt_backup"
[0m21:48:19.568963 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."public"."mart_alerts__dbt_tmp" rename to "mart_alerts"
[0m21:48:19.569072 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.569816 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m21:48:19.569412 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.569304 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.569950 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:48:19.570419 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: COMMIT
[0m21:48:19.571356 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:48:19.571785 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."public"."mart_hourly__dbt_tmp" rename to "mart_hourly"
[0m21:48:19.571649 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:48:19.571496 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m21:48:19.571994 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: COMMIT
[0m21:48:19.572112 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.572777 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: COMMIT
[0m21:48:19.572880 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:48:19.572979 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m21:48:19.573096 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:48:19.573895 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."mart_alerts__dbt_backup"
[0m21:48:19.575471 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."mart_weekly_extended__dbt_backup"
[0m21:48:19.576087 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:48:19.575855 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:48:19.575604 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: COMMIT
[0m21:48:19.576228 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
drop table if exists "data_project_1"."public"."mart_weekly_extended__dbt_backup" cascade
[0m21:48:19.576392 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
drop table if exists "data_project_1"."public"."mart_alerts__dbt_backup" cascade
[0m21:48:19.576721 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m21:48:19.577681 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."mart_hourly__dbt_backup"
[0m21:48:19.578132 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:48:19.577900 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:48:19.577800 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:48:19.578277 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
drop table if exists "data_project_1"."public"."mart_hourly__dbt_backup" cascade
[0m21:48:19.578734 [debug] [Thread-2 (]: On model.data_project_1.mart_alerts: Close
[0m21:48:19.579193 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: Close
[0m21:48:19.579562 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b4c710>]}
[0m21:48:19.579770 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8736acd0>]}
[0m21:48:19.580079 [info ] [Thread-2 (]: 20 of 22 OK created sql table model public.mart_alerts ......................... [[32mSELECT 0[0m in 0.04s]
[0m21:48:19.580234 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:48:19.580471 [info ] [Thread-4 (]: 19 of 22 OK created sql table model public.mart_weekly_extended ................ [[32mSELECT 34[0m in 0.04s]
[0m21:48:19.580727 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_alerts
[0m21:48:19.581156 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: Close
[0m21:48:19.581665 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b4dd90>]}
[0m21:48:19.581877 [info ] [Thread-3 (]: 21 of 22 OK created sql table model public.mart_hourly ......................... [[32mSELECT 306[0m in 0.03s]
[0m21:48:19.582095 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_hourly
[0m21:48:19.581349 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_weekly_extended
[0m21:48:19.582570 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_fact_air_quality
[0m21:48:19.582768 [info ] [Thread-1 (]: 22 of 22 START sql table model public.mart_fact_air_quality .................... [RUN]
[0m21:48:19.582956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_daily_promedio, now model.data_project_1.mart_fact_air_quality)
[0m21:48:19.583112 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_fact_air_quality
[0m21:48:19.584525 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_fact_air_quality"
[0m21:48:19.584979 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_fact_air_quality
[0m21:48:19.586260 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_fact_air_quality"
[0m21:48:19.586662 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:48:19.586790 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: BEGIN
[0m21:48:19.586911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:19.589980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m21:48:19.590114 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:48:19.590258 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */

  
    

  create  table "data_project_1"."public"."mart_fact_air_quality__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * from "data_project_1"."public"."int_daily_avg"
),
weekly_data as (
    select * from "data_project_1"."public"."mart_weekly_extended"
),
monthly_data as (
    select * from "data_project_1"."public"."int_monthly_avg"
)

select
    coalesce(d.city, w.city, m.city) as city,
    coalesce(d.nombre_estacion, w.nombre_estacion, m.nombre_estacion) as nombre_estacion,
    d.fecha_day,
    w.fecha_week,
    m.fecha_month,
    d.no2_avg as daily_no2,
    d.o3_avg as daily_o3,
    d.pm10_avg as daily_pm10,
    d.pm25_avg as daily_pm25,
    w.no2_avg as weekly_no2,
    w.o3_avg as weekly_o3,
    w.pm10_avg as weekly_pm10,
    w.pm25_avg as weekly_pm25,
    m.no2_avg as monthly_no2,
    m.o3_avg as monthly_o3,
    m.pm10_avg as monthly_pm10,
    m.pm25_avg as monthly_pm25
from daily_data d
full outer join weekly_data w
    on d.city = w.city
    and d.nombre_estacion = w.nombre_estacion
    and date_trunc('week', d.fecha_day) = w.fecha_week
full outer join monthly_data m
    on coalesce(d.city, w.city) = m.city
    and coalesce(d.nombre_estacion, w.nombre_estacion) = m.nombre_estacion
    and date_trunc('month', d.fecha_day) = m.fecha_month
order by city, nombre_estacion, d.fecha_day
  );
  
[0m21:48:19.593392 [debug] [Thread-1 (]: SQL status: SELECT 102 in 0.003 seconds
[0m21:48:19.594682 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:48:19.594816 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."public"."mart_fact_air_quality" rename to "mart_fact_air_quality__dbt_backup"
[0m21:48:19.595079 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.596045 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:48:19.596223 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."public"."mart_fact_air_quality__dbt_tmp" rename to "mart_fact_air_quality"
[0m21:48:19.596577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:48:19.597111 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m21:48:19.597300 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:48:19.597425 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m21:48:19.597897 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:48:19.598712 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."mart_fact_air_quality__dbt_backup"
[0m21:48:19.598930 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:48:19.599043 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
drop table if exists "data_project_1"."public"."mart_fact_air_quality__dbt_backup" cascade
[0m21:48:19.599921 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:48:19.600365 [debug] [Thread-1 (]: On model.data_project_1.mart_fact_air_quality: Close
[0m21:48:19.600662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30976036-c2c8-4c00-bcb1-edc0ab11256f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b604d0>]}
[0m21:48:19.600932 [info ] [Thread-1 (]: 22 of 22 OK created sql table model public.mart_fact_air_quality ............... [[32mSELECT 102[0m in 0.02s]
[0m21:48:19.601156 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_fact_air_quality
[0m21:48:19.601941 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:19.602086 [debug] [MainThread]: On master: BEGIN
[0m21:48:19.602225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:48:19.605231 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:48:19.605348 [debug] [MainThread]: On master: COMMIT
[0m21:48:19.605450 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:19.605569 [debug] [MainThread]: On master: COMMIT
[0m21:48:19.605715 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:48:19.605814 [debug] [MainThread]: On master: Close
[0m21:48:19.605950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:19.606060 [debug] [MainThread]: Connection 'model.data_project_1.mart_alerts' was properly closed.
[0m21:48:19.606179 [debug] [MainThread]: Connection 'model.data_project_1.mart_fact_air_quality' was properly closed.
[0m21:48:19.606290 [debug] [MainThread]: Connection 'model.data_project_1.mart_hourly' was properly closed.
[0m21:48:19.606386 [debug] [MainThread]: Connection 'model.data_project_1.mart_weekly_extended' was properly closed.
[0m21:48:19.606561 [info ] [MainThread]: 
[0m21:48:19.606694 [info ] [MainThread]: Finished running 8 table models, 8 data tests, 6 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m21:48:19.607716 [debug] [MainThread]: Command end result
[0m21:48:19.621275 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m21:48:19.622081 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m21:48:19.624739 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m21:48:19.624877 [info ] [MainThread]: 
[0m21:48:19.625049 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:48:19.625190 [info ] [MainThread]: 
[0m21:48:19.625403 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=22
[0m21:48:19.625876 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8052094, "process_in_blocks": "2400", "process_kernel_time": 0.11144, "process_mem_max_rss": "134644", "process_out_blocks": "3490", "process_user_time": 1.207774}
[0m21:48:19.626080 [debug] [MainThread]: Command `dbt build` succeeded at 21:48:19.626046 after 0.81 seconds
[0m21:48:19.626248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2901d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e2937d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9343f850>]}
[0m21:48:19.626434 [debug] [MainThread]: Flushing usage events
[0m21:48:20.302321 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:43.817835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94992550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94896350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94993b10>]}


============================== 21:51:43.822119 | 6c3802b5-daed-422d-b1bb-418f167a6598 ==============================
[0m21:51:43.822119 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:51:43.822750 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/app/dbt', 'invocation_command': 'dbt deps', 'partial_parse': 'True', 'static_parser': 'True', 'version_check': 'True', 'empty': 'None', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None'}
[0m21:51:43.932788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c3802b5-daed-422d-b1bb-418f167a6598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9497c0d0>]}
[0m21:51:43.938963 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:51:43.941310 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:51:43.942546 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15801996, "process_in_blocks": "0", "process_kernel_time": 0.081267, "process_mem_max_rss": "104980", "process_out_blocks": "3", "process_user_time": 0.715355}
[0m21:51:43.943391 [debug] [MainThread]: Command `dbt deps` succeeded at 21:51:43.943197 after 0.16 seconds
[0m21:51:43.944002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff949897d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94990b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94993490>]}
[0m21:51:43.944613 [debug] [MainThread]: Flushing usage events
[0m21:51:44.669469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:45.409603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c8b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82dac5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82e67a10>]}


============================== 21:51:45.412385 | 7103c3dd-eb56-4164-bab8-bfa14b71b30c ==============================
[0m21:51:45.412385 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:51:45.412657 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'printer_width': '80', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/usr/app/dbt', 'partial_parse': 'True', 'static_parser': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'no_print': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'log_path': '/usr/app/dbt/logs', 'invocation_command': 'dbt build --target dev', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m21:51:45.466249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ff7450>]}
[0m21:51:45.486915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c9dfd0>]}
[0m21:51:45.487312 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:51:45.511440 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m21:51:45.560125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:51:45.560366 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:51:45.578956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81dc5510>]}
[0m21:51:45.617028 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m21:51:45.618160 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m21:51:45.669651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a7b710>]}
[0m21:51:45.669938 [info ] [MainThread]: Found 14 models, 8 data tests, 1 source, 459 macros
[0m21:51:45.671399 [info ] [MainThread]: 
[0m21:51:45.671588 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:51:45.671758 [info ] [MainThread]: 
[0m21:51:45.672093 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:51:45.673976 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1'
[0m21:51:45.687614 [debug] [ThreadPool]: Using postgres connection "list_data_project_1"
[0m21:51:45.687827 [debug] [ThreadPool]: On list_data_project_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1"} */

    select distinct nspname from pg_namespace
  
[0m21:51:45.687940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:45.692646 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m21:51:45.693103 [debug] [ThreadPool]: On list_data_project_1: Close
[0m21:51:45.693982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1_public'
[0m21:51:45.696220 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_public"
[0m21:51:45.696388 [debug] [ThreadPool]: On list_data_project_1_public: BEGIN
[0m21:51:45.696515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:45.699362 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:51:45.699533 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_public"
[0m21:51:45.699673 [debug] [ThreadPool]: On list_data_project_1_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1_public"} */
select
      'data_project_1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'data_project_1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'data_project_1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:51:45.701286 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.001 seconds
[0m21:51:45.701855 [debug] [ThreadPool]: On list_data_project_1_public: ROLLBACK
[0m21:51:45.702050 [debug] [ThreadPool]: On list_data_project_1_public: Close
[0m21:51:45.704586 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:45.704738 [debug] [MainThread]: On master: BEGIN
[0m21:51:45.704868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:45.707712 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:51:45.707851 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:45.708002 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:51:45.709967 [debug] [MainThread]: SQL status: SELECT 20 in 0.002 seconds
[0m21:51:45.711246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82020050>]}
[0m21:51:45.711580 [debug] [MainThread]: On master: ROLLBACK
[0m21:51:45.711870 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:45.712178 [debug] [MainThread]: On master: BEGIN
[0m21:51:45.712831 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:51:45.713040 [debug] [MainThread]: On master: COMMIT
[0m21:51:45.713240 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:45.713441 [debug] [MainThread]: On master: COMMIT
[0m21:51:45.713813 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:51:45.713963 [debug] [MainThread]: On master: Close
[0m21:51:45.716601 [debug] [Thread-1 (]: Began running node model.data_project_1.stg_mediciones_madrid
[0m21:51:45.716885 [debug] [Thread-2 (]: Began running node model.data_project_1.stg_mediciones_valencia
[0m21:51:45.717348 [info ] [Thread-1 (]: 1 of 22 START sql view model public.stg_mediciones_madrid ...................... [RUN]
[0m21:51:45.717812 [info ] [Thread-2 (]: 2 of 22 START sql view model public.stg_mediciones_valencia .................... [RUN]
[0m21:51:45.718601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_project_1_public, now model.data_project_1.stg_mediciones_madrid)
[0m21:51:45.719014 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_data_project_1, now model.data_project_1.stg_mediciones_valencia)
[0m21:51:45.720013 [debug] [Thread-1 (]: Began compiling node model.data_project_1.stg_mediciones_madrid
[0m21:51:45.720412 [debug] [Thread-2 (]: Began compiling node model.data_project_1.stg_mediciones_valencia
[0m21:51:45.724015 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_madrid"
[0m21:51:45.725696 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_valencia"
[0m21:51:45.726802 [debug] [Thread-2 (]: Began executing node model.data_project_1.stg_mediciones_valencia
[0m21:51:45.727009 [debug] [Thread-1 (]: Began executing node model.data_project_1.stg_mediciones_madrid
[0m21:51:45.741900 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_valencia"
[0m21:51:45.743655 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_madrid"
[0m21:51:45.744692 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:51:45.745032 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: BEGIN
[0m21:51:45.745206 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:51:45.744926 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:51:45.745549 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: BEGIN
[0m21:51:45.745821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:45.749964 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:45.750303 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:51:45.750452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:45.750796 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:51:45.750959 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */

  create view "data_project_1"."public"."stg_mediciones_madrid__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'madrid' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='madrid'
  );
[0m21:51:45.750609 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */

  create view "data_project_1"."public"."stg_mediciones_valencia__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'valencia' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='valencia'
  );
[0m21:51:45.752414 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m21:51:45.752535 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m21:51:45.755436 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:51:45.756981 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."public"."stg_mediciones_valencia" rename to "stg_mediciones_valencia__dbt_backup"
[0m21:51:45.756780 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:51:45.757408 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."public"."stg_mediciones_madrid" rename to "stg_mediciones_madrid__dbt_backup"
[0m21:51:45.757584 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:45.758780 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:51:45.759045 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."public"."stg_mediciones_valencia__dbt_tmp" rename to "stg_mediciones_valencia"
[0m21:51:45.758876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:51:45.760315 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:51:45.760576 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."public"."stg_mediciones_madrid__dbt_tmp" rename to "stg_mediciones_madrid"
[0m21:51:45.760440 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:51:45.766550 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m21:51:45.766866 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:51:45.767036 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m21:51:45.766702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m21:51:45.767690 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m21:51:45.767971 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:51:45.768140 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m21:51:45.767848 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:51:45.770756 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."stg_mediciones_valencia__dbt_backup"
[0m21:51:45.770894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m21:51:45.773542 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."stg_mediciones_madrid__dbt_backup"
[0m21:51:45.772586 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:51:45.774618 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
drop view if exists "data_project_1"."public"."stg_mediciones_valencia__dbt_backup" cascade
[0m21:51:45.774464 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:51:45.774855 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
drop view if exists "data_project_1"."public"."stg_mediciones_madrid__dbt_backup" cascade
[0m21:51:45.776797 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:51:45.777845 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: Close
[0m21:51:45.777964 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:51:45.779232 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: Close
[0m21:51:45.779458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c33b90>]}
[0m21:51:45.779744 [info ] [Thread-1 (]: 1 of 22 OK created sql view model public.stg_mediciones_madrid ................. [[32mCREATE VIEW[0m in 0.06s]
[0m21:51:45.780113 [debug] [Thread-1 (]: Finished running node model.data_project_1.stg_mediciones_madrid
[0m21:51:45.778718 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d87250>]}
[0m21:51:45.780567 [info ] [Thread-2 (]: 2 of 22 OK created sql view model public.stg_mediciones_valencia ............... [[32mCREATE VIEW[0m in 0.06s]
[0m21:51:45.780746 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:51:45.780872 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:51:45.781542 [info ] [Thread-3 (]: 4 of 22 START test not_null_stg_mediciones_madrid_id ........................... [RUN]
[0m21:51:45.781778 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515'
[0m21:51:45.781347 [info ] [Thread-4 (]: 3 of 22 START test not_null_stg_mediciones_madrid_fecha_carg ................... [RUN]
[0m21:51:45.780979 [debug] [Thread-1 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:51:45.782293 [info ] [Thread-1 (]: 5 of 22 START test not_null_stg_mediciones_madrid_nombre_estacion .............. [RUN]
[0m21:51:45.781917 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:51:45.782135 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf'
[0m21:51:45.781157 [debug] [Thread-2 (]: Finished running node model.data_project_1.stg_mediciones_valencia
[0m21:51:45.782506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_madrid, now test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2)
[0m21:51:45.787084 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:51:45.787336 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:51:45.787519 [debug] [Thread-2 (]: Began running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:51:45.789848 [info ] [Thread-2 (]: 6 of 22 START test unique_stg_mediciones_madrid_id ............................. [RUN]
[0m21:51:45.789557 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:51:45.787789 [debug] [Thread-1 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:51:45.790163 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_valencia, now test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c)
[0m21:51:45.790363 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:51:45.791994 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:51:45.792290 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:51:45.792409 [debug] [Thread-2 (]: Began compiling node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:51:45.798931 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:51:45.800029 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:51:45.800304 [debug] [Thread-1 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:51:45.802469 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:51:45.803690 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:51:45.804079 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:51:45.804208 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:51:45.804496 [debug] [Thread-2 (]: Began executing node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:51:45.804652 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: BEGIN
[0m21:51:45.804844 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:51:45.804953 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: BEGIN
[0m21:51:45.806301 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:51:45.805984 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:51:45.806156 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: BEGIN
[0m21:51:45.805839 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:51:45.806796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:45.810024 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:51:45.810512 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: BEGIN
[0m21:51:45.810746 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:51:45.810881 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:45.811235 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:51:45.811406 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:45.811535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:45.811725 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."public"."stg_mediciones_madrid"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m21:51:45.811928 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:51:45.812124 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:51:45.813901 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."public"."stg_mediciones_madrid"
where id is null



  
  
      
    ) dbt_internal_test
[0m21:51:45.814235 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."public"."stg_mediciones_madrid"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m21:51:45.814594 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:51:45.814730 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m21:51:45.817089 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:51:45.816799 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:51:45.816932 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:51:45.816637 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: ROLLBACK
[0m21:51:45.817236 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."public"."stg_mediciones_madrid"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:51:45.817817 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: ROLLBACK
[0m21:51:45.818364 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: ROLLBACK
[0m21:51:45.818596 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: Close
[0m21:51:45.818870 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: Close
[0m21:51:45.819247 [info ] [Thread-4 (]: 3 of 22 PASS not_null_stg_mediciones_madrid_fecha_carg ......................... [[32mPASS[0m in 0.04s]
[0m21:51:45.819425 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: Close
[0m21:51:45.819585 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:51:45.819788 [info ] [Thread-3 (]: 4 of 22 PASS not_null_stg_mediciones_madrid_id ................................. [[32mPASS[0m in 0.04s]
[0m21:51:45.820147 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:51:45.820455 [info ] [Thread-1 (]: 5 of 22 PASS not_null_stg_mediciones_madrid_nombre_estacion .................... [[32mPASS[0m in 0.04s]
[0m21:51:45.821077 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: ROLLBACK
[0m21:51:45.821379 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:51:45.821598 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:51:45.821904 [debug] [Thread-1 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:51:45.822197 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: Close
[0m21:51:45.822409 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:51:45.822645 [info ] [Thread-4 (]: 7 of 22 START test not_null_stg_mediciones_valencia_fecha_carg ................. [RUN]
[0m21:51:45.822905 [debug] [Thread-1 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:51:45.823224 [info ] [Thread-2 (]: 6 of 22 PASS unique_stg_mediciones_madrid_id ................................... [[32mPASS[0m in 0.03s]
[0m21:51:45.823410 [info ] [Thread-3 (]: 8 of 22 START test not_null_stg_mediciones_valencia_id ......................... [RUN]
[0m21:51:45.823635 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf, now test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e)
[0m21:51:45.823835 [info ] [Thread-1 (]: 9 of 22 START test not_null_stg_mediciones_valencia_nombre_estacion ............ [RUN]
[0m21:51:45.824099 [debug] [Thread-2 (]: Finished running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:51:45.824325 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515, now test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e)
[0m21:51:45.824549 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:51:45.824786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2, now test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046)
[0m21:51:45.824993 [debug] [Thread-2 (]: Began running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:51:45.825197 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:51:45.827014 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:51:45.827252 [debug] [Thread-1 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:51:45.827451 [info ] [Thread-2 (]: 10 of 22 START test unique_stg_mediciones_valencia_id .......................... [RUN]
[0m21:51:45.829815 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:51:45.831441 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:51:45.831705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c, now test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170)
[0m21:51:45.831819 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:51:45.832291 [debug] [Thread-2 (]: Began compiling node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:51:45.832474 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:51:45.832626 [debug] [Thread-1 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:51:45.833531 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:51:45.834993 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:51:45.835869 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:51:45.836743 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:51:45.837263 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:51:45.837559 [debug] [Thread-2 (]: Began executing node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:51:45.837681 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: BEGIN
[0m21:51:45.837866 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:51:45.838672 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:51:45.838792 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:51:45.839400 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: BEGIN
[0m21:51:45.839095 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: BEGIN
[0m21:51:45.838945 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:51:45.839583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:45.839699 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:51:45.839837 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:51:45.840423 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: BEGIN
[0m21:51:45.840828 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:51:45.844400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:45.844534 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m21:51:45.844725 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:45.844883 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:51:45.845131 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:51:45.845332 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:51:45.845526 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."public"."stg_mediciones_valencia"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m21:51:45.845663 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:45.845817 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."public"."stg_mediciones_valencia"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m21:51:45.845981 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."public"."stg_mediciones_valencia"
where id is null



  
  
      
    ) dbt_internal_test
[0m21:51:45.846219 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:51:45.846534 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."public"."stg_mediciones_valencia"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:51:45.846897 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:51:45.847033 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:51:45.847161 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:51:45.847772 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: ROLLBACK
[0m21:51:45.847909 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:51:45.849456 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: ROLLBACK
[0m21:51:45.848909 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: ROLLBACK
[0m21:51:45.848392 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: ROLLBACK
[0m21:51:45.849574 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: Close
[0m21:51:45.849757 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: Close
[0m21:51:45.849935 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: Close
[0m21:51:45.850097 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: Close
[0m21:51:45.850355 [info ] [Thread-1 (]: 9 of 22 PASS not_null_stg_mediciones_valencia_nombre_estacion .................. [[32mPASS[0m in 0.03s]
[0m21:51:45.850563 [info ] [Thread-2 (]: 10 of 22 PASS unique_stg_mediciones_valencia_id ................................ [[32mPASS[0m in 0.02s]
[0m21:51:45.850911 [info ] [Thread-4 (]: 7 of 22 PASS not_null_stg_mediciones_valencia_fecha_carg ....................... [[32mPASS[0m in 0.03s]
[0m21:51:45.851248 [info ] [Thread-3 (]: 8 of 22 PASS not_null_stg_mediciones_valencia_id ............................... [[32mPASS[0m in 0.03s]
[0m21:51:45.851525 [debug] [Thread-1 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:51:45.851731 [debug] [Thread-2 (]: Finished running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:51:45.851974 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:51:45.852191 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:51:45.853072 [debug] [Thread-1 (]: Began running node model.data_project_1.int_daily_avg
[0m21:51:45.853209 [debug] [Thread-2 (]: Began running node model.data_project_1.int_hourly_avg
[0m21:51:45.853338 [debug] [Thread-4 (]: Began running node model.data_project_1.int_monthly_avg
[0m21:51:45.853484 [debug] [Thread-3 (]: Began running node model.data_project_1.int_station_summary
[0m21:51:45.853654 [info ] [Thread-1 (]: 11 of 22 START sql view model public.int_daily_avg ............................. [RUN]
[0m21:51:45.853909 [info ] [Thread-2 (]: 12 of 22 START sql view model public.int_hourly_avg ............................ [RUN]
[0m21:51:45.854187 [info ] [Thread-4 (]: 13 of 22 START sql view model public.int_monthly_avg ........................... [RUN]
[0m21:51:45.854411 [info ] [Thread-3 (]: 14 of 22 START sql view model public.int_station_summary ....................... [RUN]
[0m21:51:45.854636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046, now model.data_project_1.int_daily_avg)
[0m21:51:45.854827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170, now model.data_project_1.int_hourly_avg)
[0m21:51:45.855039 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e, now model.data_project_1.int_monthly_avg)
[0m21:51:45.855257 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e, now model.data_project_1.int_station_summary)
[0m21:51:45.855442 [debug] [Thread-1 (]: Began compiling node model.data_project_1.int_daily_avg
[0m21:51:45.855602 [debug] [Thread-2 (]: Began compiling node model.data_project_1.int_hourly_avg
[0m21:51:45.855811 [debug] [Thread-4 (]: Began compiling node model.data_project_1.int_monthly_avg
[0m21:51:45.855966 [debug] [Thread-3 (]: Began compiling node model.data_project_1.int_station_summary
[0m21:51:45.857345 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.int_daily_avg"
[0m21:51:45.858430 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.int_hourly_avg"
[0m21:51:45.859668 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.int_monthly_avg"
[0m21:51:45.860714 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.int_station_summary"
[0m21:51:45.861718 [debug] [Thread-2 (]: Began executing node model.data_project_1.int_hourly_avg
[0m21:51:45.861900 [debug] [Thread-1 (]: Began executing node model.data_project_1.int_daily_avg
[0m21:51:45.863983 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.int_hourly_avg"
[0m21:51:45.864122 [debug] [Thread-4 (]: Began executing node model.data_project_1.int_monthly_avg
[0m21:51:45.864271 [debug] [Thread-3 (]: Began executing node model.data_project_1.int_station_summary
[0m21:51:45.865409 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.int_daily_avg"
[0m21:51:45.866721 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.int_monthly_avg"
[0m21:51:45.867983 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.int_station_summary"
[0m21:51:45.868141 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:51:45.868817 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: BEGIN
[0m21:51:45.868729 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:51:45.868581 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:51:45.868950 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:51:45.869043 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:51:45.869633 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: BEGIN
[0m21:51:45.869329 [debug] [Thread-1 (]: On model.data_project_1.int_daily_avg: BEGIN
[0m21:51:45.869186 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: BEGIN
[0m21:51:45.869896 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:51:45.870091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:45.870309 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:51:45.873298 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m21:51:45.874297 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:51:45.874709 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */

  create view "data_project_1"."public"."int_hourly_avg__dbt_tmp"
    
    
  as (
    with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    avg(no2) as no2_avg,
    avg(o3) as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by 1,2,3
order by fecha_hour, city, nombre_estacion
  );
[0m21:51:45.874904 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:45.875414 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:51:45.875314 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:45.875204 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:45.875850 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:51:45.875720 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:51:45.875558 [debug] [Thread-1 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */

  create view "data_project_1"."public"."int_daily_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m21:51:45.875993 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */

  create view "data_project_1"."public"."int_station_summary__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m21:51:45.876210 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */

  create view "data_project_1"."public"."int_monthly_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_month,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_month
order by city, nombre_estacion, fecha_month
  );
[0m21:51:45.876689 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:51:45.878241 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:51:45.878384 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:51:45.878506 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:51:45.878636 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:51:45.878740 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
alter table "data_project_1"."public"."int_hourly_avg__dbt_tmp" rename to "int_hourly_avg"
[0m21:51:45.879804 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:51:45.880833 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:51:45.881860 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:51:45.882589 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
alter table "data_project_1"."public"."int_station_summary__dbt_tmp" rename to "int_station_summary"
[0m21:51:45.882275 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:45.882428 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
alter table "data_project_1"."public"."int_monthly_avg__dbt_tmp" rename to "int_monthly_avg"
[0m21:51:45.882118 [debug] [Thread-1 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
alter table "data_project_1"."public"."int_daily_avg__dbt_tmp" rename to "int_daily_avg"
[0m21:51:45.883137 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:45.883836 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m21:51:45.884814 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: COMMIT
[0m21:51:45.885675 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:51:45.885309 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:51:45.885485 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:51:45.885146 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:51:45.885918 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: COMMIT
[0m21:51:45.886727 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m21:51:45.887364 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m21:51:45.888531 [debug] [Thread-1 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m21:51:45.889125 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:51:45.889961 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:51:45.890433 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:51:45.891047 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:51:45.891790 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m21:51:45.895614 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."int_station_summary__dbt_backup"
[0m21:51:45.896500 [debug] [Thread-1 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m21:51:45.900661 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."int_hourly_avg__dbt_backup"
[0m21:51:45.903782 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:51:45.904590 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m21:51:45.914141 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m21:51:45.914969 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:51:45.937423 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
drop view if exists "data_project_1"."public"."int_hourly_avg__dbt_backup" cascade
[0m21:51:45.924306 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."int_monthly_avg__dbt_backup"
[0m21:51:45.934732 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."int_daily_avg__dbt_backup"
[0m21:51:45.917945 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
drop view if exists "data_project_1"."public"."int_station_summary__dbt_backup" cascade
[0m21:51:45.941766 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:51:45.946945 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:51:45.951113 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:51:45.972276 [debug] [Thread-1 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
drop view if exists "data_project_1"."public"."int_daily_avg__dbt_backup" cascade
[0m21:51:45.961321 [debug] [Thread-2 (]: On model.data_project_1.int_hourly_avg: Close
[0m21:51:45.979643 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b5fc50>]}
[0m21:51:45.955382 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:51:45.976888 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:51:45.968780 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
drop view if exists "data_project_1"."public"."int_monthly_avg__dbt_backup" cascade
[0m21:51:45.982406 [info ] [Thread-2 (]: 12 of 22 OK created sql view model public.int_hourly_avg ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m21:51:45.988026 [debug] [Thread-3 (]: On model.data_project_1.int_station_summary: Close
[0m21:51:46.002027 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b63cd0>]}
[0m21:51:45.996185 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:51:45.999251 [debug] [Thread-2 (]: Finished running node model.data_project_1.int_hourly_avg
[0m21:51:45.991374 [debug] [Thread-1 (]: On model.data_project_1.int_daily_avg: Close
[0m21:51:46.004713 [info ] [Thread-3 (]: 14 of 22 OK created sql view model public.int_station_summary .................. [[32mCREATE VIEW[0m in 0.15s]
[0m21:51:46.007202 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: Close
[0m21:51:46.008620 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_station_summary
[0m21:51:46.010633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b7e310>]}
[0m21:51:46.015744 [info ] [Thread-1 (]: 11 of 22 OK created sql view model public.int_daily_avg ........................ [[32mCREATE VIEW[0m in 0.16s]
[0m21:51:46.013258 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b7c450>]}
[0m21:51:46.015039 [info ] [Thread-2 (]: 15 of 22 START sql table model public.mart_station_summary ..................... [RUN]
[0m21:51:46.012238 [debug] [Thread-3 (]: Finished running node model.data_project_1.int_station_summary
[0m21:51:46.016145 [debug] [Thread-1 (]: Finished running node model.data_project_1.int_daily_avg
[0m21:51:46.016556 [info ] [Thread-4 (]: 13 of 22 OK created sql view model public.int_monthly_avg ...................... [[32mCREATE VIEW[0m in 0.16s]
[0m21:51:46.017008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_hourly_avg, now model.data_project_1.mart_station_summary)
[0m21:51:46.017322 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_alerts
[0m21:51:46.018770 [info ] [Thread-3 (]: 16 of 22 START sql table model public.mart_alerts .............................. [RUN]
[0m21:51:46.018172 [debug] [Thread-4 (]: Finished running node model.data_project_1.int_monthly_avg
[0m21:51:46.018450 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_station_summary
[0m21:51:46.017621 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_hourly
[0m21:51:46.022234 [info ] [Thread-1 (]: 17 of 22 START sql table model public.mart_hourly .............................. [RUN]
[0m21:51:46.019452 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_daily_promedio
[0m21:51:46.021864 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_station_summary"
[0m21:51:46.019143 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_station_summary, now model.data_project_1.mart_alerts)
[0m21:51:46.023758 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_alerts
[0m21:51:46.023125 [info ] [Thread-4 (]: 18 of 22 START sql table model public.mart_daily_promedio ...................... [RUN]
[0m21:51:46.022753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_daily_avg, now model.data_project_1.mart_hourly)
[0m21:51:46.025502 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_alerts"
[0m21:51:46.026132 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_monthly_avg, now model.data_project_1.mart_daily_promedio)
[0m21:51:46.026656 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_station_summary
[0m21:51:46.026816 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_hourly
[0m21:51:46.028187 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_daily_promedio
[0m21:51:46.028832 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_alerts
[0m21:51:46.038087 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_station_summary"
[0m21:51:46.039754 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_hourly"
[0m21:51:46.040992 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_daily_promedio"
[0m21:51:46.042425 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_alerts"
[0m21:51:46.043424 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_hourly
[0m21:51:46.043846 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_daily_promedio
[0m21:51:46.043999 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:51:46.046222 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_hourly"
[0m21:51:46.047628 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_daily_promedio"
[0m21:51:46.047927 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:51:46.048087 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: BEGIN
[0m21:51:46.048862 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: BEGIN
[0m21:51:46.050015 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:51:46.049458 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:51:46.049850 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:51:46.049023 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:51:46.050746 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: BEGIN
[0m21:51:46.050945 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: BEGIN
[0m21:51:46.051463 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:51:46.053604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:46.054734 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:46.054945 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:46.055315 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:51:46.057457 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:51:46.057798 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */

  
    

  create  table "data_project_1"."public"."mart_station_summary__dbt_tmp"
  
  
    as
  
  (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
),

daily_avg as (
    select
        city,
        nombre_estacion,
        fecha_day,
        avg(no2)  as no2_avg,
        avg(o3)   as o3_avg,
        avg(pm10) as pm10_avg,
        avg(pm25) as pm25_avg
    from all_data
    group by city, nombre_estacion, fecha_day
),

station_summary as (
    select
        city,
        nombre_estacion,
        min(fecha_day) as first_measurement,
        max(fecha_day) as last_measurement,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg,
        case
            when avg(pm25_avg) > 50 then 'Alto'
            when avg(pm25_avg) > 25 then 'Moderado'
            else 'Bajo'
        end as nivel_pm25
    from daily_avg
    group by city, nombre_estacion
)

select *
from station_summary
order by city, nombre_estacion
  );
  
[0m21:51:46.058125 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */

  
    

  create  table "data_project_1"."public"."mart_alerts__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select *
    from "data_project_1"."public"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    case 
        when no2_avg > 200 then 'Alerta NO2'
        when o3_avg > 180 then 'Alerta O3'
        when pm10_avg > 150 then 'Alerta PM10'
        when pm25_avg > 75 then 'Alerta PM2.5'
        else null
    end as alerta
from hourly_data
where no2_avg > 200
   or o3_avg > 180
   or pm10_avg > 150
   or pm25_avg > 75
order by fecha_hour, city, nombre_estacion
  );
  
[0m21:51:46.058339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:46.058524 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m21:51:46.058748 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:51:46.059069 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:51:46.059600 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */

  
    

  create  table "data_project_1"."public"."mart_hourly__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select * 
    from "data_project_1"."public"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Ãndice de contaminaciÃ³n por hora
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n de NO2 por niveles
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por hora dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_hour order by pm25_avg desc) as ranking_pm25
from hourly_data
order by fecha_hour, city, nombre_estacion
  );
  
[0m21:51:46.059879 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */

  
    

  create  table "data_project_1"."public"."mart_daily_promedio__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * 
    from "data_project_1"."public"."int_daily_avg"
)

select
    city,
    nombre_estacion,
    fecha_day,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Calculamos un Ã­ndice de contaminaciÃ³n promedio
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n del nivel de NO2
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por dÃ­a dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_day order by pm25_avg desc) as ranking_pm25
from daily_data
order by fecha_day, city, nombre_estacion
  );
  
[0m21:51:46.061820 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.003 seconds
[0m21:51:46.062186 [debug] [Thread-2 (]: SQL status: SELECT 34 in 0.004 seconds
[0m21:51:46.065309 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:51:46.065634 [debug] [Thread-4 (]: SQL status: SELECT 102 in 0.005 seconds
[0m21:51:46.065770 [debug] [Thread-1 (]: SQL status: SELECT 306 in 0.005 seconds
[0m21:51:46.067103 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:51:46.067434 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."public"."mart_alerts" rename to "mart_alerts__dbt_backup"
[0m21:51:46.068666 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:51:46.069976 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:51:46.071158 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."public"."mart_hourly" rename to "mart_hourly__dbt_backup"
[0m21:51:46.070866 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."public"."mart_daily_promedio" rename to "mart_daily_promedio__dbt_backup"
[0m21:51:46.070275 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
alter table "data_project_1"."public"."mart_station_summary" rename to "mart_station_summary__dbt_backup"
[0m21:51:46.071306 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:51:46.071772 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:46.071906 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:46.073314 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:51:46.073470 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:51:46.074698 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:51:46.075897 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:51:46.077994 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."public"."mart_daily_promedio__dbt_tmp" rename to "mart_daily_promedio"
[0m21:51:46.077436 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:51:46.077804 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."public"."mart_hourly__dbt_tmp" rename to "mart_hourly"
[0m21:51:46.076102 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."public"."mart_alerts__dbt_tmp" rename to "mart_alerts"
[0m21:51:46.078350 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
alter table "data_project_1"."public"."mart_station_summary__dbt_tmp" rename to "mart_station_summary"
[0m21:51:46.078508 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:46.078919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:46.079071 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:46.079252 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:46.079940 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m21:51:46.080771 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: COMMIT
[0m21:51:46.082657 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: COMMIT
[0m21:51:46.087286 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: COMMIT
[0m21:51:46.088713 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:51:46.089018 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:51:46.089250 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:51:46.089491 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:51:46.089708 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m21:51:46.089928 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: COMMIT
[0m21:51:46.090108 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: COMMIT
[0m21:51:46.090312 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: COMMIT
[0m21:51:46.091096 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m21:51:46.093352 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."mart_daily_promedio__dbt_backup"
[0m21:51:46.091348 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:51:46.091465 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:51:46.091225 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:51:46.094547 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:51:46.095482 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."mart_hourly__dbt_backup"
[0m21:51:46.096408 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."mart_station_summary__dbt_backup"
[0m21:51:46.097297 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."mart_alerts__dbt_backup"
[0m21:51:46.097447 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
drop table if exists "data_project_1"."public"."mart_daily_promedio__dbt_backup" cascade
[0m21:51:46.097725 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:51:46.097991 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:51:46.098228 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:51:46.098471 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
drop table if exists "data_project_1"."public"."mart_hourly__dbt_backup" cascade
[0m21:51:46.098659 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
drop table if exists "data_project_1"."public"."mart_station_summary__dbt_backup" cascade
[0m21:51:46.098821 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
drop table if exists "data_project_1"."public"."mart_alerts__dbt_backup" cascade
[0m21:51:46.099562 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:51:46.100153 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: Close
[0m21:51:46.100270 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:51:46.100387 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:51:46.100514 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:51:46.100745 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8019b8d0>]}
[0m21:51:46.101199 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: Close
[0m21:51:46.101713 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: Close
[0m21:51:46.102148 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: Close
[0m21:51:46.103191 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b7b350>]}
[0m21:51:46.102736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8018c450>]}
[0m21:51:46.102968 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80181d90>]}
[0m21:51:46.102455 [info ] [Thread-4 (]: 18 of 22 OK created sql table model public.mart_daily_promedio ................. [[32mSELECT 102[0m in 0.07s]
[0m21:51:46.104371 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_daily_promedio
[0m21:51:46.103827 [info ] [Thread-1 (]: 17 of 22 OK created sql table model public.mart_hourly ......................... [[32mSELECT 306[0m in 0.08s]
[0m21:51:46.104122 [info ] [Thread-2 (]: 15 of 22 OK created sql table model public.mart_station_summary ................ [[32mSELECT 34[0m in 0.09s]
[0m21:51:46.103482 [info ] [Thread-3 (]: 16 of 22 OK created sql table model public.mart_alerts ......................... [[32mSELECT 0[0m in 0.08s]
[0m21:51:46.105176 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_alerts
[0m21:51:46.104772 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_hourly
[0m21:51:46.104990 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_station_summary
[0m21:51:46.104536 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_top_polluted_stations
[0m21:51:46.105784 [info ] [Thread-4 (]: 19 of 22 START sql table model public.mart_top_polluted_stations ............... [RUN]
[0m21:51:46.105497 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_monthly_promedio
[0m21:51:46.105320 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_weekly_extended
[0m21:51:46.106422 [info ] [Thread-3 (]: 20 of 22 START sql table model public.mart_weekly_extended ..................... [RUN]
[0m21:51:46.106222 [info ] [Thread-1 (]: 21 of 22 START sql table model public.mart_monthly_promedio .................... [RUN]
[0m21:51:46.105979 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_daily_promedio, now model.data_project_1.mart_top_polluted_stations)
[0m21:51:46.106931 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_top_polluted_stations
[0m21:51:46.106788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_hourly, now model.data_project_1.mart_monthly_promedio)
[0m21:51:46.106582 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_alerts, now model.data_project_1.mart_weekly_extended)
[0m21:51:46.108568 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_weekly_extended
[0m21:51:46.108425 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_monthly_promedio
[0m21:51:46.108248 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_top_polluted_stations"
[0m21:51:46.109648 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_weekly_extended"
[0m21:51:46.110844 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_monthly_promedio"
[0m21:51:46.111577 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_top_polluted_stations
[0m21:51:46.112918 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_top_polluted_stations"
[0m21:51:46.113047 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_weekly_extended
[0m21:51:46.113234 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_monthly_promedio
[0m21:51:46.114444 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_weekly_extended"
[0m21:51:46.115667 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_monthly_promedio"
[0m21:51:46.115933 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:51:46.116175 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: BEGIN
[0m21:51:46.116293 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:51:46.116453 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:51:46.116601 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:51:46.117432 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: BEGIN
[0m21:51:46.117763 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: BEGIN
[0m21:51:46.118171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:46.117990 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:51:46.121006 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:46.121225 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:51:46.121426 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */

  
    

  create  table "data_project_1"."public"."mart_top_polluted_stations__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."public"."int_daily_avg"
),

ranked as (
    select
        city,
        nombre_estacion,
        fecha_day,
        no2_avg,
        o3_avg,
        pm10_avg,
        pm25_avg,
        rank() over (partition by city, fecha_day order by pm25_avg desc) as rank_pm25,
        rank() over (partition by city, fecha_day order by pm10_avg desc) as rank_pm10
    from daily_data
)

select *
from ranked
where rank_pm25 <= 5 or rank_pm10 <= 5
order by fecha_day, city, rank_pm25, rank_pm10
  );
  
[0m21:51:46.121563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m21:51:46.121770 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:51:46.122024 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */

  
    

  create  table "data_project_1"."public"."mart_monthly_promedio__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    nombre_estacion,
    fecha_month,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as contaminacion_promedio
from "data_project_1"."public"."int_monthly_avg"
  );
  
[0m21:51:46.122719 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m21:51:46.122918 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:51:46.123123 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */

  
    

  create  table "data_project_1"."public"."mart_weekly_extended__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."public"."int_daily_avg"
),

weekly_data as (
    select
        city,
        nombre_estacion,
        date_trunc('week', fecha_day) as fecha_week,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg
    from daily_data
    group by city, nombre_estacion, date_trunc('week', fecha_day)
)

select
    *,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2
from weekly_data
order by fecha_week, city, nombre_estacion
  );
  
[0m21:51:46.124622 [debug] [Thread-1 (]: SQL status: SELECT 34 in 0.002 seconds
[0m21:51:46.126137 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:51:46.126271 [debug] [Thread-4 (]: SQL status: SELECT 56 in 0.005 seconds
[0m21:51:46.126380 [debug] [Thread-3 (]: SQL status: SELECT 34 in 0.003 seconds
[0m21:51:46.126505 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."public"."mart_monthly_promedio" rename to "mart_monthly_promedio__dbt_backup"
[0m21:51:46.127680 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:51:46.128822 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:51:46.129082 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."public"."mart_top_polluted_stations" rename to "mart_top_polluted_stations__dbt_backup"
[0m21:51:46.129216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:46.129342 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."public"."mart_weekly_extended" rename to "mart_weekly_extended__dbt_backup"
[0m21:51:46.130429 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:51:46.130550 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:51:46.130783 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."public"."mart_monthly_promedio__dbt_tmp" rename to "mart_monthly_promedio"
[0m21:51:46.130890 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:46.131993 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:51:46.133142 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:51:46.133630 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."public"."mart_weekly_extended__dbt_tmp" rename to "mart_weekly_extended"
[0m21:51:46.133448 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."public"."mart_top_polluted_stations__dbt_tmp" rename to "mart_top_polluted_stations"
[0m21:51:46.133242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:51:46.134497 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m21:51:46.134059 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:46.133927 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:46.135644 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m21:51:46.135165 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m21:51:46.134660 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:51:46.136197 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m21:51:46.136012 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:51:46.135803 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:51:46.136454 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m21:51:46.136660 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:51:46.136743 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m21:51:46.137776 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."mart_monthly_promedio__dbt_backup"
[0m21:51:46.137899 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m21:51:46.138313 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:51:46.139484 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
drop table if exists "data_project_1"."public"."mart_monthly_promedio__dbt_backup" cascade
[0m21:51:46.139307 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."mart_top_polluted_stations__dbt_backup"
[0m21:51:46.138404 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m21:51:46.139833 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:51:46.140718 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."mart_weekly_extended__dbt_backup"
[0m21:51:46.141212 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:51:46.140987 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
drop table if exists "data_project_1"."public"."mart_top_polluted_stations__dbt_backup" cascade
[0m21:51:46.140846 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:51:46.141927 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: Close
[0m21:51:46.142227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b23990>]}
[0m21:51:46.142585 [info ] [Thread-1 (]: 21 of 22 OK created sql table model public.mart_monthly_promedio ............... [[32mSELECT 34[0m in 0.04s]
[0m21:51:46.142345 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:51:46.141343 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
drop table if exists "data_project_1"."public"."mart_weekly_extended__dbt_backup" cascade
[0m21:51:46.142852 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_monthly_promedio
[0m21:51:46.143357 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: Close
[0m21:51:46.143784 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80102810>]}
[0m21:51:46.144058 [info ] [Thread-4 (]: 19 of 22 OK created sql table model public.mart_top_polluted_stations .......... [[32mSELECT 56[0m in 0.04s]
[0m21:51:46.144308 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_top_polluted_stations
[0m21:51:46.144537 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:51:46.144963 [debug] [Thread-3 (]: On model.data_project_1.mart_weekly_extended: Close
[0m21:51:46.145176 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b0ecd0>]}
[0m21:51:46.145419 [info ] [Thread-3 (]: 20 of 22 OK created sql table model public.mart_weekly_extended ................ [[32mSELECT 34[0m in 0.04s]
[0m21:51:46.145628 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_weekly_extended
[0m21:51:46.145986 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_fact_air_quality
[0m21:51:46.146265 [info ] [Thread-2 (]: 22 of 22 START sql table model public.mart_fact_air_quality .................... [RUN]
[0m21:51:46.146471 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_station_summary, now model.data_project_1.mart_fact_air_quality)
[0m21:51:46.146629 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_fact_air_quality
[0m21:51:46.148124 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_fact_air_quality"
[0m21:51:46.148620 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_fact_air_quality
[0m21:51:46.150823 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_fact_air_quality"
[0m21:51:46.151200 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:51:46.151337 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: BEGIN
[0m21:51:46.151457 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:51:46.154607 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m21:51:46.154746 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:51:46.154917 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */

  
    

  create  table "data_project_1"."public"."mart_fact_air_quality__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * from "data_project_1"."public"."int_daily_avg"
),
weekly_data as (
    select * from "data_project_1"."public"."mart_weekly_extended"
),
monthly_data as (
    select * from "data_project_1"."public"."int_monthly_avg"
)

select
    coalesce(d.city, w.city, m.city) as city,
    coalesce(d.nombre_estacion, w.nombre_estacion, m.nombre_estacion) as nombre_estacion,
    d.fecha_day,
    w.fecha_week,
    m.fecha_month,
    d.no2_avg as daily_no2,
    d.o3_avg as daily_o3,
    d.pm10_avg as daily_pm10,
    d.pm25_avg as daily_pm25,
    w.no2_avg as weekly_no2,
    w.o3_avg as weekly_o3,
    w.pm10_avg as weekly_pm10,
    w.pm25_avg as weekly_pm25,
    m.no2_avg as monthly_no2,
    m.o3_avg as monthly_o3,
    m.pm10_avg as monthly_pm10,
    m.pm25_avg as monthly_pm25
from daily_data d
full outer join weekly_data w
    on d.city = w.city
    and d.nombre_estacion = w.nombre_estacion
    and date_trunc('week', d.fecha_day) = w.fecha_week
full outer join monthly_data m
    on coalesce(d.city, w.city) = m.city
    and coalesce(d.nombre_estacion, w.nombre_estacion) = m.nombre_estacion
    and date_trunc('month', d.fecha_day) = m.fecha_month
order by city, nombre_estacion, d.fecha_day
  );
  
[0m21:51:46.158244 [debug] [Thread-2 (]: SQL status: SELECT 102 in 0.003 seconds
[0m21:51:46.159436 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:51:46.159579 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."public"."mart_fact_air_quality" rename to "mart_fact_air_quality__dbt_backup"
[0m21:51:46.159865 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:46.160893 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:51:46.161073 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."public"."mart_fact_air_quality__dbt_tmp" rename to "mart_fact_air_quality"
[0m21:51:46.161406 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:51:46.161859 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m21:51:46.161999 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:51:46.162146 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m21:51:46.162684 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m21:51:46.163522 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."mart_fact_air_quality__dbt_backup"
[0m21:51:46.163786 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:51:46.163921 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
drop table if exists "data_project_1"."public"."mart_fact_air_quality__dbt_backup" cascade
[0m21:51:46.164835 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:51:46.165227 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: Close
[0m21:51:46.165486 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7103c3dd-eb56-4164-bab8-bfa14b71b30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80cf7c10>]}
[0m21:51:46.165733 [info ] [Thread-2 (]: 22 of 22 OK created sql table model public.mart_fact_air_quality ............... [[32mSELECT 102[0m in 0.02s]
[0m21:51:46.166000 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_fact_air_quality
[0m21:51:46.166721 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:46.166879 [debug] [MainThread]: On master: BEGIN
[0m21:51:46.167008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:51:46.170153 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:51:46.170307 [debug] [MainThread]: On master: COMMIT
[0m21:51:46.170441 [debug] [MainThread]: Using postgres connection "master"
[0m21:51:46.170566 [debug] [MainThread]: On master: COMMIT
[0m21:51:46.170724 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:51:46.170831 [debug] [MainThread]: On master: Close
[0m21:51:46.170978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:46.171096 [debug] [MainThread]: Connection 'model.data_project_1.mart_fact_air_quality' was properly closed.
[0m21:51:46.171210 [debug] [MainThread]: Connection 'model.data_project_1.mart_monthly_promedio' was properly closed.
[0m21:51:46.171326 [debug] [MainThread]: Connection 'model.data_project_1.mart_weekly_extended' was properly closed.
[0m21:51:46.171438 [debug] [MainThread]: Connection 'model.data_project_1.mart_top_polluted_stations' was properly closed.
[0m21:51:46.171635 [info ] [MainThread]: 
[0m21:51:46.171783 [info ] [MainThread]: Finished running 8 table models, 8 data tests, 6 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m21:51:46.172775 [debug] [MainThread]: Command end result
[0m21:51:46.186526 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m21:51:46.187381 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m21:51:46.190337 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m21:51:46.190484 [info ] [MainThread]: 
[0m21:51:46.190653 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:51:46.190807 [info ] [MainThread]: 
[0m21:51:46.190968 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=22
[0m21:51:46.191404 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8043675, "process_in_blocks": "0", "process_kernel_time": 0.129927, "process_mem_max_rss": "132120", "process_out_blocks": "2475", "process_user_time": 1.209077}
[0m21:51:46.191588 [debug] [MainThread]: Command `dbt build` succeeded at 21:51:46.191558 after 0.80 seconds
[0m21:51:46.191759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831ad810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8803f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85c77e50>]}
[0m21:51:46.191924 [debug] [MainThread]: Flushing usage events
[0m21:51:46.942185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:54:44.116883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d890b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d795d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d796610>]}


============================== 21:54:44.127897 | 4f2197a0-f034-431e-ad5d-7654a165d8ce ==============================
[0m21:54:44.127897 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:54:44.132723 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'empty': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'no_print': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'profiles_dir': '/usr/app/dbt'}
[0m21:54:44.192966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f2197a0-f034-431e-ad5d-7654a165d8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d692090>]}
[0m21:54:44.199078 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:54:44.200529 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:54:44.201187 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14878725, "process_in_blocks": "680", "process_kernel_time": 0.094323, "process_mem_max_rss": "104840", "process_out_blocks": "3", "process_user_time": 0.809359}
[0m21:54:44.201484 [debug] [MainThread]: Command `dbt deps` succeeded at 21:54:44.201406 after 0.15 seconds
[0m21:54:44.201787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da6aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d889690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d66e090>]}
[0m21:54:44.202014 [debug] [MainThread]: Flushing usage events
[0m21:54:45.318245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:54:46.115404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84789f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847902d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849c97d0>]}


============================== 21:54:46.118480 | 7df2dcca-b4c1-471f-8147-a7ab7771a517 ==============================
[0m21:54:46.118480 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:54:46.118846 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'log_path': '/usr/app/dbt/logs', 'no_print': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target dev', 'target_path': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'debug': 'False', 'introspect': 'True', 'printer_width': '80'}
[0m21:54:46.203199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff838dc8d0>]}
[0m21:54:46.224730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff875ceb50>]}
[0m21:54:46.225313 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:54:46.249626 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m21:54:46.299180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:54:46.299414 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:54:46.317660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836f5e10>]}
[0m21:54:46.354062 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m21:54:46.354918 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m21:54:46.391484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8471af10>]}
[0m21:54:46.391787 [info ] [MainThread]: Found 14 models, 8 data tests, 1 source, 459 macros
[0m21:54:46.393220 [info ] [MainThread]: 
[0m21:54:46.393420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:54:46.393664 [info ] [MainThread]: 
[0m21:54:46.393989 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:54:46.395956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1'
[0m21:54:46.409416 [debug] [ThreadPool]: Using postgres connection "list_data_project_1"
[0m21:54:46.409673 [debug] [ThreadPool]: On list_data_project_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1"} */

    select distinct nspname from pg_namespace
  
[0m21:54:46.409842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:46.414781 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m21:54:46.415257 [debug] [ThreadPool]: On list_data_project_1: Close
[0m21:54:46.416220 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1_public'
[0m21:54:46.418563 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_public"
[0m21:54:46.418723 [debug] [ThreadPool]: On list_data_project_1_public: BEGIN
[0m21:54:46.418848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:46.422166 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:54:46.422388 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_public"
[0m21:54:46.422587 [debug] [ThreadPool]: On list_data_project_1_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1_public"} */
select
      'data_project_1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'data_project_1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'data_project_1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:54:46.424676 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m21:54:46.425325 [debug] [ThreadPool]: On list_data_project_1_public: ROLLBACK
[0m21:54:46.425595 [debug] [ThreadPool]: On list_data_project_1_public: Close
[0m21:54:46.428374 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:46.428575 [debug] [MainThread]: On master: BEGIN
[0m21:54:46.428752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:46.432314 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:54:46.432540 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:46.432709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:54:46.434962 [debug] [MainThread]: SQL status: SELECT 20 in 0.002 seconds
[0m21:54:46.436271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff848ed310>]}
[0m21:54:46.436480 [debug] [MainThread]: On master: ROLLBACK
[0m21:54:46.436665 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:46.436782 [debug] [MainThread]: On master: BEGIN
[0m21:54:46.436964 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:54:46.437076 [debug] [MainThread]: On master: COMMIT
[0m21:54:46.437188 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:46.437288 [debug] [MainThread]: On master: COMMIT
[0m21:54:46.437440 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:54:46.437559 [debug] [MainThread]: On master: Close
[0m21:54:46.439321 [debug] [Thread-1 (]: Began running node model.data_project_1.stg_mediciones_madrid
[0m21:54:46.439480 [debug] [Thread-2 (]: Began running node model.data_project_1.stg_mediciones_valencia
[0m21:54:46.439726 [info ] [Thread-1 (]: 1 of 22 START sql view model public.stg_mediciones_madrid ...................... [RUN]
[0m21:54:46.439989 [info ] [Thread-2 (]: 2 of 22 START sql view model public.stg_mediciones_valencia .................... [RUN]
[0m21:54:46.440226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_project_1_public, now model.data_project_1.stg_mediciones_madrid)
[0m21:54:46.440445 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_data_project_1, now model.data_project_1.stg_mediciones_valencia)
[0m21:54:46.440651 [debug] [Thread-1 (]: Began compiling node model.data_project_1.stg_mediciones_madrid
[0m21:54:46.440821 [debug] [Thread-2 (]: Began compiling node model.data_project_1.stg_mediciones_valencia
[0m21:54:46.443824 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_madrid"
[0m21:54:46.445064 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_valencia"
[0m21:54:46.445869 [debug] [Thread-1 (]: Began executing node model.data_project_1.stg_mediciones_madrid
[0m21:54:46.446060 [debug] [Thread-2 (]: Began executing node model.data_project_1.stg_mediciones_valencia
[0m21:54:46.459182 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_madrid"
[0m21:54:46.460545 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_valencia"
[0m21:54:46.461297 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:54:46.461596 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: BEGIN
[0m21:54:46.461746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:46.461485 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:54:46.462082 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: BEGIN
[0m21:54:46.462353 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:54:46.465488 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:54:46.465657 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:54:46.465851 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */

  create view "data_project_1"."public"."stg_mediciones_madrid__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'madrid' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='madrid'
  );
[0m21:54:46.466028 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m21:54:46.466178 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:54:46.466353 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */

  create view "data_project_1"."public"."stg_mediciones_valencia__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'valencia' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='valencia'
  );
[0m21:54:46.467315 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m21:54:46.467454 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m21:54:46.470005 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:54:46.471409 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."public"."stg_mediciones_madrid" rename to "stg_mediciones_madrid__dbt_backup"
[0m21:54:46.471230 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:54:46.471636 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."public"."stg_mediciones_valencia" rename to "stg_mediciones_valencia__dbt_backup"
[0m21:54:46.471792 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.472929 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:54:46.473210 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."public"."stg_mediciones_madrid__dbt_tmp" rename to "stg_mediciones_madrid"
[0m21:54:46.473060 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:54:46.474326 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:54:46.474462 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:54:46.474614 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."public"."stg_mediciones_valencia__dbt_tmp" rename to "stg_mediciones_valencia"
[0m21:54:46.480369 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m21:54:46.480596 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:54:46.480832 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m21:54:46.480706 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.481423 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m21:54:46.481675 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:54:46.481827 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m21:54:46.481546 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:54:46.484141 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."stg_mediciones_madrid__dbt_backup"
[0m21:54:46.484263 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m21:54:46.486854 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."stg_mediciones_valencia__dbt_backup"
[0m21:54:46.487600 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:54:46.487741 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
drop view if exists "data_project_1"."public"."stg_mediciones_valencia__dbt_backup" cascade
[0m21:54:46.485979 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:54:46.487920 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
drop view if exists "data_project_1"."public"."stg_mediciones_madrid__dbt_backup" cascade
[0m21:54:46.489793 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:54:46.490702 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: Close
[0m21:54:46.490817 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m21:54:46.491902 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: Close
[0m21:54:46.492109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827b6590>]}
[0m21:54:46.492367 [info ] [Thread-1 (]: 1 of 22 OK created sql view model public.stg_mediciones_madrid ................. [[32mCREATE VIEW[0m in 0.05s]
[0m21:54:46.492632 [debug] [Thread-1 (]: Finished running node model.data_project_1.stg_mediciones_madrid
[0m21:54:46.491451 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82548290>]}
[0m21:54:46.493050 [info ] [Thread-2 (]: 2 of 22 OK created sql view model public.stg_mediciones_valencia ............... [[32mCREATE VIEW[0m in 0.05s]
[0m21:54:46.493236 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:54:46.493364 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:54:46.493562 [debug] [Thread-2 (]: Finished running node model.data_project_1.stg_mediciones_valencia
[0m21:54:46.494230 [debug] [Thread-2 (]: Began running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:54:46.493849 [info ] [Thread-4 (]: 3 of 22 START test not_null_stg_mediciones_madrid_fecha_carg ................... [RUN]
[0m21:54:46.494054 [info ] [Thread-3 (]: 4 of 22 START test not_null_stg_mediciones_madrid_id ........................... [RUN]
[0m21:54:46.493670 [debug] [Thread-1 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:54:46.495085 [info ] [Thread-1 (]: 5 of 22 START test not_null_stg_mediciones_madrid_nombre_estacion .............. [RUN]
[0m21:54:46.494740 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf'
[0m21:54:46.494946 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515'
[0m21:54:46.494474 [info ] [Thread-2 (]: 6 of 22 START test unique_stg_mediciones_madrid_id ............................. [RUN]
[0m21:54:46.495787 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_valencia, now test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c)
[0m21:54:46.495427 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:54:46.495613 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:54:46.495244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_madrid, now test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2)
[0m21:54:46.501867 [debug] [Thread-1 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:54:46.500234 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:54:46.501686 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:54:46.495930 [debug] [Thread-2 (]: Began compiling node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:54:46.503246 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:54:46.505762 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:54:46.506244 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:54:46.506366 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:54:46.512579 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:54:46.512757 [debug] [Thread-1 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:54:46.513633 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:54:46.513806 [debug] [Thread-2 (]: Began executing node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:54:46.514810 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:54:46.515224 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:54:46.516083 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:54:46.516328 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:54:46.516926 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: BEGIN
[0m21:54:46.516719 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:54:46.516523 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: BEGIN
[0m21:54:46.517500 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:54:46.517242 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:54:46.517345 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: BEGIN
[0m21:54:46.517061 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:54:46.517795 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: BEGIN
[0m21:54:46.517964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:46.518227 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:54:46.522231 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m21:54:46.522426 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m21:54:46.522555 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:54:46.522678 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:54:46.522825 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:54:46.522995 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."public"."stg_mediciones_madrid"
where id is null



  
  
      
    ) dbt_internal_test
[0m21:54:46.523157 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:54:46.523326 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."public"."stg_mediciones_madrid"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m21:54:46.523642 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."public"."stg_mediciones_madrid"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m21:54:46.523936 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m21:54:46.524162 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:54:46.524299 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:54:46.526062 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."public"."stg_mediciones_madrid"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:54:46.525770 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: ROLLBACK
[0m21:54:46.525914 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:54:46.524422 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:54:46.526517 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: Close
[0m21:54:46.527135 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: ROLLBACK
[0m21:54:46.527266 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:54:46.529343 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: ROLLBACK
[0m21:54:46.528077 [info ] [Thread-3 (]: 4 of 22 PASS not_null_stg_mediciones_madrid_id ................................. [[32mPASS[0m in 0.03s]
[0m21:54:46.528885 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: Close
[0m21:54:46.527746 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: ROLLBACK
[0m21:54:46.529572 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: Close
[0m21:54:46.529754 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:54:46.530038 [info ] [Thread-1 (]: 5 of 22 PASS not_null_stg_mediciones_madrid_nombre_estacion .................... [[32mPASS[0m in 0.03s]
[0m21:54:46.530262 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: Close
[0m21:54:46.531180 [info ] [Thread-4 (]: 3 of 22 PASS not_null_stg_mediciones_madrid_fecha_carg ......................... [[32mPASS[0m in 0.04s]
[0m21:54:46.530680 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:54:46.530951 [debug] [Thread-1 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:54:46.530470 [info ] [Thread-2 (]: 6 of 22 PASS unique_stg_mediciones_madrid_id ................................... [[32mPASS[0m in 0.03s]
[0m21:54:46.532025 [debug] [Thread-2 (]: Finished running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:54:46.531584 [info ] [Thread-3 (]: 7 of 22 START test not_null_stg_mediciones_valencia_fecha_carg ................. [RUN]
[0m21:54:46.531810 [debug] [Thread-1 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:54:46.531380 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:54:46.532897 [debug] [Thread-4 (]: Began running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:54:46.532412 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515, now test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e)
[0m21:54:46.532659 [info ] [Thread-1 (]: 8 of 22 START test not_null_stg_mediciones_valencia_id ......................... [RUN]
[0m21:54:46.532175 [debug] [Thread-2 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:54:46.533738 [info ] [Thread-2 (]: 9 of 22 START test not_null_stg_mediciones_valencia_nombre_estacion ............ [RUN]
[0m21:54:46.533344 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:54:46.533567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2, now test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e)
[0m21:54:46.533087 [info ] [Thread-4 (]: 10 of 22 START test unique_stg_mediciones_valencia_id .......................... [RUN]
[0m21:54:46.536084 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf, now test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170)
[0m21:54:46.535664 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:54:46.535887 [debug] [Thread-1 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:54:46.533936 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c, now test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046)
[0m21:54:46.536251 [debug] [Thread-4 (]: Began compiling node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:54:46.538808 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:54:46.539009 [debug] [Thread-2 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:54:46.539238 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:54:46.540547 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:54:46.542024 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:54:46.542256 [debug] [Thread-1 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:54:46.543143 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:54:46.544283 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:54:46.544482 [debug] [Thread-4 (]: Began executing node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:54:46.544618 [debug] [Thread-2 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:54:46.545613 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:54:46.545799 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:54:46.545979 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:54:46.546736 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:54:46.546999 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: BEGIN
[0m21:54:46.547163 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: BEGIN
[0m21:54:46.547290 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:54:46.547498 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:54:46.547643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:46.547760 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:54:46.547893 [debug] [Thread-4 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: BEGIN
[0m21:54:46.548681 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: BEGIN
[0m21:54:46.548900 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:54:46.549208 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:54:46.552237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:54:46.552368 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m21:54:46.552530 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:54:46.552707 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:54:46.552905 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m21:54:46.553024 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."public"."stg_mediciones_valencia"
where id is null



  
  
      
    ) dbt_internal_test
[0m21:54:46.553213 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."public"."stg_mediciones_valencia"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m21:54:46.553387 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:54:46.553734 [debug] [Thread-4 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."public"."stg_mediciones_valencia"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:54:46.553955 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m21:54:46.554100 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:54:46.554218 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:54:46.554352 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:54:46.554483 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."public"."stg_mediciones_valencia"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m21:54:46.555125 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: ROLLBACK
[0m21:54:46.555268 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:54:46.555768 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: ROLLBACK
[0m21:54:46.556069 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: Close
[0m21:54:46.556503 [debug] [Thread-4 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: ROLLBACK
[0m21:54:46.556609 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:54:46.556815 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: Close
[0m21:54:46.557057 [info ] [Thread-1 (]: 8 of 22 PASS not_null_stg_mediciones_valencia_id ............................... [[32mPASS[0m in 0.02s]
[0m21:54:46.557273 [debug] [Thread-4 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: Close
[0m21:54:46.558447 [info ] [Thread-4 (]: 10 of 22 PASS unique_stg_mediciones_valencia_id ................................ [[32mPASS[0m in 0.02s]
[0m21:54:46.557973 [info ] [Thread-3 (]: 7 of 22 PASS not_null_stg_mediciones_valencia_fecha_carg ....................... [[32mPASS[0m in 0.03s]
[0m21:54:46.558212 [debug] [Thread-1 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:54:46.557696 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: ROLLBACK
[0m21:54:46.558690 [debug] [Thread-4 (]: Finished running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:54:46.558936 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:54:46.559314 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: Close
[0m21:54:46.559701 [info ] [Thread-2 (]: 9 of 22 PASS not_null_stg_mediciones_valencia_nombre_estacion .................. [[32mPASS[0m in 0.03s]
[0m21:54:46.559910 [debug] [Thread-2 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:54:46.560394 [debug] [Thread-1 (]: Began running node model.data_project_1.int_daily_avg
[0m21:54:46.560554 [debug] [Thread-4 (]: Began running node model.data_project_1.int_hourly_avg
[0m21:54:46.560685 [debug] [Thread-3 (]: Began running node model.data_project_1.int_monthly_avg
[0m21:54:46.560817 [debug] [Thread-2 (]: Began running node model.data_project_1.int_station_summary
[0m21:54:46.560986 [info ] [Thread-1 (]: 11 of 22 START sql view model public.int_daily_avg ............................. [RUN]
[0m21:54:46.561224 [info ] [Thread-4 (]: 12 of 22 START sql view model public.int_hourly_avg ............................ [RUN]
[0m21:54:46.561478 [info ] [Thread-3 (]: 13 of 22 START sql view model public.int_monthly_avg ........................... [RUN]
[0m21:54:46.561719 [info ] [Thread-2 (]: 14 of 22 START sql view model public.int_station_summary ....................... [RUN]
[0m21:54:46.561957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e, now model.data_project_1.int_daily_avg)
[0m21:54:46.562145 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170, now model.data_project_1.int_hourly_avg)
[0m21:54:46.562356 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e, now model.data_project_1.int_monthly_avg)
[0m21:54:46.562532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046, now model.data_project_1.int_station_summary)
[0m21:54:46.562735 [debug] [Thread-1 (]: Began compiling node model.data_project_1.int_daily_avg
[0m21:54:46.562901 [debug] [Thread-4 (]: Began compiling node model.data_project_1.int_hourly_avg
[0m21:54:46.563119 [debug] [Thread-3 (]: Began compiling node model.data_project_1.int_monthly_avg
[0m21:54:46.563295 [debug] [Thread-2 (]: Began compiling node model.data_project_1.int_station_summary
[0m21:54:46.564753 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.int_daily_avg"
[0m21:54:46.565905 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.int_hourly_avg"
[0m21:54:46.567180 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.int_monthly_avg"
[0m21:54:46.568314 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.int_station_summary"
[0m21:54:46.569309 [debug] [Thread-4 (]: Began executing node model.data_project_1.int_hourly_avg
[0m21:54:46.569459 [debug] [Thread-1 (]: Began executing node model.data_project_1.int_daily_avg
[0m21:54:46.569624 [debug] [Thread-3 (]: Began executing node model.data_project_1.int_monthly_avg
[0m21:54:46.574297 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.int_monthly_avg"
[0m21:54:46.571829 [debug] [Thread-2 (]: Began executing node model.data_project_1.int_station_summary
[0m21:54:46.573075 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.int_daily_avg"
[0m21:54:46.571659 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.int_hourly_avg"
[0m21:54:46.575537 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.int_station_summary"
[0m21:54:46.575925 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:54:46.576239 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:54:46.576408 [debug] [Thread-3 (]: On model.data_project_1.int_monthly_avg: BEGIN
[0m21:54:46.576523 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:54:46.576715 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:54:46.576815 [debug] [Thread-1 (]: On model.data_project_1.int_daily_avg: BEGIN
[0m21:54:46.577380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:46.577094 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: BEGIN
[0m21:54:46.577243 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: BEGIN
[0m21:54:46.576963 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:54:46.577682 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:54:46.577848 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:54:46.582469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:54:46.582598 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m21:54:46.582834 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:54:46.582960 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m21:54:46.583067 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m21:54:46.583209 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:54:46.583360 [debug] [Thread-1 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */

  create view "data_project_1"."public"."int_daily_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m21:54:46.583543 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:54:46.583700 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:54:46.583876 [debug] [Thread-3 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */

  create view "data_project_1"."public"."int_monthly_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_month,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_month
order by city, nombre_estacion, fecha_month
  );
[0m21:54:46.584138 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */

  create view "data_project_1"."public"."int_station_summary__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m21:54:46.584306 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */

  create view "data_project_1"."public"."int_hourly_avg__dbt_tmp"
    
    
  as (
    with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    avg(no2) as no2_avg,
    avg(o3) as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by 1,2,3
order by fecha_hour, city, nombre_estacion
  );
[0m21:54:46.585626 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:54:46.586903 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:54:46.587029 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:54:46.587136 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:54:46.587247 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:54:46.587352 [debug] [Thread-1 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
alter table "data_project_1"."public"."int_daily_avg__dbt_tmp" rename to "int_daily_avg"
[0m21:54:46.588418 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:54:46.589482 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:54:46.590500 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:54:46.590756 [debug] [Thread-3 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
alter table "data_project_1"."public"."int_monthly_avg__dbt_tmp" rename to "int_monthly_avg"
[0m21:54:46.590885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.591009 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
alter table "data_project_1"."public"."int_hourly_avg__dbt_tmp" rename to "int_hourly_avg"
[0m21:54:46.591196 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
alter table "data_project_1"."public"."int_station_summary__dbt_tmp" rename to "int_station_summary"
[0m21:54:46.591820 [debug] [Thread-1 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m21:54:46.591985 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:54:46.592316 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:54:46.593124 [debug] [Thread-1 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m21:54:46.592551 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.592956 [debug] [Thread-3 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m21:54:46.592409 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.593728 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: COMMIT
[0m21:54:46.593870 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:54:46.594039 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:54:46.594474 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m21:54:46.594678 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:54:46.595499 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."int_daily_avg__dbt_backup"
[0m21:54:46.595705 [debug] [Thread-3 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m21:54:46.595852 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:54:46.596016 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: COMMIT
[0m21:54:46.596240 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:54:46.596823 [debug] [Thread-1 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
drop view if exists "data_project_1"."public"."int_daily_avg__dbt_backup" cascade
[0m21:54:46.596594 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m21:54:46.596472 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m21:54:46.596932 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m21:54:46.598275 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."int_monthly_avg__dbt_backup"
[0m21:54:46.598391 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:54:46.599301 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."int_station_summary__dbt_backup"
[0m21:54:46.599454 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m21:54:46.599693 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:54:46.600135 [debug] [Thread-1 (]: On model.data_project_1.int_daily_avg: Close
[0m21:54:46.600399 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:54:46.601192 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."int_hourly_avg__dbt_backup"
[0m21:54:46.601379 [debug] [Thread-3 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
drop view if exists "data_project_1"."public"."int_monthly_avg__dbt_backup" cascade
[0m21:54:46.601672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82587a10>]}
[0m21:54:46.601827 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
drop view if exists "data_project_1"."public"."int_station_summary__dbt_backup" cascade
[0m21:54:46.602050 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:54:46.602760 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
drop view if exists "data_project_1"."public"."int_hourly_avg__dbt_backup" cascade
[0m21:54:46.602557 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:54:46.602407 [info ] [Thread-1 (]: 11 of 22 OK created sql view model public.int_daily_avg ........................ [[32mCREATE VIEW[0m in 0.04s]
[0m21:54:46.602868 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:54:46.603069 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:54:46.603463 [debug] [Thread-3 (]: On model.data_project_1.int_monthly_avg: Close
[0m21:54:46.603702 [debug] [Thread-1 (]: Finished running node model.data_project_1.int_daily_avg
[0m21:54:46.604128 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: Close
[0m21:54:46.604602 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: Close
[0m21:54:46.604875 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff826f4e50>]}
[0m21:54:46.605013 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_station_summary
[0m21:54:46.605320 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8258aed0>]}
[0m21:54:46.605541 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8397dfd0>]}
[0m21:54:46.605797 [info ] [Thread-3 (]: 13 of 22 OK created sql view model public.int_monthly_avg ...................... [[32mCREATE VIEW[0m in 0.04s]
[0m21:54:46.606020 [info ] [Thread-1 (]: 15 of 22 START sql table model public.mart_station_summary ..................... [RUN]
[0m21:54:46.606313 [info ] [Thread-2 (]: 14 of 22 OK created sql view model public.int_station_summary .................. [[32mCREATE VIEW[0m in 0.04s]
[0m21:54:46.606587 [info ] [Thread-4 (]: 12 of 22 OK created sql view model public.int_hourly_avg ....................... [[32mCREATE VIEW[0m in 0.04s]
[0m21:54:46.606831 [debug] [Thread-3 (]: Finished running node model.data_project_1.int_monthly_avg
[0m21:54:46.606998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_daily_avg, now model.data_project_1.mart_station_summary)
[0m21:54:46.607216 [debug] [Thread-2 (]: Finished running node model.data_project_1.int_station_summary
[0m21:54:46.607402 [debug] [Thread-4 (]: Finished running node model.data_project_1.int_hourly_avg
[0m21:54:46.607607 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_daily_promedio
[0m21:54:46.607817 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_station_summary
[0m21:54:46.608003 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_top_polluted_stations
[0m21:54:46.608169 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_weekly_extended
[0m21:54:46.608393 [info ] [Thread-3 (]: 16 of 22 START sql table model public.mart_daily_promedio ...................... [RUN]
[0m21:54:46.609756 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_station_summary"
[0m21:54:46.609966 [info ] [Thread-2 (]: 17 of 22 START sql table model public.mart_top_polluted_stations ............... [RUN]
[0m21:54:46.610186 [info ] [Thread-4 (]: 18 of 22 START sql table model public.mart_weekly_extended ..................... [RUN]
[0m21:54:46.610386 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_monthly_avg, now model.data_project_1.mart_daily_promedio)
[0m21:54:46.610660 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_station_summary, now model.data_project_1.mart_top_polluted_stations)
[0m21:54:46.610835 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_hourly_avg, now model.data_project_1.mart_weekly_extended)
[0m21:54:46.611086 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_station_summary
[0m21:54:46.611196 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_daily_promedio
[0m21:54:46.611363 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_top_polluted_stations
[0m21:54:46.621818 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_top_polluted_stations"
[0m21:54:46.619677 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_station_summary"
[0m21:54:46.620812 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_daily_promedio"
[0m21:54:46.611553 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_weekly_extended
[0m21:54:46.623556 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_weekly_extended"
[0m21:54:46.622582 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_top_polluted_stations
[0m21:54:46.623948 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:54:46.625239 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_top_polluted_stations"
[0m21:54:46.625369 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_daily_promedio
[0m21:54:46.625543 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: BEGIN
[0m21:54:46.625644 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_weekly_extended
[0m21:54:46.627666 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_daily_promedio"
[0m21:54:46.627896 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:54:46.628000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:46.629205 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_weekly_extended"
[0m21:54:46.629479 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: BEGIN
[0m21:54:46.629685 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:54:46.630142 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:54:46.630337 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: BEGIN
[0m21:54:46.630489 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:54:46.630932 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: BEGIN
[0m21:54:46.631067 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:54:46.630777 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:54:46.633620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m21:54:46.633904 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:54:46.634214 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m21:54:46.634474 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */

  
    

  create  table "data_project_1"."public"."mart_station_summary__dbt_tmp"
  
  
    as
  
  (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
),

daily_avg as (
    select
        city,
        nombre_estacion,
        fecha_day,
        avg(no2)  as no2_avg,
        avg(o3)   as o3_avg,
        avg(pm10) as pm10_avg,
        avg(pm25) as pm25_avg
    from all_data
    group by city, nombre_estacion, fecha_day
),

station_summary as (
    select
        city,
        nombre_estacion,
        min(fecha_day) as first_measurement,
        max(fecha_day) as last_measurement,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg,
        case
            when avg(pm25_avg) > 50 then 'Alto'
            when avg(pm25_avg) > 25 then 'Moderado'
            else 'Bajo'
        end as nivel_pm25
    from daily_avg
    group by city, nombre_estacion
)

select *
from station_summary
order by city, nombre_estacion
  );
  
[0m21:54:46.634813 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:54:46.635150 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m21:54:46.635278 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */

  
    

  create  table "data_project_1"."public"."mart_top_polluted_stations__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."public"."int_daily_avg"
),

ranked as (
    select
        city,
        nombre_estacion,
        fecha_day,
        no2_avg,
        o3_avg,
        pm10_avg,
        pm25_avg,
        rank() over (partition by city, fecha_day order by pm25_avg desc) as rank_pm25,
        rank() over (partition by city, fecha_day order by pm10_avg desc) as rank_pm10
    from daily_data
)

select *
from ranked
where rank_pm25 <= 5 or rank_pm10 <= 5
order by fecha_day, city, rank_pm25, rank_pm10
  );
  
[0m21:54:46.635426 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m21:54:46.635805 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:54:46.635961 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */

  
    

  create  table "data_project_1"."public"."mart_daily_promedio__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * 
    from "data_project_1"."public"."int_daily_avg"
)

select
    city,
    nombre_estacion,
    fecha_day,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Calculamos un Ã­ndice de contaminaciÃ³n promedio
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n del nivel de NO2
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por dÃ­a dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_day order by pm25_avg desc) as ranking_pm25
from daily_data
order by fecha_day, city, nombre_estacion
  );
  
[0m21:54:46.635574 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:54:46.636204 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */

  
    

  create  table "data_project_1"."public"."mart_weekly_extended__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."public"."int_daily_avg"
),

weekly_data as (
    select
        city,
        nombre_estacion,
        date_trunc('week', fecha_day) as fecha_week,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg
    from daily_data
    group by city, nombre_estacion, date_trunc('week', fecha_day)
)

select
    *,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2
from weekly_data
order by fecha_week, city, nombre_estacion
  );
  
[0m21:54:46.637837 [debug] [Thread-1 (]: SQL status: SELECT 34 in 0.003 seconds
[0m21:54:46.640676 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:54:46.640800 [debug] [Thread-2 (]: SQL status: SELECT 56 in 0.005 seconds
[0m21:54:46.640924 [debug] [Thread-4 (]: SQL status: SELECT 34 in 0.005 seconds
[0m21:54:46.641028 [debug] [Thread-3 (]: SQL status: SELECT 102 in 0.005 seconds
[0m21:54:46.641178 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
alter table "data_project_1"."public"."mart_station_summary" rename to "mart_station_summary__dbt_backup"
[0m21:54:46.642380 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:54:46.643550 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:54:46.645350 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."public"."mart_weekly_extended" rename to "mart_weekly_extended__dbt_backup"
[0m21:54:46.645049 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."public"."mart_top_polluted_stations" rename to "mart_top_polluted_stations__dbt_backup"
[0m21:54:46.645207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.644705 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:54:46.646969 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."public"."mart_daily_promedio" rename to "mart_daily_promedio__dbt_backup"
[0m21:54:46.645804 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.646791 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:54:46.645677 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.648105 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:54:46.648243 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:54:46.648711 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
alter table "data_project_1"."public"."mart_station_summary__dbt_tmp" rename to "mart_station_summary"
[0m21:54:46.649669 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:54:46.649884 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."public"."mart_top_polluted_stations__dbt_tmp" rename to "mart_top_polluted_stations"
[0m21:54:46.650871 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:54:46.651696 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."public"."mart_daily_promedio__dbt_tmp" rename to "mart_daily_promedio"
[0m21:54:46.651356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.651210 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."public"."mart_weekly_extended__dbt_tmp" rename to "mart_weekly_extended"
[0m21:54:46.651830 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.652485 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: COMMIT
[0m21:54:46.652629 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:54:46.653158 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m21:54:46.653297 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:54:46.653492 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:54:46.653943 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m21:54:46.654147 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:54:46.654628 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m21:54:46.654841 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: COMMIT
[0m21:54:46.655025 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:54:46.655231 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m21:54:46.655399 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:54:46.656091 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m21:54:46.655943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:54:46.655701 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m21:54:46.656248 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m21:54:46.657865 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."mart_station_summary__dbt_backup"
[0m21:54:46.658002 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m21:54:46.658931 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."mart_top_polluted_stations__dbt_backup"
[0m21:54:46.659074 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:54:46.660143 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:54:46.661001 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."mart_weekly_extended__dbt_backup"
[0m21:54:46.661300 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:54:46.662099 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."mart_daily_promedio__dbt_backup"
[0m21:54:46.662282 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
drop table if exists "data_project_1"."public"."mart_station_summary__dbt_backup" cascade
[0m21:54:46.662521 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:54:46.662693 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
drop table if exists "data_project_1"."public"."mart_top_polluted_stations__dbt_backup" cascade
[0m21:54:46.662918 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:54:46.663402 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
drop table if exists "data_project_1"."public"."mart_daily_promedio__dbt_backup" cascade
[0m21:54:46.663178 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
drop table if exists "data_project_1"."public"."mart_weekly_extended__dbt_backup" cascade
[0m21:54:46.664117 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:54:46.664320 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:54:46.664775 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: Close
[0m21:54:46.665004 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:54:46.666223 [debug] [Thread-4 (]: On model.data_project_1.mart_weekly_extended: Close
[0m21:54:46.665447 [debug] [Thread-2 (]: On model.data_project_1.mart_top_polluted_stations: Close
[0m21:54:46.665751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b9b990>]}
[0m21:54:46.664907 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:54:46.666480 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82585d50>]}
[0m21:54:46.666729 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83428050>]}
[0m21:54:46.667010 [info ] [Thread-1 (]: 15 of 22 OK created sql table model public.mart_station_summary ................ [[32mSELECT 34[0m in 0.06s]
[0m21:54:46.667528 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: Close
[0m21:54:46.667765 [info ] [Thread-4 (]: 18 of 22 OK created sql table model public.mart_weekly_extended ................ [[32mSELECT 34[0m in 0.06s]
[0m21:54:46.668050 [info ] [Thread-2 (]: 17 of 22 OK created sql table model public.mart_top_polluted_stations .......... [[32mSELECT 56[0m in 0.06s]
[0m21:54:46.668302 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_station_summary
[0m21:54:46.668523 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8260f850>]}
[0m21:54:46.668730 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_weekly_extended
[0m21:54:46.668939 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_top_polluted_stations
[0m21:54:46.669134 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_monthly_promedio
[0m21:54:46.669381 [info ] [Thread-3 (]: 16 of 22 OK created sql table model public.mart_daily_promedio ................. [[32mSELECT 102[0m in 0.06s]
[0m21:54:46.670282 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_daily_promedio
[0m21:54:46.669851 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_hourly
[0m21:54:46.670059 [info ] [Thread-1 (]: 19 of 22 START sql table model public.mart_monthly_promedio .................... [RUN]
[0m21:54:46.669586 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_alerts
[0m21:54:46.671010 [info ] [Thread-4 (]: 20 of 22 START sql table model public.mart_alerts .............................. [RUN]
[0m21:54:46.670620 [info ] [Thread-2 (]: 21 of 22 START sql table model public.mart_hourly .............................. [RUN]
[0m21:54:46.670833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_station_summary, now model.data_project_1.mart_monthly_promedio)
[0m21:54:46.670422 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_fact_air_quality
[0m21:54:46.671726 [info ] [Thread-3 (]: 22 of 22 START sql table model public.mart_fact_air_quality .................... [RUN]
[0m21:54:46.671359 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_top_polluted_stations, now model.data_project_1.mart_hourly)
[0m21:54:46.671537 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_monthly_promedio
[0m21:54:46.671179 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_weekly_extended, now model.data_project_1.mart_alerts)
[0m21:54:46.673502 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_alerts
[0m21:54:46.672055 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_hourly
[0m21:54:46.673321 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_monthly_promedio"
[0m21:54:46.671896 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_daily_promedio, now model.data_project_1.mart_fact_air_quality)
[0m21:54:46.676150 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_fact_air_quality
[0m21:54:46.675770 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_hourly"
[0m21:54:46.674613 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_alerts"
[0m21:54:46.677428 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_fact_air_quality"
[0m21:54:46.677718 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_monthly_promedio
[0m21:54:46.678189 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_hourly
[0m21:54:46.679393 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_monthly_promedio"
[0m21:54:46.679541 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_alerts
[0m21:54:46.679686 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_fact_air_quality
[0m21:54:46.680928 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_hourly"
[0m21:54:46.683097 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_alerts"
[0m21:54:46.683309 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:54:46.684514 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_fact_air_quality"
[0m21:54:46.684858 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: BEGIN
[0m21:54:46.685444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:54:46.685281 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:54:46.685060 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:54:46.685678 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:54:46.685830 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: BEGIN
[0m21:54:46.686476 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:54:46.686298 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: BEGIN
[0m21:54:46.686090 [debug] [Thread-2 (]: On model.data_project_1.mart_hourly: BEGIN
[0m21:54:46.686752 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:54:46.686917 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:54:46.689461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:54:46.690101 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:54:46.690445 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */

  
    

  create  table "data_project_1"."public"."mart_monthly_promedio__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    nombre_estacion,
    fecha_month,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as contaminacion_promedio
from "data_project_1"."public"."int_monthly_avg"
  );
  
[0m21:54:46.690638 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m21:54:46.691022 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m21:54:46.691178 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:54:46.691634 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */

  
    

  create  table "data_project_1"."public"."mart_alerts__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select *
    from "data_project_1"."public"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    case 
        when no2_avg > 200 then 'Alerta NO2'
        when o3_avg > 180 then 'Alerta O3'
        when pm10_avg > 150 then 'Alerta PM10'
        when pm25_avg > 75 then 'Alerta PM2.5'
        else null
    end as alerta
from hourly_data
where no2_avg > 200
   or o3_avg > 180
   or pm10_avg > 150
   or pm25_avg > 75
order by fecha_hour, city, nombre_estacion
  );
  
[0m21:54:46.691453 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:54:46.691304 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m21:54:46.691898 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */

  
    

  create  table "data_project_1"."public"."mart_fact_air_quality__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * from "data_project_1"."public"."int_daily_avg"
),
weekly_data as (
    select * from "data_project_1"."public"."mart_weekly_extended"
),
monthly_data as (
    select * from "data_project_1"."public"."int_monthly_avg"
)

select
    coalesce(d.city, w.city, m.city) as city,
    coalesce(d.nombre_estacion, w.nombre_estacion, m.nombre_estacion) as nombre_estacion,
    d.fecha_day,
    w.fecha_week,
    m.fecha_month,
    d.no2_avg as daily_no2,
    d.o3_avg as daily_o3,
    d.pm10_avg as daily_pm10,
    d.pm25_avg as daily_pm25,
    w.no2_avg as weekly_no2,
    w.o3_avg as weekly_o3,
    w.pm10_avg as weekly_pm10,
    w.pm25_avg as weekly_pm25,
    m.no2_avg as monthly_no2,
    m.o3_avg as monthly_o3,
    m.pm10_avg as monthly_pm10,
    m.pm25_avg as monthly_pm25
from daily_data d
full outer join weekly_data w
    on d.city = w.city
    and d.nombre_estacion = w.nombre_estacion
    and date_trunc('week', d.fecha_day) = w.fecha_week
full outer join monthly_data m
    on coalesce(d.city, w.city) = m.city
    and coalesce(d.nombre_estacion, w.nombre_estacion) = m.nombre_estacion
    and date_trunc('month', d.fecha_day) = m.fecha_month
order by city, nombre_estacion, d.fecha_day
  );
  
[0m21:54:46.692067 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:54:46.692351 [debug] [Thread-2 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */

  
    

  create  table "data_project_1"."public"."mart_hourly__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select * 
    from "data_project_1"."public"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Ãndice de contaminaciÃ³n por hora
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n de NO2 por niveles
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por hora dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_hour order by pm25_avg desc) as ranking_pm25
from hourly_data
order by fecha_hour, city, nombre_estacion
  );
  
[0m21:54:46.693056 [debug] [Thread-1 (]: SQL status: SELECT 34 in 0.002 seconds
[0m21:54:46.694635 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:54:46.694768 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.003 seconds
[0m21:54:46.694931 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."public"."mart_monthly_promedio" rename to "mart_monthly_promedio__dbt_backup"
[0m21:54:46.696123 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:54:46.696600 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."public"."mart_alerts" rename to "mart_alerts__dbt_backup"
[0m21:54:46.696335 [debug] [Thread-3 (]: SQL status: SELECT 102 in 0.004 seconds
[0m21:54:46.696226 [debug] [Thread-2 (]: SQL status: SELECT 306 in 0.004 seconds
[0m21:54:46.696710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.697871 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:54:46.698013 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:54:46.699186 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:54:46.700212 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:54:46.700429 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."public"."mart_fact_air_quality" rename to "mart_fact_air_quality__dbt_backup"
[0m21:54:46.701414 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:54:46.702102 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."public"."mart_alerts__dbt_tmp" rename to "mart_alerts"
[0m21:54:46.701819 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."public"."mart_monthly_promedio__dbt_tmp" rename to "mart_monthly_promedio"
[0m21:54:46.701601 [debug] [Thread-2 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."public"."mart_hourly" rename to "mart_hourly__dbt_backup"
[0m21:54:46.702213 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.702484 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.702753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.703748 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:54:46.703858 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:54:46.704309 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: COMMIT
[0m21:54:46.704814 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m21:54:46.705041 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."public"."mart_fact_air_quality__dbt_tmp" rename to "mart_fact_air_quality"
[0m21:54:46.706070 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:54:46.706765 [debug] [Thread-2 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."public"."mart_hourly__dbt_tmp" rename to "mart_hourly"
[0m21:54:46.706463 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:54:46.706236 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:54:46.706898 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.707147 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m21:54:46.707250 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:54:46.707393 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: COMMIT
[0m21:54:46.707893 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m21:54:46.708544 [debug] [Thread-2 (]: On model.data_project_1.mart_hourly: COMMIT
[0m21:54:46.708664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:54:46.708922 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:54:46.709133 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:54:46.711109 [debug] [Thread-2 (]: On model.data_project_1.mart_hourly: COMMIT
[0m21:54:46.710784 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."mart_monthly_promedio__dbt_backup"
[0m21:54:46.710967 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m21:54:46.709217 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m21:54:46.711421 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:54:46.711558 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m21:54:46.712416 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."mart_alerts__dbt_backup"
[0m21:54:46.712553 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:54:46.712697 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
drop table if exists "data_project_1"."public"."mart_monthly_promedio__dbt_backup" cascade
[0m21:54:46.713513 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."mart_hourly__dbt_backup"
[0m21:54:46.714882 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:54:46.714568 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."mart_fact_air_quality__dbt_backup"
[0m21:54:46.713748 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:54:46.715439 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
drop table if exists "data_project_1"."public"."mart_alerts__dbt_backup" cascade
[0m21:54:46.715286 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:54:46.715028 [debug] [Thread-2 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
drop table if exists "data_project_1"."public"."mart_hourly__dbt_backup" cascade
[0m21:54:46.715549 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:54:46.715746 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
drop table if exists "data_project_1"."public"."mart_fact_air_quality__dbt_backup" cascade
[0m21:54:46.716297 [debug] [Thread-1 (]: On model.data_project_1.mart_monthly_promedio: Close
[0m21:54:46.716453 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:54:46.716790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81133f90>]}
[0m21:54:46.716899 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:54:46.718178 [debug] [Thread-2 (]: On model.data_project_1.mart_hourly: Close
[0m21:54:46.717449 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m21:54:46.717717 [info ] [Thread-1 (]: 19 of 22 OK created sql table model public.mart_monthly_promedio ............... [[32mSELECT 34[0m in 0.05s]
[0m21:54:46.717327 [debug] [Thread-4 (]: On model.data_project_1.mart_alerts: Close
[0m21:54:46.719251 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b99210>]}
[0m21:54:46.718818 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: Close
[0m21:54:46.719039 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_monthly_promedio
[0m21:54:46.718387 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bec9d0>]}
[0m21:54:46.720059 [info ] [Thread-2 (]: 21 of 22 OK created sql table model public.mart_hourly ......................... [[32mSELECT 306[0m in 0.05s]
[0m21:54:46.719741 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df2dcca-b4c1-471f-8147-a7ab7771a517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b88ad0>]}
[0m21:54:46.719479 [info ] [Thread-4 (]: 20 of 22 OK created sql table model public.mart_alerts ......................... [[32mSELECT 0[0m in 0.05s]
[0m21:54:46.720767 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_alerts
[0m21:54:46.720545 [info ] [Thread-3 (]: 22 of 22 OK created sql table model public.mart_fact_air_quality ............... [[32mSELECT 102[0m in 0.05s]
[0m21:54:46.720279 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_hourly
[0m21:54:46.721050 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_fact_air_quality
[0m21:54:46.721841 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:46.721987 [debug] [MainThread]: On master: BEGIN
[0m21:54:46.722114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:54:46.725269 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:54:46.725396 [debug] [MainThread]: On master: COMMIT
[0m21:54:46.725546 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:46.725674 [debug] [MainThread]: On master: COMMIT
[0m21:54:46.725823 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:54:46.725947 [debug] [MainThread]: On master: Close
[0m21:54:46.726087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:46.726197 [debug] [MainThread]: Connection 'model.data_project_1.mart_hourly' was properly closed.
[0m21:54:46.726292 [debug] [MainThread]: Connection 'model.data_project_1.mart_monthly_promedio' was properly closed.
[0m21:54:46.726401 [debug] [MainThread]: Connection 'model.data_project_1.mart_alerts' was properly closed.
[0m21:54:46.726515 [debug] [MainThread]: Connection 'model.data_project_1.mart_fact_air_quality' was properly closed.
[0m21:54:46.726681 [info ] [MainThread]: 
[0m21:54:46.726816 [info ] [MainThread]: Finished running 8 table models, 8 data tests, 6 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m21:54:46.727838 [debug] [MainThread]: Command end result
[0m21:54:46.741910 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m21:54:46.742825 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m21:54:46.745809 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m21:54:46.745955 [info ] [MainThread]: 
[0m21:54:46.746132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:54:46.746276 [info ] [MainThread]: 
[0m21:54:46.746418 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=22
[0m21:54:46.746855 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7129458, "process_in_blocks": "0", "process_kernel_time": 0.136983, "process_mem_max_rss": "132096", "process_out_blocks": "2477", "process_user_time": 1.157761}
[0m21:54:46.747053 [debug] [MainThread]: Command `dbt build` succeeded at 21:54:46.747016 after 0.71 seconds
[0m21:54:46.747218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84793a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84790410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8998f850>]}
[0m21:54:46.747355 [debug] [MainThread]: Flushing usage events
[0m21:54:47.464232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:58:01.268445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93893d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b99c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93893910>]}


============================== 21:58:01.275556 | 8cebabc5-4f9a-4f44-aa40-05baaa1d568a ==============================
[0m21:58:01.275556 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:58:01.276500 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': '/usr/app/dbt', 'static_parser': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt deps', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_colors': 'True', 'write_json': 'True', 'printer_width': '80'}
[0m21:58:01.384466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cebabc5-4f9a-4f44-aa40-05baaa1d568a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93674950>]}
[0m21:58:01.390673 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:58:01.406459 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:58:01.407707 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.19558588, "process_in_blocks": "0", "process_kernel_time": 0.118886, "process_mem_max_rss": "104784", "process_out_blocks": "3", "process_user_time": 0.921119}
[0m21:58:01.408274 [debug] [MainThread]: Command `dbt deps` succeeded at 21:58:01.408206 after 0.20 seconds
[0m21:58:01.408961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ad5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93889410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98916c50>]}
[0m21:58:01.409332 [debug] [MainThread]: Flushing usage events
[0m21:58:02.070084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:58:03.147243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94163310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942336d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94162a90>]}


============================== 21:58:03.153275 | dbc4757d-6b0b-4268-874c-13e3dbac5c31 ==============================
[0m21:58:03.153275 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:58:03.154135 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'write_json': 'True', 'empty': 'False', 'printer_width': '80', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'fail_fast': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --target dev', 'static_parser': 'True'}
[0m21:58:03.262135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97035810>]}
[0m21:58:03.302537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9705cc90>]}
[0m21:58:03.303187 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:58:03.338129 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m21:58:03.425810 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:58:03.426304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:58:03.460215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92de9990>]}
[0m21:58:03.514817 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m21:58:03.517306 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m21:58:03.578633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96eca510>]}
[0m21:58:03.579094 [info ] [MainThread]: Found 14 models, 8 data tests, 1 source, 459 macros
[0m21:58:03.581385 [info ] [MainThread]: 
[0m21:58:03.581817 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:58:03.582186 [info ] [MainThread]: 
[0m21:58:03.582754 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:58:03.587442 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1'
[0m21:58:03.608092 [debug] [ThreadPool]: Using postgres connection "list_data_project_1"
[0m21:58:03.608705 [debug] [ThreadPool]: On list_data_project_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1"} */

    select distinct nspname from pg_namespace
  
[0m21:58:03.609226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:03.638724 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.029 seconds
[0m21:58:03.640949 [debug] [ThreadPool]: On list_data_project_1: Close
[0m21:58:03.643669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1_public'
[0m21:58:03.647946 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_public"
[0m21:58:03.648257 [debug] [ThreadPool]: On list_data_project_1_public: BEGIN
[0m21:58:03.648428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:03.656441 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m21:58:03.657220 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_public"
[0m21:58:03.657676 [debug] [ThreadPool]: On list_data_project_1_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1_public"} */
select
      'data_project_1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'data_project_1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'data_project_1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:58:03.669528 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.011 seconds
[0m21:58:03.671860 [debug] [ThreadPool]: On list_data_project_1_public: ROLLBACK
[0m21:58:03.672754 [debug] [ThreadPool]: On list_data_project_1_public: Close
[0m21:58:03.678387 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:03.679024 [debug] [MainThread]: On master: BEGIN
[0m21:58:03.679661 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:58:03.686615 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m21:58:03.687342 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:03.687915 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:58:03.695613 [debug] [MainThread]: SQL status: SELECT 20 in 0.007 seconds
[0m21:58:03.699255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943ab590>]}
[0m21:58:03.700014 [debug] [MainThread]: On master: ROLLBACK
[0m21:58:03.700819 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:03.701345 [debug] [MainThread]: On master: BEGIN
[0m21:58:03.702253 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:58:03.702551 [debug] [MainThread]: On master: COMMIT
[0m21:58:03.702835 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:03.703090 [debug] [MainThread]: On master: COMMIT
[0m21:58:03.703817 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:58:03.704320 [debug] [MainThread]: On master: Close
[0m21:58:03.709122 [debug] [Thread-1 (]: Began running node model.data_project_1.stg_mediciones_madrid
[0m21:58:03.710407 [info ] [Thread-1 (]: 1 of 22 START sql view model public.stg_mediciones_madrid ...................... [RUN]
[0m21:58:03.711331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_project_1_public, now model.data_project_1.stg_mediciones_madrid)
[0m21:58:03.712024 [debug] [Thread-1 (]: Began compiling node model.data_project_1.stg_mediciones_madrid
[0m21:58:03.709628 [debug] [Thread-2 (]: Began running node model.data_project_1.stg_mediciones_valencia
[0m21:58:03.719732 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_madrid"
[0m21:58:03.720604 [info ] [Thread-2 (]: 2 of 22 START sql view model public.stg_mediciones_valencia .................... [RUN]
[0m21:58:03.722017 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_data_project_1, now model.data_project_1.stg_mediciones_valencia)
[0m21:58:03.722688 [debug] [Thread-2 (]: Began compiling node model.data_project_1.stg_mediciones_valencia
[0m21:58:03.725794 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_valencia"
[0m21:58:03.726730 [debug] [Thread-1 (]: Began executing node model.data_project_1.stg_mediciones_madrid
[0m21:58:03.742981 [debug] [Thread-2 (]: Began executing node model.data_project_1.stg_mediciones_valencia
[0m21:58:03.754896 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_valencia"
[0m21:58:03.752689 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_madrid"
[0m21:58:03.757244 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:58:03.758104 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: BEGIN
[0m21:58:03.758625 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:03.757932 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:58:03.759764 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: BEGIN
[0m21:58:03.760699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:03.768430 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m21:58:03.769708 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:58:03.770123 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */

  create view "data_project_1"."public"."stg_mediciones_valencia__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'valencia' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='valencia'
  );
[0m21:58:03.770322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m21:58:03.771026 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:58:03.771748 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */

  create view "data_project_1"."public"."stg_mediciones_madrid__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'madrid' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='madrid'
  );
[0m21:58:03.779802 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m21:58:03.780513 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m21:58:03.784227 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:58:03.787858 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:58:03.788982 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."public"."stg_mediciones_madrid" rename to "stg_mediciones_madrid__dbt_backup"
[0m21:58:03.788323 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."public"."stg_mediciones_valencia" rename to "stg_mediciones_valencia__dbt_backup"
[0m21:58:03.790368 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:58:03.790893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:03.793891 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:58:03.797634 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:58:03.798854 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."public"."stg_mediciones_madrid__dbt_tmp" rename to "stg_mediciones_madrid"
[0m21:58:03.798259 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."public"."stg_mediciones_valencia__dbt_tmp" rename to "stg_mediciones_valencia"
[0m21:58:03.799967 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:58:03.800173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:03.810641 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m21:58:03.810914 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:58:03.811328 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m21:58:03.809618 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m21:58:03.812004 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:58:03.812239 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m21:58:03.812717 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:58:03.812938 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m21:58:03.817065 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."stg_mediciones_madrid__dbt_backup"
[0m21:58:03.818464 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."stg_mediciones_valencia__dbt_backup"
[0m21:58:03.822828 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m21:58:03.823121 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
drop view if exists "data_project_1"."public"."stg_mediciones_valencia__dbt_backup" cascade
[0m21:58:03.822280 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m21:58:03.823739 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
drop view if exists "data_project_1"."public"."stg_mediciones_madrid__dbt_backup" cascade
[0m21:58:03.829011 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.006 seconds
[0m21:58:03.831230 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: Close
[0m21:58:03.833391 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f2d350>]}
[0m21:58:03.835262 [info ] [Thread-2 (]: 2 of 22 OK created sql view model public.stg_mediciones_valencia ............... [[32mCREATE VIEW[0m in 0.11s]
[0m21:58:03.835693 [debug] [Thread-2 (]: Finished running node model.data_project_1.stg_mediciones_valencia
[0m21:58:03.831567 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m21:58:03.836243 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:58:03.836480 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:58:03.836648 [debug] [Thread-2 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:58:03.838943 [info ] [Thread-2 (]: 5 of 22 START test not_null_stg_mediciones_valencia_nombre_estacion ............ [RUN]
[0m21:58:03.837749 [info ] [Thread-4 (]: 3 of 22 START test not_null_stg_mediciones_valencia_fecha_carg ................. [RUN]
[0m21:58:03.838335 [info ] [Thread-3 (]: 4 of 22 START test not_null_stg_mediciones_valencia_id ......................... [RUN]
[0m21:58:03.837387 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: Close
[0m21:58:03.839658 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_valencia, now test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046)
[0m21:58:03.840428 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e'
[0m21:58:03.841135 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e'
[0m21:58:03.841982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f55610>]}
[0m21:58:03.844645 [info ] [Thread-1 (]: 1 of 22 OK created sql view model public.stg_mediciones_madrid ................. [[32mCREATE VIEW[0m in 0.13s]
[0m21:58:03.843161 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:58:03.843875 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:58:03.842537 [debug] [Thread-2 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:58:03.845350 [debug] [Thread-1 (]: Finished running node model.data_project_1.stg_mediciones_madrid
[0m21:58:03.850973 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:58:03.852696 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:58:03.855987 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:58:03.856521 [debug] [Thread-1 (]: Began running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:58:03.858743 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:58:03.859248 [info ] [Thread-1 (]: 6 of 22 START test unique_stg_mediciones_valencia_id ........................... [RUN]
[0m21:58:03.859565 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:58:03.866592 [debug] [Thread-2 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:58:03.869676 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:58:03.870109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_madrid, now test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170)
[0m21:58:03.871842 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:58:03.873562 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:58:03.874537 [debug] [Thread-1 (]: Began compiling node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:58:03.875846 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:58:03.879865 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:58:03.880299 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:58:03.880667 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:58:03.880925 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: BEGIN
[0m21:58:03.881526 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: BEGIN
[0m21:58:03.881836 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: BEGIN
[0m21:58:03.882012 [debug] [Thread-1 (]: Began executing node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:58:03.882208 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:58:03.882460 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:58:03.882713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:03.884062 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:58:03.886721 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:58:03.889588 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m21:58:03.889928 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: BEGIN
[0m21:58:03.891035 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m21:58:03.891930 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m21:58:03.903992 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m21:58:03.904499 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."public"."stg_mediciones_valencia"
where id is null



  
  
      
    ) dbt_internal_test
[0m21:58:03.902906 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m21:58:03.898639 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m21:58:03.905691 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."public"."stg_mediciones_valencia"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m21:58:03.905207 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."public"."stg_mediciones_valencia"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m21:58:03.900868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:03.910802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m21:58:03.911056 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m21:58:03.911254 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."public"."stg_mediciones_valencia"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:03.913949 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m21:58:03.914127 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m21:58:03.915743 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: ROLLBACK
[0m21:58:03.915915 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m21:58:03.916111 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m21:58:03.918610 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: ROLLBACK
[0m21:58:03.917039 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: Close
[0m21:58:03.919391 [info ] [Thread-3 (]: 4 of 22 PASS not_null_stg_mediciones_valencia_id ............................... [[32mPASS[0m in 0.08s]
[0m21:58:03.916703 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: ROLLBACK
[0m21:58:03.919008 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: Close
[0m21:58:03.917657 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: ROLLBACK
[0m21:58:03.919720 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m21:58:03.920707 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: Close
[0m21:58:03.921062 [info ] [Thread-4 (]: 3 of 22 PASS not_null_stg_mediciones_valencia_fecha_carg ....................... [[32mPASS[0m in 0.08s]
[0m21:58:03.922345 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m21:58:03.922507 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:58:03.922086 [info ] [Thread-2 (]: 5 of 22 PASS not_null_stg_mediciones_valencia_nombre_estacion .................. [[32mPASS[0m in 0.08s]
[0m21:58:03.921502 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: Close
[0m21:58:03.923364 [info ] [Thread-1 (]: 6 of 22 PASS unique_stg_mediciones_valencia_id ................................. [[32mPASS[0m in 0.05s]
[0m21:58:03.922673 [info ] [Thread-4 (]: 8 of 22 START test not_null_stg_mediciones_madrid_id ........................... [RUN]
[0m21:58:03.923002 [debug] [Thread-2 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m21:58:03.921655 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:58:03.923864 [debug] [Thread-1 (]: Finished running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m21:58:03.924296 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e, now test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515)
[0m21:58:03.924733 [debug] [Thread-2 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:58:03.926899 [info ] [Thread-2 (]: 9 of 22 START test not_null_stg_mediciones_madrid_nombre_estacion .............. [RUN]
[0m21:58:03.927379 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046, now test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2)
[0m21:58:03.926384 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:58:03.925248 [info ] [Thread-3 (]: 7 of 22 START test not_null_stg_mediciones_madrid_fecha_carg ................... [RUN]
[0m21:58:03.930796 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e, now test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf)
[0m21:58:03.927755 [debug] [Thread-2 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:58:03.930204 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:58:03.925879 [debug] [Thread-1 (]: Began running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:58:03.937114 [info ] [Thread-1 (]: 10 of 22 START test unique_stg_mediciones_madrid_id ............................ [RUN]
[0m21:58:03.934756 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:58:03.931221 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:58:03.943970 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:58:03.939809 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:58:03.937846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170, now test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c)
[0m21:58:03.945105 [debug] [Thread-2 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:58:03.946232 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:58:03.946601 [debug] [Thread-1 (]: Began compiling node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:58:03.947339 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:58:03.948505 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:58:03.952880 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:58:03.954340 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:58:03.954751 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:58:03.955801 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:58:03.956102 [debug] [Thread-1 (]: Began executing node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:58:03.956329 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: BEGIN
[0m21:58:03.956714 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:58:03.960146 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: BEGIN
[0m21:58:03.960706 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:03.959381 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:03.956860 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: BEGIN
[0m21:58:03.962420 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:03.958709 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:58:03.968287 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m21:58:03.971980 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m21:58:03.968716 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:58:03.972321 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m21:58:03.973160 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."public"."stg_mediciones_madrid"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m21:58:03.974312 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: BEGIN
[0m21:58:03.976035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:03.975330 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m21:58:03.975080 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m21:58:03.978259 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."public"."stg_mediciones_madrid"
where id is null



  
  
      
    ) dbt_internal_test
[0m21:58:03.977657 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m21:58:03.977013 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:58:03.979636 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."public"."stg_mediciones_madrid"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m21:58:03.983575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m21:58:03.982821 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: ROLLBACK
[0m21:58:03.981002 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m21:58:03.984160 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m21:58:03.984382 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:58:03.984916 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: Close
[0m21:58:03.986341 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: ROLLBACK
[0m21:58:03.987024 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."public"."stg_mediciones_madrid"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:58:03.988632 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: ROLLBACK
[0m21:58:03.991524 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: Close
[0m21:58:03.991083 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: Close
[0m21:58:03.989913 [info ] [Thread-3 (]: 7 of 22 PASS not_null_stg_mediciones_madrid_fecha_carg ......................... [[32mPASS[0m in 0.06s]
[0m21:58:03.992593 [info ] [Thread-4 (]: 8 of 22 PASS not_null_stg_mediciones_madrid_id ................................. [[32mPASS[0m in 0.07s]
[0m21:58:03.993671 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m21:58:03.994405 [info ] [Thread-2 (]: 9 of 22 PASS not_null_stg_mediciones_madrid_nombre_estacion .................... [[32mPASS[0m in 0.07s]
[0m21:58:03.995426 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m21:58:03.995621 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m21:58:03.997903 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: ROLLBACK
[0m21:58:03.996494 [debug] [Thread-2 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m21:58:03.998975 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: Close
[0m21:58:04.001702 [info ] [Thread-1 (]: 10 of 22 PASS unique_stg_mediciones_madrid_id .................................. [[32mPASS[0m in 0.06s]
[0m21:58:04.002279 [debug] [Thread-1 (]: Finished running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m21:58:04.003231 [debug] [Thread-3 (]: Began running node model.data_project_1.int_daily_avg
[0m21:58:04.004697 [info ] [Thread-3 (]: 11 of 22 START sql view model public.int_daily_avg ............................. [RUN]
[0m21:58:04.004103 [debug] [Thread-2 (]: Began running node model.data_project_1.int_monthly_avg
[0m21:58:04.004226 [debug] [Thread-1 (]: Began running node model.data_project_1.int_station_summary
[0m21:58:04.006414 [info ] [Thread-1 (]: 14 of 22 START sql view model public.int_station_summary ....................... [RUN]
[0m21:58:04.007126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c, now model.data_project_1.int_station_summary)
[0m21:58:04.007675 [debug] [Thread-1 (]: Began compiling node model.data_project_1.int_station_summary
[0m21:58:04.003813 [debug] [Thread-4 (]: Began running node model.data_project_1.int_hourly_avg
[0m21:58:04.005305 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf, now model.data_project_1.int_daily_avg)
[0m21:58:04.011984 [debug] [Thread-3 (]: Began compiling node model.data_project_1.int_daily_avg
[0m21:58:04.010436 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.int_station_summary"
[0m21:58:04.011192 [info ] [Thread-4 (]: 12 of 22 START sql view model public.int_hourly_avg ............................ [RUN]
[0m21:58:04.005869 [info ] [Thread-2 (]: 13 of 22 START sql view model public.int_monthly_avg ........................... [RUN]
[0m21:58:04.016827 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.int_daily_avg"
[0m21:58:04.018028 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515, now model.data_project_1.int_hourly_avg)
[0m21:58:04.020410 [debug] [Thread-4 (]: Began compiling node model.data_project_1.int_hourly_avg
[0m21:58:04.019638 [debug] [Thread-1 (]: Began executing node model.data_project_1.int_station_summary
[0m21:58:04.019023 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2, now model.data_project_1.int_monthly_avg)
[0m21:58:04.028170 [debug] [Thread-2 (]: Began compiling node model.data_project_1.int_monthly_avg
[0m21:58:04.025348 [debug] [Thread-3 (]: Began executing node model.data_project_1.int_daily_avg
[0m21:58:04.027460 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.int_station_summary"
[0m21:58:04.024842 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.int_hourly_avg"
[0m21:58:04.033727 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.int_monthly_avg"
[0m21:58:04.037117 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.int_daily_avg"
[0m21:58:04.039951 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:58:04.040538 [debug] [Thread-4 (]: Began executing node model.data_project_1.int_hourly_avg
[0m21:58:04.040817 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: BEGIN
[0m21:58:04.040974 [debug] [Thread-2 (]: Began executing node model.data_project_1.int_monthly_avg
[0m21:58:04.041402 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:58:04.045823 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: BEGIN
[0m21:58:04.043845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:04.045409 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.int_monthly_avg"
[0m21:58:04.043407 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.int_hourly_avg"
[0m21:58:04.046096 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:04.047855 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:58:04.051003 [debug] [Thread-2 (]: On model.data_project_1.int_monthly_avg: BEGIN
[0m21:58:04.051423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m21:58:04.052501 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:58:04.052116 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:58:04.051751 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:04.052953 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */

  create view "data_project_1"."public"."int_station_summary__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m21:58:04.053472 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: BEGIN
[0m21:58:04.054625 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:04.055435 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m21:58:04.056084 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:58:04.056730 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */

  create view "data_project_1"."public"."int_daily_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m21:58:04.059413 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:58:04.059690 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m21:58:04.062090 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:58:04.064038 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
alter table "data_project_1"."public"."int_station_summary__dbt_tmp" rename to "int_station_summary"
[0m21:58:04.063303 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:58:04.063564 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m21:58:04.062457 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:58:04.064963 [debug] [Thread-2 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */

  create view "data_project_1"."public"."int_monthly_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_month,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_month
order by city, nombre_estacion, fecha_month
  );
[0m21:58:04.065444 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.065875 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:58:04.068144 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:58:04.069382 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: COMMIT
[0m21:58:04.069970 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */

  create view "data_project_1"."public"."int_hourly_avg__dbt_tmp"
    
    
  as (
    with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    avg(no2) as no2_avg,
    avg(o3) as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by 1,2,3
order by fecha_hour, city, nombre_estacion
  );
[0m21:58:04.070550 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
alter table "data_project_1"."public"."int_daily_avg__dbt_tmp" rename to "int_daily_avg"
[0m21:58:04.071377 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:58:04.072319 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:58:04.073159 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: COMMIT
[0m21:58:04.073865 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.075535 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:58:04.075739 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:58:04.076938 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m21:58:04.077188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:58:04.077513 [debug] [Thread-2 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
alter table "data_project_1"."public"."int_monthly_avg__dbt_tmp" rename to "int_monthly_avg"
[0m21:58:04.078964 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:58:04.079333 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:58:04.080552 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."int_station_summary__dbt_backup"
[0m21:58:04.081498 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
alter table "data_project_1"."public"."int_hourly_avg__dbt_tmp" rename to "int_hourly_avg"
[0m21:58:04.082061 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.082510 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m21:58:04.083124 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m21:58:04.084566 [debug] [Thread-2 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m21:58:04.084803 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.087125 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m21:58:04.085758 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:58:04.086186 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:58:04.085419 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
drop view if exists "data_project_1"."public"."int_station_summary__dbt_backup" cascade
[0m21:58:04.087614 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:58:04.090372 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."int_daily_avg__dbt_backup"
[0m21:58:04.091100 [debug] [Thread-2 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m21:58:04.091712 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m21:58:04.091923 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:58:04.092614 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m21:58:04.094274 [debug] [Thread-1 (]: On model.data_project_1.int_station_summary: Close
[0m21:58:04.094471 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:58:04.095447 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m21:58:04.096016 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
drop view if exists "data_project_1"."public"."int_daily_avg__dbt_backup" cascade
[0m21:58:04.097245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f90d50>]}
[0m21:58:04.100853 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."int_monthly_avg__dbt_backup"
[0m21:58:04.102567 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."int_hourly_avg__dbt_backup"
[0m21:58:04.105643 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m21:58:04.103985 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:58:04.104635 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m21:58:04.103592 [info ] [Thread-1 (]: 14 of 22 OK created sql view model public.int_station_summary .................. [[32mCREATE VIEW[0m in 0.09s]
[0m21:58:04.106327 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
drop view if exists "data_project_1"."public"."int_hourly_avg__dbt_backup" cascade
[0m21:58:04.107571 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: Close
[0m21:58:04.108130 [debug] [Thread-2 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
drop view if exists "data_project_1"."public"."int_monthly_avg__dbt_backup" cascade
[0m21:58:04.108831 [debug] [Thread-1 (]: Finished running node model.data_project_1.int_station_summary
[0m21:58:04.109638 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f87a10>]}
[0m21:58:04.110052 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:58:04.110934 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:58:04.111341 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_station_summary
[0m21:58:04.112265 [info ] [Thread-3 (]: 11 of 22 OK created sql view model public.int_daily_avg ........................ [[32mCREATE VIEW[0m in 0.10s]
[0m21:58:04.113344 [debug] [Thread-4 (]: On model.data_project_1.int_hourly_avg: Close
[0m21:58:04.114655 [debug] [Thread-2 (]: On model.data_project_1.int_monthly_avg: Close
[0m21:58:04.115309 [info ] [Thread-1 (]: 15 of 22 START sql table model public.mart_station_summary ..................... [RUN]
[0m21:58:04.116025 [debug] [Thread-3 (]: Finished running node model.data_project_1.int_daily_avg
[0m21:58:04.116943 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f67c90>]}
[0m21:58:04.119311 [info ] [Thread-4 (]: 12 of 22 OK created sql view model public.int_hourly_avg ....................... [[32mCREATE VIEW[0m in 0.10s]
[0m21:58:04.118270 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f78dd0>]}
[0m21:58:04.117614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_station_summary, now model.data_project_1.mart_station_summary)
[0m21:58:04.120132 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_daily_promedio
[0m21:58:04.120820 [debug] [Thread-4 (]: Finished running node model.data_project_1.int_hourly_avg
[0m21:58:04.121770 [info ] [Thread-2 (]: 13 of 22 OK created sql view model public.int_monthly_avg ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m21:58:04.122479 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_station_summary
[0m21:58:04.124287 [info ] [Thread-3 (]: 16 of 22 START sql table model public.mart_daily_promedio ...................... [RUN]
[0m21:58:04.130019 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_daily_avg, now model.data_project_1.mart_daily_promedio)
[0m21:58:04.126385 [debug] [Thread-2 (]: Finished running node model.data_project_1.int_monthly_avg
[0m21:58:04.129150 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_station_summary"
[0m21:58:04.125359 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_top_polluted_stations
[0m21:58:04.130891 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_daily_promedio
[0m21:58:04.131764 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_weekly_extended
[0m21:58:04.141394 [info ] [Thread-2 (]: 18 of 22 START sql table model public.mart_weekly_extended ..................... [RUN]
[0m21:58:04.138508 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_daily_promedio"
[0m21:58:04.139408 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_station_summary
[0m21:58:04.133181 [info ] [Thread-4 (]: 17 of 22 START sql table model public.mart_top_polluted_stations ............... [RUN]
[0m21:58:04.161516 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_hourly_avg, now model.data_project_1.mart_top_polluted_stations)
[0m21:58:04.143210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_monthly_avg, now model.data_project_1.mart_weekly_extended)
[0m21:58:04.165355 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_station_summary"
[0m21:58:04.165726 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_daily_promedio
[0m21:58:04.170431 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_daily_promedio"
[0m21:58:04.167205 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_weekly_extended
[0m21:58:04.166538 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_top_polluted_stations
[0m21:58:04.179440 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_top_polluted_stations"
[0m21:58:04.177842 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:58:04.177643 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:58:04.176748 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_weekly_extended"
[0m21:58:04.180699 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: BEGIN
[0m21:58:04.182891 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:04.181371 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: BEGIN
[0m21:58:04.181899 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_top_polluted_stations
[0m21:58:04.183962 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_weekly_extended
[0m21:58:04.193285 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_weekly_extended"
[0m21:58:04.190081 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_top_polluted_stations"
[0m21:58:04.184377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:04.194377 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m21:58:04.201370 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:58:04.203028 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */

  
    

  create  table "data_project_1"."public"."mart_daily_promedio__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * 
    from "data_project_1"."public"."int_daily_avg"
)

select
    city,
    nombre_estacion,
    fecha_day,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Calculamos un Ã­ndice de contaminaciÃ³n promedio
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n del nivel de NO2
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por dÃ­a dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_day order by pm25_avg desc) as ranking_pm25
from daily_data
order by fecha_day, city, nombre_estacion
  );
  
[0m21:58:04.198071 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:58:04.204498 [debug] [Thread-2 (]: On model.data_project_1.mart_weekly_extended: BEGIN
[0m21:58:04.205387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m21:58:04.199633 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:58:04.206078 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:04.207186 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:58:04.212339 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */

  
    

  create  table "data_project_1"."public"."mart_station_summary__dbt_tmp"
  
  
    as
  
  (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
),

daily_avg as (
    select
        city,
        nombre_estacion,
        fecha_day,
        avg(no2)  as no2_avg,
        avg(o3)   as o3_avg,
        avg(pm10) as pm10_avg,
        avg(pm25) as pm25_avg
    from all_data
    group by city, nombre_estacion, fecha_day
),

station_summary as (
    select
        city,
        nombre_estacion,
        min(fecha_day) as first_measurement,
        max(fecha_day) as last_measurement,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg,
        case
            when avg(pm25_avg) > 50 then 'Alto'
            when avg(pm25_avg) > 25 then 'Moderado'
            else 'Bajo'
        end as nivel_pm25
    from daily_avg
    group by city, nombre_estacion
)

select *
from station_summary
order by city, nombre_estacion
  );
  
[0m21:58:04.209355 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: BEGIN
[0m21:58:04.216973 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:04.221161 [debug] [Thread-1 (]: SQL status: SELECT 34 in 0.008 seconds
[0m21:58:04.221641 [debug] [Thread-3 (]: SQL status: SELECT 102 in 0.018 seconds
[0m21:58:04.221813 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m21:58:04.232249 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:58:04.227686 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:58:04.231577 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:58:04.222039 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m21:58:04.233082 [debug] [Thread-2 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */

  
    

  create  table "data_project_1"."public"."mart_weekly_extended__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."public"."int_daily_avg"
),

weekly_data as (
    select
        city,
        nombre_estacion,
        date_trunc('week', fecha_day) as fecha_week,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg
    from daily_data
    group by city, nombre_estacion, date_trunc('week', fecha_day)
)

select
    *,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2
from weekly_data
order by fecha_week, city, nombre_estacion
  );
  
[0m21:58:04.233923 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
alter table "data_project_1"."public"."mart_station_summary" rename to "mart_station_summary__dbt_backup"
[0m21:58:04.237426 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.235488 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:58:04.234671 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."public"."mart_daily_promedio" rename to "mart_daily_promedio__dbt_backup"
[0m21:58:04.241723 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:58:04.242378 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */

  
    

  create  table "data_project_1"."public"."mart_top_polluted_stations__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."public"."int_daily_avg"
),

ranked as (
    select
        city,
        nombre_estacion,
        fecha_day,
        no2_avg,
        o3_avg,
        pm10_avg,
        pm25_avg,
        rank() over (partition by city, fecha_day order by pm25_avg desc) as rank_pm25,
        rank() over (partition by city, fecha_day order by pm10_avg desc) as rank_pm10
    from daily_data
)

select *
from ranked
where rank_pm25 <= 5 or rank_pm10 <= 5
order by fecha_day, city, rank_pm25, rank_pm10
  );
  
[0m21:58:04.242987 [debug] [Thread-2 (]: SQL status: SELECT 34 in 0.007 seconds
[0m21:58:04.255131 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:58:04.244891 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
alter table "data_project_1"."public"."mart_station_summary__dbt_tmp" rename to "mart_station_summary"
[0m21:58:04.252691 [debug] [Thread-4 (]: SQL status: SELECT 56 in 0.007 seconds
[0m21:58:04.243929 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:58:04.257057 [debug] [Thread-2 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."public"."mart_weekly_extended" rename to "mart_weekly_extended__dbt_backup"
[0m21:58:04.259486 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:58:04.261556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m21:58:04.265204 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:58:04.270766 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."public"."mart_daily_promedio__dbt_tmp" rename to "mart_daily_promedio"
[0m21:58:04.268818 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."public"."mart_top_polluted_stations" rename to "mart_top_polluted_stations__dbt_backup"
[0m21:58:04.270378 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: COMMIT
[0m21:58:04.266981 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.276706 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:58:04.274324 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.274727 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:58:04.272732 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.280925 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m21:58:04.279072 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:58:04.279774 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: COMMIT
[0m21:58:04.277254 [debug] [Thread-2 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."public"."mart_weekly_extended__dbt_tmp" rename to "mart_weekly_extended"
[0m21:58:04.281537 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:58:04.284815 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m21:58:04.283898 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:58:04.284471 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.282390 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."public"."mart_top_polluted_stations__dbt_tmp" rename to "mart_top_polluted_stations"
[0m21:58:04.289768 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."mart_station_summary__dbt_backup"
[0m21:58:04.290194 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m21:58:04.297362 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."mart_daily_promedio__dbt_backup"
[0m21:58:04.294369 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m21:58:04.294759 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m21:58:04.300829 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m21:58:04.301434 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:58:04.299188 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
drop table if exists "data_project_1"."public"."mart_station_summary__dbt_backup" cascade
[0m21:58:04.291613 [debug] [Thread-2 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m21:58:04.302935 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:58:04.302141 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m21:58:04.298162 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m21:58:04.304849 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
drop table if exists "data_project_1"."public"."mart_daily_promedio__dbt_backup" cascade
[0m21:58:04.304338 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:58:04.307015 [debug] [Thread-1 (]: On model.data_project_1.mart_station_summary: Close
[0m21:58:04.307902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915d1dd0>]}
[0m21:58:04.303495 [debug] [Thread-2 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m21:58:04.305200 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m21:58:04.311319 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."mart_top_polluted_stations__dbt_backup"
[0m21:58:04.309013 [info ] [Thread-1 (]: 15 of 22 OK created sql table model public.mart_station_summary ................ [[32mSELECT 34[0m in 0.19s]
[0m21:58:04.308148 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:58:04.313984 [debug] [Thread-3 (]: On model.data_project_1.mart_daily_promedio: Close
[0m21:58:04.312006 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m21:58:04.312752 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_station_summary
[0m21:58:04.311560 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m21:58:04.314997 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9159fd50>]}
[0m21:58:04.315670 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
drop table if exists "data_project_1"."public"."mart_top_polluted_stations__dbt_backup" cascade
[0m21:58:04.316468 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_alerts
[0m21:58:04.318659 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."mart_weekly_extended__dbt_backup"
[0m21:58:04.324683 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m21:58:04.322822 [info ] [Thread-1 (]: 19 of 22 START sql table model public.mart_alerts .............................. [RUN]
[0m21:58:04.323648 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:58:04.327539 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: Close
[0m21:58:04.325266 [debug] [Thread-2 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
drop table if exists "data_project_1"."public"."mart_weekly_extended__dbt_backup" cascade
[0m21:58:04.325920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_station_summary, now model.data_project_1.mart_alerts)
[0m21:58:04.332363 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_alerts
[0m21:58:04.335877 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_alerts"
[0m21:58:04.319571 [info ] [Thread-3 (]: 16 of 22 OK created sql table model public.mart_daily_promedio ................. [[32mSELECT 102[0m in 0.18s]
[0m21:58:04.328395 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff915c1b10>]}
[0m21:58:04.339113 [info ] [Thread-4 (]: 17 of 22 OK created sql table model public.mart_top_polluted_stations .......... [[32mSELECT 56[0m in 0.17s]
[0m21:58:04.337873 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_daily_promedio
[0m21:58:04.340835 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_hourly
[0m21:58:04.339847 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_top_polluted_stations
[0m21:58:04.336347 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m21:58:04.341610 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_alerts
[0m21:58:04.342280 [info ] [Thread-3 (]: 20 of 22 START sql table model public.mart_hourly .............................. [RUN]
[0m21:58:04.348286 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_daily_promedio, now model.data_project_1.mart_hourly)
[0m21:58:04.344901 [debug] [Thread-2 (]: On model.data_project_1.mart_weekly_extended: Close
[0m21:58:04.347725 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_alerts"
[0m21:58:04.343206 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_monthly_promedio
[0m21:58:04.348879 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_hourly
[0m21:58:04.350046 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9338b190>]}
[0m21:58:04.359425 [info ] [Thread-2 (]: 18 of 22 OK created sql table model public.mart_weekly_extended ................ [[32mSELECT 34[0m in 0.21s]
[0m21:58:04.353377 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:58:04.361268 [debug] [Thread-1 (]: On model.data_project_1.mart_alerts: BEGIN
[0m21:58:04.351842 [info ] [Thread-4 (]: 21 of 22 START sql table model public.mart_monthly_promedio .................... [RUN]
[0m21:58:04.360465 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_weekly_extended
[0m21:58:04.358167 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_hourly"
[0m21:58:04.361970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:04.363765 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_top_polluted_stations, now model.data_project_1.mart_monthly_promedio)
[0m21:58:04.367147 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_monthly_promedio
[0m21:58:04.364997 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_fact_air_quality
[0m21:58:04.368388 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_hourly
[0m21:58:04.373185 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_monthly_promedio"
[0m21:58:04.374474 [info ] [Thread-2 (]: 22 of 22 START sql table model public.mart_fact_air_quality .................... [RUN]
[0m21:58:04.375321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m21:58:04.381922 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:58:04.382589 [debug] [Thread-1 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */

  
    

  create  table "data_project_1"."public"."mart_alerts__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select *
    from "data_project_1"."public"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    case 
        when no2_avg > 200 then 'Alerta NO2'
        when o3_avg > 180 then 'Alerta O3'
        when pm10_avg > 150 then 'Alerta PM10'
        when pm25_avg > 75 then 'Alerta PM2.5'
        else null
    end as alerta
from hourly_data
where no2_avg > 200
   or o3_avg > 180
   or pm10_avg > 150
   or pm25_avg > 75
order by fecha_hour, city, nombre_estacion
  );
  
[0m21:58:04.382155 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_monthly_promedio
[0m21:58:04.379803 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_hourly"
[0m21:58:04.381119 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_weekly_extended, now model.data_project_1.mart_fact_air_quality)
[0m21:58:04.385802 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_monthly_promedio"
[0m21:58:04.389321 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:58:04.390018 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: BEGIN
[0m21:58:04.387095 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_fact_air_quality
[0m21:58:04.388390 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.005 seconds
[0m21:58:04.390565 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:58:04.391265 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:58:04.401731 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: BEGIN
[0m21:58:04.402335 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:58:04.396237 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_fact_air_quality"
[0m21:58:04.398684 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:58:04.404425 [debug] [Thread-1 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."public"."mart_alerts" rename to "mart_alerts__dbt_backup"
[0m21:58:04.405461 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m21:58:04.407764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.409203 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:58:04.409604 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_fact_air_quality
[0m21:58:04.415622 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_fact_air_quality"
[0m21:58:04.412774 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */

  
    

  create  table "data_project_1"."public"."mart_hourly__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select * 
    from "data_project_1"."public"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Ãndice de contaminaciÃ³n por hora
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n de NO2 por niveles
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por hora dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_hour order by pm25_avg desc) as ranking_pm25
from hourly_data
order by fecha_hour, city, nombre_estacion
  );
  
[0m21:58:04.413298 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m21:58:04.411932 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:58:04.417416 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:58:04.420566 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */

  
    

  create  table "data_project_1"."public"."mart_monthly_promedio__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    nombre_estacion,
    fecha_month,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as contaminacion_promedio
from "data_project_1"."public"."int_monthly_avg"
  );
  
[0m21:58:04.420017 [debug] [Thread-1 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."public"."mart_alerts__dbt_tmp" rename to "mart_alerts"
[0m21:58:04.418600 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:58:04.421075 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: BEGIN
[0m21:58:04.422918 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:58:04.421336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:58:04.425071 [debug] [Thread-1 (]: On model.data_project_1.mart_alerts: COMMIT
[0m21:58:04.427535 [debug] [Thread-4 (]: SQL status: SELECT 34 in 0.007 seconds
[0m21:58:04.427954 [debug] [Thread-3 (]: SQL status: SELECT 306 in 0.011 seconds
[0m21:58:04.428279 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:58:04.432869 [debug] [Thread-1 (]: On model.data_project_1.mart_alerts: COMMIT
[0m21:58:04.431006 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m21:58:04.433518 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:58:04.430636 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:58:04.432536 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:58:04.433928 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */

  
    

  create  table "data_project_1"."public"."mart_fact_air_quality__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * from "data_project_1"."public"."int_daily_avg"
),
weekly_data as (
    select * from "data_project_1"."public"."mart_weekly_extended"
),
monthly_data as (
    select * from "data_project_1"."public"."int_monthly_avg"
)

select
    coalesce(d.city, w.city, m.city) as city,
    coalesce(d.nombre_estacion, w.nombre_estacion, m.nombre_estacion) as nombre_estacion,
    d.fecha_day,
    w.fecha_week,
    m.fecha_month,
    d.no2_avg as daily_no2,
    d.o3_avg as daily_o3,
    d.pm10_avg as daily_pm10,
    d.pm25_avg as daily_pm25,
    w.no2_avg as weekly_no2,
    w.o3_avg as weekly_o3,
    w.pm10_avg as weekly_pm10,
    w.pm25_avg as weekly_pm25,
    m.no2_avg as monthly_no2,
    m.o3_avg as monthly_o3,
    m.pm10_avg as monthly_pm10,
    m.pm25_avg as monthly_pm25
from daily_data d
full outer join weekly_data w
    on d.city = w.city
    and d.nombre_estacion = w.nombre_estacion
    and date_trunc('week', d.fecha_day) = w.fecha_week
full outer join monthly_data m
    on coalesce(d.city, w.city) = m.city
    and coalesce(d.nombre_estacion, w.nombre_estacion) = m.nombre_estacion
    and date_trunc('month', d.fecha_day) = m.fecha_month
order by city, nombre_estacion, d.fecha_day
  );
  
[0m21:58:04.434240 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."public"."mart_monthly_promedio" rename to "mart_monthly_promedio__dbt_backup"
[0m21:58:04.434426 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:58:04.434684 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."public"."mart_hourly" rename to "mart_hourly__dbt_backup"
[0m21:58:04.436951 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."mart_alerts__dbt_backup"
[0m21:58:04.438496 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m21:58:04.439349 [debug] [Thread-1 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
drop table if exists "data_project_1"."public"."mart_alerts__dbt_backup" cascade
[0m21:58:04.439015 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.439183 [debug] [Thread-2 (]: SQL status: SELECT 102 in 0.004 seconds
[0m21:58:04.437286 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:58:04.441794 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:58:04.442031 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:58:04.443647 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:58:04.445470 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:58:04.446040 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."public"."mart_hourly__dbt_tmp" rename to "mart_hourly"
[0m21:58:04.447526 [debug] [Thread-1 (]: On model.data_project_1.mart_alerts: Close
[0m21:58:04.447869 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."public"."mart_fact_air_quality" rename to "mart_fact_air_quality__dbt_backup"
[0m21:58:04.448625 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."public"."mart_monthly_promedio__dbt_tmp" rename to "mart_monthly_promedio"
[0m21:58:04.450270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91fbbf50>]}
[0m21:58:04.450655 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.452064 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.452229 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.457347 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m21:58:04.453842 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: COMMIT
[0m21:58:04.456504 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:58:04.451817 [info ] [Thread-1 (]: 19 of 22 OK created sql table model public.mart_alerts ......................... [[32mSELECT 0[0m in 0.12s]
[0m21:58:04.458723 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_alerts
[0m21:58:04.458070 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:58:04.458376 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."public"."mart_fact_air_quality__dbt_tmp" rename to "mart_fact_air_quality"
[0m21:58:04.457600 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:58:04.459419 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: COMMIT
[0m21:58:04.459994 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m21:58:04.460216 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:58:04.461541 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m21:58:04.462085 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:58:04.462269 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m21:58:04.462671 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m21:58:04.463006 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m21:58:04.464895 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."mart_monthly_promedio__dbt_backup"
[0m21:58:04.466477 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."mart_hourly__dbt_backup"
[0m21:58:04.466858 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m21:58:04.467593 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m21:58:04.468062 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m21:58:04.469302 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."mart_fact_air_quality__dbt_backup"
[0m21:58:04.469966 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
drop table if exists "data_project_1"."public"."mart_monthly_promedio__dbt_backup" cascade
[0m21:58:04.470492 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
drop table if exists "data_project_1"."public"."mart_hourly__dbt_backup" cascade
[0m21:58:04.471832 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m21:58:04.473913 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
drop table if exists "data_project_1"."public"."mart_fact_air_quality__dbt_backup" cascade
[0m21:58:04.474801 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:58:04.475226 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:58:04.476211 [debug] [Thread-4 (]: On model.data_project_1.mart_monthly_promedio: Close
[0m21:58:04.476823 [debug] [Thread-3 (]: On model.data_project_1.mart_hourly: Close
[0m21:58:04.477268 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b13610>]}
[0m21:58:04.478137 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f5d590>]}
[0m21:58:04.478648 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m21:58:04.480489 [info ] [Thread-4 (]: 21 of 22 OK created sql table model public.mart_monthly_promedio ............... [[32mSELECT 34[0m in 0.11s]
[0m21:58:04.481581 [info ] [Thread-3 (]: 20 of 22 OK created sql table model public.mart_hourly ......................... [[32mSELECT 306[0m in 0.13s]
[0m21:58:04.483634 [debug] [Thread-2 (]: On model.data_project_1.mart_fact_air_quality: Close
[0m21:58:04.484563 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_monthly_promedio
[0m21:58:04.486129 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_hourly
[0m21:58:04.487180 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc4757d-6b0b-4268-874c-13e3dbac5c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92021e10>]}
[0m21:58:04.489406 [info ] [Thread-2 (]: 22 of 22 OK created sql table model public.mart_fact_air_quality ............... [[32mSELECT 102[0m in 0.11s]
[0m21:58:04.490245 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_fact_air_quality
[0m21:58:04.493151 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:04.493510 [debug] [MainThread]: On master: BEGIN
[0m21:58:04.493830 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:58:04.501464 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m21:58:04.502066 [debug] [MainThread]: On master: COMMIT
[0m21:58:04.502501 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:04.503303 [debug] [MainThread]: On master: COMMIT
[0m21:58:04.504418 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:58:04.505336 [debug] [MainThread]: On master: Close
[0m21:58:04.506429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:04.508231 [debug] [MainThread]: Connection 'model.data_project_1.mart_fact_air_quality' was properly closed.
[0m21:58:04.508768 [debug] [MainThread]: Connection 'model.data_project_1.mart_alerts' was properly closed.
[0m21:58:04.509292 [debug] [MainThread]: Connection 'model.data_project_1.mart_monthly_promedio' was properly closed.
[0m21:58:04.509871 [debug] [MainThread]: Connection 'model.data_project_1.mart_hourly' was properly closed.
[0m21:58:04.510699 [info ] [MainThread]: 
[0m21:58:04.511448 [info ] [MainThread]: Finished running 8 table models, 8 data tests, 6 view models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m21:58:04.514027 [debug] [MainThread]: Command end result
[0m21:58:04.556186 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m21:58:04.560423 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m21:58:04.571161 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m21:58:04.572081 [info ] [MainThread]: 
[0m21:58:04.572943 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:58:04.573758 [info ] [MainThread]: 
[0m21:58:04.574240 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=22
[0m21:58:04.575496 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.4657804, "process_in_blocks": "0", "process_kernel_time": 0.335412, "process_mem_max_rss": "132484", "process_out_blocks": "2476", "process_user_time": 1.673023}
[0m21:58:04.576195 [debug] [MainThread]: Command `dbt build` succeeded at 21:58:04.576012 after 1.47 seconds
[0m21:58:04.576921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941541d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94263d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9943f850>]}
[0m21:58:04.577459 [debug] [MainThread]: Flushing usage events
[0m21:58:05.268924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:01:20.472029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3593850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3497150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa37d5950>]}


============================== 22:01:20.475880 | 31963a20-8043-4ff4-bd71-aa115eeded98 ==============================
[0m22:01:20.475880 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:01:20.476883 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'profiles_dir': '/usr/app/dbt', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'write_json': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True'}
[0m22:01:20.543681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31963a20-8043-4ff4-bd71-aa115eeded98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa346dc50>]}
[0m22:01:20.550638 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:01:20.553957 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:01:20.557631 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12432675, "process_in_blocks": "0", "process_kernel_time": 0.103092, "process_mem_max_rss": "104648", "process_out_blocks": "3", "process_user_time": 0.953352}
[0m22:01:20.558950 [debug] [MainThread]: Command `dbt deps` succeeded at 22:01:20.558485 after 0.13 seconds
[0m22:01:20.559901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3589350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa34be950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa851ef50>]}
[0m22:01:20.560785 [debug] [MainThread]: Flushing usage events
[0m22:01:21.288383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:01:22.173317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e92bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d92a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d92750>]}


============================== 22:01:22.176911 | cb6c141c-1909-44e0-b40c-557664cf59d7 ==============================
[0m22:01:22.176911 [info ] [MainThread]: Running with dbt=1.10.15
[0m22:01:22.177770 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --target dev', 'target_path': 'None', 'profiles_dir': '/usr/app/dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'version_check': 'True', 'debug': 'False', 'empty': 'False', 'log_path': '/usr/app/dbt/logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'no_print': 'None', 'printer_width': '80', 'use_colors': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False'}
[0m22:01:22.273470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ff74d0>]}
[0m22:01:22.312908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c9e410>]}
[0m22:01:22.314226 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:01:22.362877 [debug] [MainThread]: checksum: 0f45fdd67cc51382d6521f874e757e7afa214ac7bb0178b13f1819cbe813499c, vars: {}, profile: , target: dev, version: 1.10.15
[0m22:01:22.457633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:01:22.458332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:01:22.494169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92dde7d0>]}
[0m22:01:22.563825 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m22:01:22.567473 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m22:01:22.639766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f83310>]}
[0m22:01:22.640499 [info ] [MainThread]: Found 14 models, 8 data tests, 1 source, 459 macros
[0m22:01:22.643744 [info ] [MainThread]: 
[0m22:01:22.644175 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:01:22.644744 [info ] [MainThread]: 
[0m22:01:22.645556 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:01:22.650255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_data_project_1'
[0m22:01:22.671734 [debug] [ThreadPool]: Using postgres connection "list_data_project_1"
[0m22:01:22.672184 [debug] [ThreadPool]: On list_data_project_1: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1"} */

    select distinct nspname from pg_namespace
  
[0m22:01:22.672787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:22.683316 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m22:01:22.684224 [debug] [ThreadPool]: On list_data_project_1: Close
[0m22:01:22.685477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_project_1, now list_data_project_1_public)
[0m22:01:22.689585 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_public"
[0m22:01:22.690115 [debug] [ThreadPool]: On list_data_project_1_public: BEGIN
[0m22:01:22.690710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:01:22.696635 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:01:22.697040 [debug] [ThreadPool]: Using postgres connection "list_data_project_1_public"
[0m22:01:22.697427 [debug] [ThreadPool]: On list_data_project_1_public: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "list_data_project_1_public"} */
select
      'data_project_1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'data_project_1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'data_project_1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:01:22.699743 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.002 seconds
[0m22:01:22.700738 [debug] [ThreadPool]: On list_data_project_1_public: ROLLBACK
[0m22:01:22.701161 [debug] [ThreadPool]: On list_data_project_1_public: Close
[0m22:01:22.705157 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:22.705453 [debug] [MainThread]: On master: BEGIN
[0m22:01:22.705664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:01:22.709980 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m22:01:22.710250 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:22.710568 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:01:22.713122 [debug] [MainThread]: SQL status: SELECT 20 in 0.002 seconds
[0m22:01:22.715179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c77e50>]}
[0m22:01:22.715513 [debug] [MainThread]: On master: ROLLBACK
[0m22:01:22.715883 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:22.716064 [debug] [MainThread]: On master: BEGIN
[0m22:01:22.716400 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:01:22.716588 [debug] [MainThread]: On master: COMMIT
[0m22:01:22.716762 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:22.716960 [debug] [MainThread]: On master: COMMIT
[0m22:01:22.717211 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:01:22.717372 [debug] [MainThread]: On master: Close
[0m22:01:22.720125 [debug] [Thread-1 (]: Began running node model.data_project_1.stg_mediciones_madrid
[0m22:01:22.720357 [debug] [Thread-2 (]: Began running node model.data_project_1.stg_mediciones_valencia
[0m22:01:22.720667 [info ] [Thread-1 (]: 1 of 22 START sql view model public.stg_mediciones_madrid ...................... [RUN]
[0m22:01:22.721027 [info ] [Thread-2 (]: 2 of 22 START sql view model public.stg_mediciones_valencia .................... [RUN]
[0m22:01:22.721330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_project_1_public, now model.data_project_1.stg_mediciones_madrid)
[0m22:01:22.721645 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.data_project_1.stg_mediciones_valencia'
[0m22:01:22.721889 [debug] [Thread-1 (]: Began compiling node model.data_project_1.stg_mediciones_madrid
[0m22:01:22.722133 [debug] [Thread-2 (]: Began compiling node model.data_project_1.stg_mediciones_valencia
[0m22:01:22.726429 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_madrid"
[0m22:01:22.727777 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.stg_mediciones_valencia"
[0m22:01:22.728809 [debug] [Thread-1 (]: Began executing node model.data_project_1.stg_mediciones_madrid
[0m22:01:22.729061 [debug] [Thread-2 (]: Began executing node model.data_project_1.stg_mediciones_valencia
[0m22:01:22.747798 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_madrid"
[0m22:01:22.750872 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.stg_mediciones_valencia"
[0m22:01:22.755505 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m22:01:22.756914 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: BEGIN
[0m22:01:22.757426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:22.756540 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m22:01:22.758189 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: BEGIN
[0m22:01:22.758769 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:01:22.767370 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m22:01:22.768757 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m22:01:22.769557 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */

  create view "data_project_1"."public"."stg_mediciones_madrid__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'madrid' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='madrid'
  );
[0m22:01:22.768170 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m22:01:22.772916 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m22:01:22.773499 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */

  create view "data_project_1"."public"."stg_mediciones_valencia__dbt_tmp"
    
    
  as (
    

select
    id,
    nombre_estacion,
    'valencia' as city,
    cast(lon as numeric) as lon,
    cast(lat as numeric) as lat,
    cast(no2 as numeric) as no2,
    cast(o3 as numeric) as o3,
    cast(pm10 as numeric) as pm10,
    cast(pm25 as numeric) as pm25,
    fecha_carg,
    created_at, 
    date_trunc('hour', fecha_carg) as fecha_hour,
    date_trunc('day', fecha_carg) as fecha_day,
    date_trunc('month', fecha_carg) as fecha_month
from "data_project_1"."public"."mediciones"
where city='valencia'
  );
[0m22:01:22.772579 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:01:22.779054 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m22:01:22.779278 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m22:01:22.779633 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."public"."stg_mediciones_madrid" rename to "stg_mediciones_madrid__dbt_backup"
[0m22:01:22.784576 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m22:01:22.787243 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."public"."stg_mediciones_valencia" rename to "stg_mediciones_valencia__dbt_backup"
[0m22:01:22.786159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:01:22.790002 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m22:01:22.790265 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m22:01:22.790510 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
alter table "data_project_1"."public"."stg_mediciones_madrid__dbt_tmp" rename to "stg_mediciones_madrid"
[0m22:01:22.796747 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m22:01:22.799863 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
alter table "data_project_1"."public"."stg_mediciones_valencia__dbt_tmp" rename to "stg_mediciones_valencia"
[0m22:01:22.798513 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:01:22.809392 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m22:01:22.810191 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m22:01:22.810896 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: COMMIT
[0m22:01:22.809680 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m22:01:22.812533 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m22:01:22.813228 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m22:01:22.814035 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: COMMIT
[0m22:01:22.813658 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:01:22.821627 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."stg_mediciones_madrid__dbt_backup"
[0m22:01:22.824997 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.stg_mediciones_madrid"
[0m22:01:22.825667 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_madrid"} */
drop view if exists "data_project_1"."public"."stg_mediciones_madrid__dbt_backup" cascade
[0m22:01:22.822166 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m22:01:22.828900 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."stg_mediciones_valencia__dbt_backup"
[0m22:01:22.830447 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.stg_mediciones_valencia"
[0m22:01:22.831123 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.stg_mediciones_valencia"} */
drop view if exists "data_project_1"."public"."stg_mediciones_valencia__dbt_backup" cascade
[0m22:01:22.830660 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:01:22.835438 [debug] [Thread-1 (]: On model.data_project_1.stg_mediciones_madrid: Close
[0m22:01:22.835780 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:01:22.839705 [debug] [Thread-2 (]: On model.data_project_1.stg_mediciones_valencia: Close
[0m22:01:22.840714 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b4f650>]}
[0m22:01:22.837766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b4f610>]}
[0m22:01:22.843130 [info ] [Thread-1 (]: 1 of 22 OK created sql view model public.stg_mediciones_madrid ................. [[32mCREATE VIEW[0m in 0.12s]
[0m22:01:22.841929 [info ] [Thread-2 (]: 2 of 22 OK created sql view model public.stg_mediciones_valencia ............... [[32mCREATE VIEW[0m in 0.12s]
[0m22:01:22.845141 [debug] [Thread-2 (]: Finished running node model.data_project_1.stg_mediciones_valencia
[0m22:01:22.844122 [debug] [Thread-1 (]: Finished running node model.data_project_1.stg_mediciones_madrid
[0m22:01:22.846833 [debug] [Thread-1 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m22:01:22.846344 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m22:01:22.847195 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m22:01:22.847612 [debug] [Thread-2 (]: Began running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m22:01:22.847976 [info ] [Thread-1 (]: 4 of 22 START test not_null_stg_mediciones_valencia_id ......................... [RUN]
[0m22:01:22.850660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_madrid, now test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e)
[0m22:01:22.849182 [info ] [Thread-3 (]: 5 of 22 START test not_null_stg_mediciones_valencia_nombre_estacion ............ [RUN]
[0m22:01:22.849913 [info ] [Thread-2 (]: 6 of 22 START test unique_stg_mediciones_valencia_id ........................... [RUN]
[0m22:01:22.852709 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.stg_mediciones_valencia, now test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170)
[0m22:01:22.853355 [debug] [Thread-2 (]: Began compiling node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m22:01:22.852041 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046'
[0m22:01:22.848515 [info ] [Thread-4 (]: 3 of 22 START test not_null_stg_mediciones_valencia_fecha_carg ................. [RUN]
[0m22:01:22.863786 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e'
[0m22:01:22.864389 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m22:01:22.863112 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m22:01:22.851259 [debug] [Thread-1 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m22:01:22.862448 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m22:01:22.868541 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m22:01:22.873304 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m22:01:22.876208 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m22:01:22.878442 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m22:01:22.878778 [debug] [Thread-2 (]: Began executing node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m22:01:22.890498 [debug] [Thread-1 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m22:01:22.897388 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m22:01:22.897670 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m22:01:22.898247 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m22:01:22.902088 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m22:01:22.906365 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m22:01:22.907383 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m22:01:22.908953 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: BEGIN
[0m22:01:22.909793 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:01:22.909478 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m22:01:22.910474 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: BEGIN
[0m22:01:22.911088 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:01:22.909368 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m22:01:22.909184 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m22:01:22.913489 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: BEGIN
[0m22:01:22.913995 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:01:22.912573 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: BEGIN
[0m22:01:22.915356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:22.918293 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:01:22.918994 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"
[0m22:01:22.919672 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m22:01:22.920860 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"
[0m22:01:22.921354 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."public"."stg_mediciones_valencia"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m22:01:22.921994 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m22:01:22.920280 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."public"."stg_mediciones_valencia"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:01:22.922566 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"
[0m22:01:22.923482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:01:22.924762 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:01:22.925282 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."public"."stg_mediciones_valencia"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m22:01:22.925898 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"
[0m22:01:22.926434 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:01:22.928415 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: ROLLBACK
[0m22:01:22.929358 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."public"."stg_mediciones_valencia"
where id is null



  
  
      
    ) dbt_internal_test
[0m22:01:22.932819 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: ROLLBACK
[0m22:01:22.933630 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:01:22.934369 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046: Close
[0m22:01:22.939125 [info ] [Thread-3 (]: 5 of 22 PASS not_null_stg_mediciones_valencia_nombre_estacion .................. [[32mPASS[0m in 0.09s]
[0m22:01:22.937670 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: ROLLBACK
[0m22:01:22.938091 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:01:22.935840 [debug] [Thread-2 (]: On test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170: Close
[0m22:01:22.941166 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046
[0m22:01:22.941876 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e: Close
[0m22:01:22.943438 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: ROLLBACK
[0m22:01:22.947307 [debug] [Thread-1 (]: On test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e: Close
[0m22:01:22.945937 [debug] [Thread-3 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m22:01:22.945030 [info ] [Thread-2 (]: 6 of 22 PASS unique_stg_mediciones_valencia_id ................................. [[32mPASS[0m in 0.09s]
[0m22:01:22.948088 [info ] [Thread-4 (]: 3 of 22 PASS not_null_stg_mediciones_valencia_fecha_carg ....................... [[32mPASS[0m in 0.08s]
[0m22:01:22.948906 [info ] [Thread-3 (]: 7 of 22 START test not_null_stg_mediciones_madrid_fecha_carg ................... [RUN]
[0m22:01:22.949797 [info ] [Thread-1 (]: 4 of 22 PASS not_null_stg_mediciones_valencia_id ............................... [[32mPASS[0m in 0.10s]
[0m22:01:22.950479 [debug] [Thread-2 (]: Finished running node test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170
[0m22:01:22.951180 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e
[0m22:01:22.951859 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046, now test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf)
[0m22:01:22.952606 [debug] [Thread-1 (]: Finished running node test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e
[0m22:01:22.953327 [debug] [Thread-2 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m22:01:22.954339 [debug] [Thread-4 (]: Began running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m22:01:22.955948 [debug] [Thread-3 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m22:01:22.958390 [debug] [Thread-1 (]: Began running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m22:01:22.970858 [info ] [Thread-1 (]: 10 of 22 START test unique_stg_mediciones_madrid_id ............................ [RUN]
[0m22:01:22.959952 [info ] [Thread-4 (]: 9 of 22 START test not_null_stg_mediciones_madrid_nombre_estacion .............. [RUN]
[0m22:01:22.965048 [debug] [Thread-3 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m22:01:22.959075 [info ] [Thread-2 (]: 8 of 22 START test not_null_stg_mediciones_madrid_id ........................... [RUN]
[0m22:01:22.971398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e, now test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c)
[0m22:01:22.971944 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e, now test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2)
[0m22:01:22.974409 [debug] [Thread-4 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m22:01:22.973841 [debug] [Thread-1 (]: Began compiling node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m22:01:22.974100 [debug] [Thread-3 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m22:01:22.973026 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170, now test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515)
[0m22:01:22.988621 [debug] [Thread-2 (]: Began compiling node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m22:01:22.985971 [debug] [Thread-1 (]: Writing injected SQL for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m22:01:22.987806 [debug] [Thread-3 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m22:01:22.979271 [debug] [Thread-4 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m22:01:22.992972 [debug] [Thread-2 (]: Writing injected SQL for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m22:01:22.998292 [debug] [Thread-1 (]: Began executing node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m22:01:23.001809 [debug] [Thread-1 (]: Writing runtime sql for node "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m22:01:22.999673 [debug] [Thread-4 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m22:01:22.998925 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m22:01:23.006134 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: BEGIN
[0m22:01:23.006774 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:01:23.002566 [debug] [Thread-2 (]: Began executing node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m22:01:23.007033 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m22:01:23.005494 [debug] [Thread-4 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m22:01:23.009298 [debug] [Thread-2 (]: Writing runtime sql for node "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m22:01:23.009889 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: BEGIN
[0m22:01:23.011897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:23.015850 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m22:01:23.016632 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m22:01:23.017809 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: BEGIN
[0m22:01:23.019591 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m22:01:23.021976 [debug] [Thread-3 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"
[0m22:01:23.022610 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select fecha_carg
from "data_project_1"."public"."stg_mediciones_madrid"
where fecha_carg is null



  
  
      
    ) dbt_internal_test
[0m22:01:23.020516 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: BEGIN
[0m22:01:23.021263 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:01:23.023346 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:01:23.025756 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m22:01:23.030973 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: ROLLBACK
[0m22:01:23.026749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m22:01:23.032488 [debug] [Thread-1 (]: Using postgres connection "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"
[0m22:01:23.031758 [debug] [Thread-3 (]: On test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf: Close
[0m22:01:23.033209 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "data_project_1"."public"."stg_mediciones_madrid"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m22:01:23.033628 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m22:01:23.033852 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m22:01:23.037347 [debug] [Thread-4 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"
[0m22:01:23.036623 [debug] [Thread-2 (]: Using postgres connection "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"
[0m22:01:23.034944 [info ] [Thread-3 (]: 7 of 22 PASS not_null_stg_mediciones_madrid_fecha_carg ......................... [[32mPASS[0m in 0.08s]
[0m22:01:23.037799 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m22:01:23.038396 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select nombre_estacion
from "data_project_1"."public"."stg_mediciones_madrid"
where nombre_estacion is null



  
  
      
    ) dbt_internal_test
[0m22:01:23.038936 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "data_project_1"."public"."stg_mediciones_madrid"
where id is null



  
  
      
    ) dbt_internal_test
[0m22:01:23.039664 [debug] [Thread-3 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf
[0m22:01:23.043558 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:01:23.041571 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: ROLLBACK
[0m22:01:23.043960 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m22:01:23.047490 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: ROLLBACK
[0m22:01:23.045489 [debug] [Thread-1 (]: On test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c: Close
[0m22:01:23.044793 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: ROLLBACK
[0m22:01:23.048503 [debug] [Thread-2 (]: On test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515: Close
[0m22:01:23.048869 [info ] [Thread-1 (]: 10 of 22 PASS unique_stg_mediciones_madrid_id .................................. [[32mPASS[0m in 0.08s]
[0m22:01:23.049827 [debug] [Thread-4 (]: On test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2: Close
[0m22:01:23.050844 [info ] [Thread-2 (]: 8 of 22 PASS not_null_stg_mediciones_madrid_id ................................. [[32mPASS[0m in 0.08s]
[0m22:01:23.052754 [debug] [Thread-1 (]: Finished running node test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c
[0m22:01:23.053803 [info ] [Thread-4 (]: 9 of 22 PASS not_null_stg_mediciones_madrid_nombre_estacion .................... [[32mPASS[0m in 0.08s]
[0m22:01:23.057730 [debug] [Thread-4 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2
[0m22:01:23.055340 [debug] [Thread-2 (]: Finished running node test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515
[0m22:01:23.060107 [debug] [Thread-3 (]: Began running node model.data_project_1.int_daily_avg
[0m22:01:23.060799 [debug] [Thread-1 (]: Began running node model.data_project_1.int_hourly_avg
[0m22:01:23.061388 [debug] [Thread-4 (]: Began running node model.data_project_1.int_monthly_avg
[0m22:01:23.067357 [info ] [Thread-4 (]: 13 of 22 START sql view model public.int_monthly_avg ........................... [RUN]
[0m22:01:23.068321 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2, now model.data_project_1.int_monthly_avg)
[0m22:01:23.064158 [info ] [Thread-1 (]: 12 of 22 START sql view model public.int_hourly_avg ............................ [RUN]
[0m22:01:23.062317 [debug] [Thread-2 (]: Began running node model.data_project_1.int_station_summary
[0m22:01:23.063321 [info ] [Thread-3 (]: 11 of 22 START sql view model public.int_daily_avg ............................. [RUN]
[0m22:01:23.072997 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf, now model.data_project_1.int_daily_avg)
[0m22:01:23.073683 [debug] [Thread-3 (]: Began compiling node model.data_project_1.int_daily_avg
[0m22:01:23.071965 [info ] [Thread-2 (]: 14 of 22 START sql view model public.int_station_summary ....................... [RUN]
[0m22:01:23.069017 [debug] [Thread-4 (]: Began compiling node model.data_project_1.int_monthly_avg
[0m22:01:23.070086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c, now model.data_project_1.int_hourly_avg)
[0m22:01:23.084929 [debug] [Thread-1 (]: Began compiling node model.data_project_1.int_hourly_avg
[0m22:01:23.080495 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515, now model.data_project_1.int_station_summary)
[0m22:01:23.091185 [debug] [Thread-2 (]: Began compiling node model.data_project_1.int_station_summary
[0m22:01:23.079451 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.int_daily_avg"
[0m22:01:23.090495 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.int_hourly_avg"
[0m22:01:23.084045 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.int_monthly_avg"
[0m22:01:23.096151 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.int_station_summary"
[0m22:01:23.100098 [debug] [Thread-3 (]: Began executing node model.data_project_1.int_daily_avg
[0m22:01:23.100856 [debug] [Thread-1 (]: Began executing node model.data_project_1.int_hourly_avg
[0m22:01:23.104694 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.int_daily_avg"
[0m22:01:23.105125 [debug] [Thread-2 (]: Began executing node model.data_project_1.int_station_summary
[0m22:01:23.105319 [debug] [Thread-4 (]: Began executing node model.data_project_1.int_monthly_avg
[0m22:01:23.108376 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.int_hourly_avg"
[0m22:01:23.111341 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.int_station_summary"
[0m22:01:23.116668 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m22:01:23.115368 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m22:01:23.117157 [debug] [Thread-1 (]: On model.data_project_1.int_hourly_avg: BEGIN
[0m22:01:23.117320 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m22:01:23.117851 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: BEGIN
[0m22:01:23.114640 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.int_monthly_avg"
[0m22:01:23.118861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:23.119441 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: BEGIN
[0m22:01:23.120109 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:01:23.121807 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:01:23.122845 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m22:01:23.125512 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: BEGIN
[0m22:01:23.126572 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:01:23.128357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:01:23.131554 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m22:01:23.131992 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m22:01:23.134625 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m22:01:23.133485 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m22:01:23.132589 [debug] [Thread-1 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */

  create view "data_project_1"."public"."int_hourly_avg__dbt_tmp"
    
    
  as (
    with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    avg(no2) as no2_avg,
    avg(o3) as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by 1,2,3
order by fecha_hour, city, nombre_estacion
  );
[0m22:01:23.136515 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */

  create view "data_project_1"."public"."int_station_summary__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m22:01:23.137607 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m22:01:23.138014 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m22:01:23.139100 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m22:01:23.139612 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */

  create view "data_project_1"."public"."int_daily_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_day,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_day
order by city, nombre_estacion, fecha_day
  );
[0m22:01:23.140108 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */

  create view "data_project_1"."public"."int_monthly_avg__dbt_tmp"
    
    
  as (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
)

select
    city,
    nombre_estacion,
    fecha_month,
    avg(no2)  as no2_avg,
    avg(o3)   as o3_avg,
    avg(pm10) as pm10_avg,
    avg(pm25) as pm25_avg
from all_data
group by city, nombre_estacion, fecha_month
order by city, nombre_estacion, fecha_month
  );
[0m22:01:23.143699 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:01:23.144834 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:01:23.151363 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m22:01:23.152297 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
alter table "data_project_1"."public"."int_station_summary__dbt_tmp" rename to "int_station_summary"
[0m22:01:23.147973 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m22:01:23.147461 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m22:01:23.160836 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
alter table "data_project_1"."public"."int_daily_avg__dbt_tmp" rename to "int_daily_avg"
[0m22:01:23.159481 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m22:01:23.165506 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: COMMIT
[0m22:01:23.145538 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m22:01:23.168063 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m22:01:23.169998 [debug] [Thread-1 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
alter table "data_project_1"."public"."int_hourly_avg__dbt_tmp" rename to "int_hourly_avg"
[0m22:01:23.166271 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m22:01:23.159905 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m22:01:23.171825 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
alter table "data_project_1"."public"."int_monthly_avg__dbt_tmp" rename to "int_monthly_avg"
[0m22:01:23.171291 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: COMMIT
[0m22:01:23.172164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:01:23.165860 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:01:23.173095 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:23.177766 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m22:01:23.175962 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m22:01:23.174965 [debug] [Thread-1 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m22:01:23.182015 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m22:01:23.183272 [debug] [Thread-1 (]: On model.data_project_1.int_hourly_avg: COMMIT
[0m22:01:23.181166 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m22:01:23.178778 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m22:01:23.179158 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m22:01:23.184429 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: COMMIT
[0m22:01:23.185334 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: COMMIT
[0m22:01:23.188007 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."int_station_summary__dbt_backup"
[0m22:01:23.188288 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m22:01:23.189439 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:01:23.190050 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.int_station_summary"
[0m22:01:23.190398 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:01:23.196018 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."int_hourly_avg__dbt_backup"
[0m22:01:23.197834 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."int_daily_avg__dbt_backup"
[0m22:01:23.198511 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_station_summary"} */
drop view if exists "data_project_1"."public"."int_station_summary__dbt_backup" cascade
[0m22:01:23.200029 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."int_monthly_avg__dbt_backup"
[0m22:01:23.200988 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.int_hourly_avg"
[0m22:01:23.201754 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.int_daily_avg"
[0m22:01:23.204893 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_daily_avg"} */
drop view if exists "data_project_1"."public"."int_daily_avg__dbt_backup" cascade
[0m22:01:23.203640 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:01:23.206172 [debug] [Thread-2 (]: On model.data_project_1.int_station_summary: Close
[0m22:01:23.207622 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91bf52d0>]}
[0m22:01:23.204284 [debug] [Thread-1 (]: On model.data_project_1.int_hourly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_hourly_avg"} */
drop view if exists "data_project_1"."public"."int_hourly_avg__dbt_backup" cascade
[0m22:01:23.206510 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:01:23.203310 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.int_monthly_avg"
[0m22:01:23.215433 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.int_monthly_avg"} */
drop view if exists "data_project_1"."public"."int_monthly_avg__dbt_backup" cascade
[0m22:01:23.212836 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:01:23.214723 [debug] [Thread-3 (]: On model.data_project_1.int_daily_avg: Close
[0m22:01:23.211345 [info ] [Thread-2 (]: 14 of 22 OK created sql view model public.int_station_summary .................. [[32mCREATE VIEW[0m in 0.13s]
[0m22:01:23.218920 [debug] [Thread-2 (]: Finished running node model.data_project_1.int_station_summary
[0m22:01:23.220001 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_station_summary
[0m22:01:23.218279 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b6f450>]}
[0m22:01:23.217243 [debug] [Thread-1 (]: On model.data_project_1.int_hourly_avg: Close
[0m22:01:23.217457 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:01:23.220825 [info ] [Thread-2 (]: 15 of 22 START sql table model public.mart_station_summary ..................... [RUN]
[0m22:01:23.226582 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_station_summary, now model.data_project_1.mart_station_summary)
[0m22:01:23.223660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ced310>]}
[0m22:01:23.225724 [debug] [Thread-4 (]: On model.data_project_1.int_monthly_avg: Close
[0m22:01:23.229594 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b96350>]}
[0m22:01:23.227273 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_station_summary
[0m22:01:23.222097 [info ] [Thread-3 (]: 11 of 22 OK created sql view model public.int_daily_avg ........................ [[32mCREATE VIEW[0m in 0.15s]
[0m22:01:23.237189 [debug] [Thread-3 (]: Finished running node model.data_project_1.int_daily_avg
[0m22:01:23.232900 [info ] [Thread-4 (]: 13 of 22 OK created sql view model public.int_monthly_avg ...................... [[32mCREATE VIEW[0m in 0.16s]
[0m22:01:23.238947 [debug] [Thread-4 (]: Finished running node model.data_project_1.int_monthly_avg
[0m22:01:23.228445 [info ] [Thread-1 (]: 12 of 22 OK created sql view model public.int_hourly_avg ....................... [[32mCREATE VIEW[0m in 0.15s]
[0m22:01:23.240106 [debug] [Thread-1 (]: Finished running node model.data_project_1.int_hourly_avg
[0m22:01:23.236018 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_station_summary"
[0m22:01:23.242328 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_hourly
[0m22:01:23.242112 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_daily_promedio
[0m22:01:23.241887 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_alerts
[0m22:01:23.246460 [info ] [Thread-3 (]: 16 of 22 START sql table model public.mart_alerts .............................. [RUN]
[0m22:01:23.245287 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_station_summary
[0m22:01:23.245610 [info ] [Thread-4 (]: 17 of 22 START sql table model public.mart_daily_promedio ...................... [RUN]
[0m22:01:23.243952 [info ] [Thread-1 (]: 18 of 22 START sql table model public.mart_hourly .............................. [RUN]
[0m22:01:23.268704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_hourly_avg, now model.data_project_1.mart_hourly)
[0m22:01:23.266571 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_station_summary"
[0m22:01:23.271344 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m22:01:23.247854 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_daily_avg, now model.data_project_1.mart_alerts)
[0m22:01:23.273825 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_alerts
[0m22:01:23.267601 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.int_monthly_avg, now model.data_project_1.mart_daily_promedio)
[0m22:01:23.272853 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: BEGIN
[0m22:01:23.269756 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_hourly
[0m22:01:23.279756 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_alerts"
[0m22:01:23.282048 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_daily_promedio
[0m22:01:23.284037 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:01:23.286772 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_hourly"
[0m22:01:23.291537 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_daily_promedio"
[0m22:01:23.292878 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_alerts
[0m22:01:23.301145 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_alerts"
[0m22:01:23.302380 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m22:01:23.303836 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m22:01:23.303230 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_daily_promedio
[0m22:01:23.302971 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_hourly
[0m22:01:23.311658 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_hourly"
[0m22:01:23.305297 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */

  
    

  create  table "data_project_1"."public"."mart_station_summary__dbt_tmp"
  
  
    as
  
  (
    

with all_data as (
    select * from "data_project_1"."public"."stg_mediciones_madrid"
    union all
    select * from "data_project_1"."public"."stg_mediciones_valencia"
),

daily_avg as (
    select
        city,
        nombre_estacion,
        fecha_day,
        avg(no2)  as no2_avg,
        avg(o3)   as o3_avg,
        avg(pm10) as pm10_avg,
        avg(pm25) as pm25_avg
    from all_data
    group by city, nombre_estacion, fecha_day
),

station_summary as (
    select
        city,
        nombre_estacion,
        min(fecha_day) as first_measurement,
        max(fecha_day) as last_measurement,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg,
        case
            when avg(pm25_avg) > 50 then 'Alto'
            when avg(pm25_avg) > 25 then 'Moderado'
            else 'Bajo'
        end as nivel_pm25
    from daily_avg
    group by city, nombre_estacion
)

select *
from station_summary
order by city, nombre_estacion
  );
  
[0m22:01:23.309112 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_daily_promedio"
[0m22:01:23.304814 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m22:01:23.314071 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: BEGIN
[0m22:01:23.313652 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m22:01:23.314755 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:01:23.315298 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m22:01:23.319554 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: BEGIN
[0m22:01:23.320187 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:01:23.316193 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: BEGIN
[0m22:01:23.321700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:23.318624 [debug] [Thread-2 (]: SQL status: SELECT 34 in 0.006 seconds
[0m22:01:23.334150 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m22:01:23.334596 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m22:01:23.335030 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m22:01:23.336982 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m22:01:23.337596 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */

  
    

  create  table "data_project_1"."public"."mart_daily_promedio__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * 
    from "data_project_1"."public"."int_daily_avg"
)

select
    city,
    nombre_estacion,
    fecha_day,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Calculamos un Ã­ndice de contaminaciÃ³n promedio
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n del nivel de NO2
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por dÃ­a dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_day order by pm25_avg desc) as ranking_pm25
from daily_data
order by fecha_day, city, nombre_estacion
  );
  
[0m22:01:23.336427 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m22:01:23.335412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m22:01:23.335890 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
alter table "data_project_1"."public"."mart_station_summary" rename to "mart_station_summary__dbt_backup"
[0m22:01:23.342609 [debug] [Thread-4 (]: SQL status: SELECT 102 in 0.004 seconds
[0m22:01:23.343281 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */

  
    

  create  table "data_project_1"."public"."mart_alerts__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select *
    from "data_project_1"."public"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    case 
        when no2_avg > 200 then 'Alerta NO2'
        when o3_avg > 180 then 'Alerta O3'
        when pm10_avg > 150 then 'Alerta PM10'
        when pm25_avg > 75 then 'Alerta PM2.5'
        else null
    end as alerta
from hourly_data
where no2_avg > 200
   or o3_avg > 180
   or pm10_avg > 150
   or pm25_avg > 75
order by fecha_hour, city, nombre_estacion
  );
  
[0m22:01:23.343995 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m22:01:23.351051 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */

  
    

  create  table "data_project_1"."public"."mart_hourly__dbt_tmp"
  
  
    as
  
  (
    

with hourly_data as (
    select * 
    from "data_project_1"."public"."int_hourly_avg"
)

select
    city,
    nombre_estacion,
    fecha_hour,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    -- Ãndice de contaminaciÃ³n por hora
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    -- ClasificaciÃ³n de NO2 por niveles
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2,
    -- Ranking por hora dentro de cada ciudad segÃºn PM2.5
    rank() over (partition by city, fecha_hour order by pm25_avg desc) as ranking_pm25
from hourly_data
order by fecha_hour, city, nombre_estacion
  );
  
[0m22:01:23.349807 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m22:01:23.352267 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m22:01:23.356390 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."public"."mart_daily_promedio" rename to "mart_daily_promedio__dbt_backup"
[0m22:01:23.360549 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m22:01:23.361821 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.011 seconds
[0m22:01:23.367044 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m22:01:23.362932 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
alter table "data_project_1"."public"."mart_station_summary__dbt_tmp" rename to "mart_station_summary"
[0m22:01:23.361165 [debug] [Thread-1 (]: SQL status: SELECT 306 in 0.009 seconds
[0m22:01:23.367708 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."public"."mart_alerts" rename to "mart_alerts__dbt_backup"
[0m22:01:23.372222 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m22:01:23.372630 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m22:01:23.377688 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: COMMIT
[0m22:01:23.373858 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."public"."mart_hourly" rename to "mart_hourly__dbt_backup"
[0m22:01:23.374259 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:01:23.382934 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m22:01:23.378501 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m22:01:23.379749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:01:23.373046 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m22:01:23.383599 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
alter table "data_project_1"."public"."mart_alerts__dbt_tmp" rename to "mart_alerts"
[0m22:01:23.384349 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: COMMIT
[0m22:01:23.387756 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m22:01:23.393269 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
alter table "data_project_1"."public"."mart_hourly__dbt_tmp" rename to "mart_hourly"
[0m22:01:23.391784 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m22:01:23.396185 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
alter table "data_project_1"."public"."mart_daily_promedio__dbt_tmp" rename to "mart_daily_promedio"
[0m22:01:23.394163 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:01:23.393713 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:01:23.399986 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."mart_station_summary__dbt_backup"
[0m22:01:23.395494 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:01:23.406748 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: COMMIT
[0m22:01:23.402058 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: COMMIT
[0m22:01:23.405728 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_station_summary"
[0m22:01:23.410831 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_station_summary"} */
drop table if exists "data_project_1"."public"."mart_station_summary__dbt_backup" cascade
[0m22:01:23.407344 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m22:01:23.410153 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m22:01:23.400192 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:01:23.416841 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m22:01:23.413933 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:01:23.419167 [debug] [Thread-2 (]: On model.data_project_1.mart_station_summary: Close
[0m22:01:23.419973 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911c5210>]}
[0m22:01:23.417368 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m22:01:23.414501 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: COMMIT
[0m22:01:23.413421 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: COMMIT
[0m22:01:23.421880 [info ] [Thread-2 (]: 15 of 22 OK created sql table model public.mart_station_summary ................ [[32mSELECT 34[0m in 0.19s]
[0m22:01:23.422318 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: COMMIT
[0m22:01:23.423293 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_station_summary
[0m22:01:23.424945 [debug] [Thread-2 (]: Began running node model.data_project_1.mart_monthly_promedio
[0m22:01:23.424098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:01:23.424412 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m22:01:23.430023 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."mart_daily_promedio__dbt_backup"
[0m22:01:23.430663 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_daily_promedio"
[0m22:01:23.431455 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_daily_promedio"} */
drop table if exists "data_project_1"."public"."mart_daily_promedio__dbt_backup" cascade
[0m22:01:23.423730 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:01:23.425606 [info ] [Thread-2 (]: 19 of 22 START sql table model public.mart_monthly_promedio .................... [RUN]
[0m22:01:23.427566 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."mart_hourly__dbt_backup"
[0m22:01:23.438683 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_hourly"
[0m22:01:23.437342 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."mart_alerts__dbt_backup"
[0m22:01:23.439922 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_alerts"
[0m22:01:23.440436 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_alerts"} */
drop table if exists "data_project_1"."public"."mart_alerts__dbt_backup" cascade
[0m22:01:23.439133 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_hourly"} */
drop table if exists "data_project_1"."public"."mart_hourly__dbt_backup" cascade
[0m22:01:23.437985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_station_summary, now model.data_project_1.mart_monthly_promedio)
[0m22:01:23.443301 [debug] [Thread-2 (]: Began compiling node model.data_project_1.mart_monthly_promedio
[0m22:01:23.437675 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m22:01:23.443085 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:01:23.443427 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:01:23.451461 [debug] [Thread-1 (]: On model.data_project_1.mart_hourly: Close
[0m22:01:23.447794 [debug] [Thread-4 (]: On model.data_project_1.mart_daily_promedio: Close
[0m22:01:23.454302 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c01390>]}
[0m22:01:23.455453 [info ] [Thread-4 (]: 17 of 22 OK created sql table model public.mart_daily_promedio ................. [[32mSELECT 102[0m in 0.19s]
[0m22:01:23.453862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9112ac50>]}
[0m22:01:23.458648 [info ] [Thread-1 (]: 18 of 22 OK created sql table model public.mart_hourly ......................... [[32mSELECT 306[0m in 0.19s]
[0m22:01:23.445674 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_project_1.mart_monthly_promedio"
[0m22:01:23.457431 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_daily_promedio
[0m22:01:23.449774 [debug] [Thread-3 (]: On model.data_project_1.mart_alerts: Close
[0m22:01:23.464155 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e3b750>]}
[0m22:01:23.465710 [info ] [Thread-3 (]: 16 of 22 OK created sql table model public.mart_alerts ......................... [[32mSELECT 0[0m in 0.22s]
[0m22:01:23.460514 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_hourly
[0m22:01:23.467108 [debug] [Thread-1 (]: Began running node model.data_project_1.mart_weekly_extended
[0m22:01:23.462766 [debug] [Thread-4 (]: Began running node model.data_project_1.mart_top_polluted_stations
[0m22:01:23.468753 [info ] [Thread-4 (]: 20 of 22 START sql table model public.mart_top_polluted_stations ............... [RUN]
[0m22:01:23.469871 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_daily_promedio, now model.data_project_1.mart_top_polluted_stations)
[0m22:01:23.470738 [debug] [Thread-4 (]: Began compiling node model.data_project_1.mart_top_polluted_stations
[0m22:01:23.466503 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_alerts
[0m22:01:23.465268 [debug] [Thread-2 (]: Began executing node model.data_project_1.mart_monthly_promedio
[0m22:01:23.468056 [info ] [Thread-1 (]: 21 of 22 START sql table model public.mart_weekly_extended ..................... [RUN]
[0m22:01:23.476412 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_project_1.mart_top_polluted_stations"
[0m22:01:23.481392 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_project_1.mart_monthly_promedio"
[0m22:01:23.482367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_hourly, now model.data_project_1.mart_weekly_extended)
[0m22:01:23.484876 [debug] [Thread-1 (]: Began compiling node model.data_project_1.mart_weekly_extended
[0m22:01:23.484185 [debug] [Thread-4 (]: Began executing node model.data_project_1.mart_top_polluted_stations
[0m22:01:23.490192 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m22:01:23.489832 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_project_1.mart_weekly_extended"
[0m22:01:23.492764 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_project_1.mart_top_polluted_stations"
[0m22:01:23.493458 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: BEGIN
[0m22:01:23.495390 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:01:23.496420 [debug] [Thread-1 (]: Began executing node model.data_project_1.mart_weekly_extended
[0m22:01:23.497433 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m22:01:23.500749 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: BEGIN
[0m22:01:23.501281 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:01:23.500244 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_project_1.mart_weekly_extended"
[0m22:01:23.503257 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m22:01:23.503832 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: BEGIN
[0m22:01:23.504319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:23.504938 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m22:01:23.505739 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m22:01:23.507936 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */

  
    

  create  table "data_project_1"."public"."mart_monthly_promedio__dbt_tmp"
  
  
    as
  
  (
    

select
    city,
    nombre_estacion,
    fecha_month,
    no2_avg,
    o3_avg,
    pm10_avg,
    pm25_avg,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as contaminacion_promedio
from "data_project_1"."public"."int_monthly_avg"
  );
  
[0m22:01:23.511299 [debug] [Thread-2 (]: SQL status: SELECT 34 in 0.003 seconds
[0m22:01:23.511955 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m22:01:23.514289 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m22:01:23.515562 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."public"."mart_monthly_promedio" rename to "mart_monthly_promedio__dbt_backup"
[0m22:01:23.514987 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m22:01:23.514506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m22:01:23.516501 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */

  
    

  create  table "data_project_1"."public"."mart_top_polluted_stations__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."public"."int_daily_avg"
),

ranked as (
    select
        city,
        nombre_estacion,
        fecha_day,
        no2_avg,
        o3_avg,
        pm10_avg,
        pm25_avg,
        rank() over (partition by city, fecha_day order by pm25_avg desc) as rank_pm25,
        rank() over (partition by city, fecha_day order by pm10_avg desc) as rank_pm10
    from daily_data
)

select *
from ranked
where rank_pm25 <= 5 or rank_pm10 <= 5
order by fecha_day, city, rank_pm25, rank_pm10
  );
  
[0m22:01:23.516911 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:01:23.517321 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m22:01:23.521313 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m22:01:23.521695 [debug] [Thread-4 (]: SQL status: SELECT 56 in 0.004 seconds
[0m22:01:23.522161 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */

  
    

  create  table "data_project_1"."public"."mart_weekly_extended__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select *
    from "data_project_1"."public"."int_daily_avg"
),

weekly_data as (
    select
        city,
        nombre_estacion,
        date_trunc('week', fecha_day) as fecha_week,
        avg(no2_avg)  as no2_avg,
        avg(o3_avg)   as o3_avg,
        avg(pm10_avg) as pm10_avg,
        avg(pm25_avg) as pm25_avg
    from daily_data
    group by city, nombre_estacion, date_trunc('week', fecha_day)
)

select
    *,
    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,
    case
        when no2_avg > 200 then 'Muy Alto'
        when no2_avg > 100 then 'Alto'
        when no2_avg > 50 then 'Moderado'
        else 'Bajo'
    end as nivel_no2
from weekly_data
order by fecha_week, city, nombre_estacion
  );
  
[0m22:01:23.522723 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
alter table "data_project_1"."public"."mart_monthly_promedio__dbt_tmp" rename to "mart_monthly_promedio"
[0m22:01:23.525041 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m22:01:23.526500 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."public"."mart_top_polluted_stations" rename to "mart_top_polluted_stations__dbt_backup"
[0m22:01:23.526903 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:01:23.527553 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:23.528564 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m22:01:23.531004 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m22:01:23.531182 [debug] [Thread-1 (]: SQL status: SELECT 34 in 0.006 seconds
[0m22:01:23.534506 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m22:01:23.535049 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."public"."mart_weekly_extended" rename to "mart_weekly_extended__dbt_backup"
[0m22:01:23.531723 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m22:01:23.532378 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
alter table "data_project_1"."public"."mart_top_polluted_stations__dbt_tmp" rename to "mart_top_polluted_stations"
[0m22:01:23.535914 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: COMMIT
[0m22:01:23.537295 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:01:23.538566 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m22:01:23.539074 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m22:01:23.539649 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: COMMIT
[0m22:01:23.536212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:01:23.543325 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m22:01:23.543963 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
alter table "data_project_1"."public"."mart_weekly_extended__dbt_tmp" rename to "mart_weekly_extended"
[0m22:01:23.544443 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m22:01:23.547409 [debug] [Thread-2 (]: Applying DROP to: "data_project_1"."public"."mart_monthly_promedio__dbt_backup"
[0m22:01:23.548075 [debug] [Thread-2 (]: Using postgres connection "model.data_project_1.mart_monthly_promedio"
[0m22:01:23.547810 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m22:01:23.550444 [debug] [Thread-4 (]: Applying DROP to: "data_project_1"."public"."mart_top_polluted_stations__dbt_backup"
[0m22:01:23.548544 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_monthly_promedio"} */
drop table if exists "data_project_1"."public"."mart_monthly_promedio__dbt_backup" cascade
[0m22:01:23.547636 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m22:01:23.551206 [debug] [Thread-4 (]: Using postgres connection "model.data_project_1.mart_top_polluted_stations"
[0m22:01:23.553125 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m22:01:23.553715 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_top_polluted_stations"} */
drop table if exists "data_project_1"."public"."mart_top_polluted_stations__dbt_backup" cascade
[0m22:01:23.554279 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m22:01:23.556379 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: COMMIT
[0m22:01:23.559785 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.008 seconds
[0m22:01:23.561595 [debug] [Thread-2 (]: On model.data_project_1.mart_monthly_promedio: Close
[0m22:01:23.562596 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91cec390>]}
[0m22:01:23.564824 [info ] [Thread-2 (]: 19 of 22 OK created sql table model public.mart_monthly_promedio ............... [[32mSELECT 34[0m in 0.12s]
[0m22:01:23.564124 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m22:01:23.567170 [debug] [Thread-4 (]: On model.data_project_1.mart_top_polluted_stations: Close
[0m22:01:23.565753 [debug] [Thread-2 (]: Finished running node model.data_project_1.mart_monthly_promedio
[0m22:01:23.563803 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m22:01:23.569397 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91bd4250>]}
[0m22:01:23.571430 [debug] [Thread-1 (]: Applying DROP to: "data_project_1"."public"."mart_weekly_extended__dbt_backup"
[0m22:01:23.572231 [info ] [Thread-4 (]: 20 of 22 OK created sql table model public.mart_top_polluted_stations .......... [[32mSELECT 56[0m in 0.10s]
[0m22:01:23.572772 [debug] [Thread-1 (]: Using postgres connection "model.data_project_1.mart_weekly_extended"
[0m22:01:23.573109 [debug] [Thread-4 (]: Finished running node model.data_project_1.mart_top_polluted_stations
[0m22:01:23.573324 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_weekly_extended"} */
drop table if exists "data_project_1"."public"."mart_weekly_extended__dbt_backup" cascade
[0m22:01:23.580331 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m22:01:23.581949 [debug] [Thread-1 (]: On model.data_project_1.mart_weekly_extended: Close
[0m22:01:23.582713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c31ed0>]}
[0m22:01:23.584834 [info ] [Thread-1 (]: 21 of 22 OK created sql table model public.mart_weekly_extended ................ [[32mSELECT 34[0m in 0.10s]
[0m22:01:23.585317 [debug] [Thread-1 (]: Finished running node model.data_project_1.mart_weekly_extended
[0m22:01:23.585959 [debug] [Thread-3 (]: Began running node model.data_project_1.mart_fact_air_quality
[0m22:01:23.586233 [info ] [Thread-3 (]: 22 of 22 START sql table model public.mart_fact_air_quality .................... [RUN]
[0m22:01:23.586485 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.data_project_1.mart_alerts, now model.data_project_1.mart_fact_air_quality)
[0m22:01:23.586737 [debug] [Thread-3 (]: Began compiling node model.data_project_1.mart_fact_air_quality
[0m22:01:23.588475 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_project_1.mart_fact_air_quality"
[0m22:01:23.589052 [debug] [Thread-3 (]: Began executing node model.data_project_1.mart_fact_air_quality
[0m22:01:23.592661 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_project_1.mart_fact_air_quality"
[0m22:01:23.593943 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m22:01:23.594490 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: BEGIN
[0m22:01:23.595023 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:01:23.601440 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m22:01:23.601913 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m22:01:23.602227 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */

  
    

  create  table "data_project_1"."public"."mart_fact_air_quality__dbt_tmp"
  
  
    as
  
  (
    

with daily_data as (
    select * from "data_project_1"."public"."int_daily_avg"
),
weekly_data as (
    select * from "data_project_1"."public"."mart_weekly_extended"
),
monthly_data as (
    select * from "data_project_1"."public"."int_monthly_avg"
)

select
    coalesce(d.city, w.city, m.city) as city,
    coalesce(d.nombre_estacion, w.nombre_estacion, m.nombre_estacion) as nombre_estacion,
    d.fecha_day,
    w.fecha_week,
    m.fecha_month,
    d.no2_avg as daily_no2,
    d.o3_avg as daily_o3,
    d.pm10_avg as daily_pm10,
    d.pm25_avg as daily_pm25,
    w.no2_avg as weekly_no2,
    w.o3_avg as weekly_o3,
    w.pm10_avg as weekly_pm10,
    w.pm25_avg as weekly_pm25,
    m.no2_avg as monthly_no2,
    m.o3_avg as monthly_o3,
    m.pm10_avg as monthly_pm10,
    m.pm25_avg as monthly_pm25
from daily_data d
full outer join weekly_data w
    on d.city = w.city
    and d.nombre_estacion = w.nombre_estacion
    and date_trunc('week', d.fecha_day) = w.fecha_week
full outer join monthly_data m
    on coalesce(d.city, w.city) = m.city
    and coalesce(d.nombre_estacion, w.nombre_estacion) = m.nombre_estacion
    and date_trunc('month', d.fecha_day) = m.fecha_month
order by city, nombre_estacion, d.fecha_day
  );
  
[0m22:01:23.607637 [debug] [Thread-3 (]: SQL status: SELECT 102 in 0.005 seconds
[0m22:01:23.610123 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m22:01:23.610432 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."public"."mart_fact_air_quality" rename to "mart_fact_air_quality__dbt_backup"
[0m22:01:23.611068 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:23.612732 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m22:01:23.613093 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
alter table "data_project_1"."public"."mart_fact_air_quality__dbt_tmp" rename to "mart_fact_air_quality"
[0m22:01:23.613727 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:01:23.614613 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m22:01:23.614884 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m22:01:23.615099 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: COMMIT
[0m22:01:23.615808 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m22:01:23.617126 [debug] [Thread-3 (]: Applying DROP to: "data_project_1"."public"."mart_fact_air_quality__dbt_backup"
[0m22:01:23.617923 [debug] [Thread-3 (]: Using postgres connection "model.data_project_1.mart_fact_air_quality"
[0m22:01:23.618282 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "data_project_1", "target_name": "dev", "node_id": "model.data_project_1.mart_fact_air_quality"} */
drop table if exists "data_project_1"."public"."mart_fact_air_quality__dbt_backup" cascade
[0m22:01:23.620720 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:01:23.621755 [debug] [Thread-3 (]: On model.data_project_1.mart_fact_air_quality: Close
[0m22:01:23.622380 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c141c-1909-44e0-b40c-557664cf59d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9073e7d0>]}
[0m22:01:23.622869 [info ] [Thread-3 (]: 22 of 22 OK created sql table model public.mart_fact_air_quality ............... [[32mSELECT 102[0m in 0.04s]
[0m22:01:23.623404 [debug] [Thread-3 (]: Finished running node model.data_project_1.mart_fact_air_quality
[0m22:01:23.625248 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:23.625599 [debug] [MainThread]: On master: BEGIN
[0m22:01:23.625864 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:01:23.631880 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:01:23.632561 [debug] [MainThread]: On master: COMMIT
[0m22:01:23.632994 [debug] [MainThread]: Using postgres connection "master"
[0m22:01:23.633300 [debug] [MainThread]: On master: COMMIT
[0m22:01:23.633956 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:01:23.634392 [debug] [MainThread]: On master: Close
[0m22:01:23.635073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:23.635485 [debug] [MainThread]: Connection 'model.data_project_1.mart_weekly_extended' was properly closed.
[0m22:01:23.635857 [debug] [MainThread]: Connection 'model.data_project_1.mart_monthly_promedio' was properly closed.
[0m22:01:23.636183 [debug] [MainThread]: Connection 'model.data_project_1.mart_fact_air_quality' was properly closed.
[0m22:01:23.636626 [debug] [MainThread]: Connection 'model.data_project_1.mart_top_polluted_stations' was properly closed.
[0m22:01:23.637154 [info ] [MainThread]: 
[0m22:01:23.637600 [info ] [MainThread]: Finished running 8 table models, 8 data tests, 6 view models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m22:01:23.639052 [debug] [MainThread]: Command end result
[0m22:01:23.672392 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/dbt/target/manifest.json
[0m22:01:23.674565 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/dbt/target/semantic_manifest.json
[0m22:01:23.679662 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/dbt/target/run_results.json
[0m22:01:23.680177 [info ] [MainThread]: 
[0m22:01:23.680691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:01:23.681148 [info ] [MainThread]: 
[0m22:01:23.681602 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=22
[0m22:01:23.682578 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.536827, "process_in_blocks": "0", "process_kernel_time": 0.317484, "process_mem_max_rss": "132468", "process_out_blocks": "2476", "process_user_time": 1.630759}
[0m22:01:23.683133 [debug] [MainThread]: Command `dbt build` succeeded at 22:01:23.683021 after 1.54 seconds
[0m22:01:23.683766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941a8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9903f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e97790>]}
[0m22:01:23.684451 [debug] [MainThread]: Flushing usage events
[0m22:01:24.364594 [debug] [MainThread]: An error was encountered while trying to flush usage events
