{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.15", "generated_at": "2025-12-04T10:57:12.895795Z", "invocation_id": "c902803a-c3e4-45d2-b674-1990f4e49575", "invocation_started_at": "2025-12-04T10:56:57.898683Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:01.833551Z", "completed_at": "2025-12-04T10:57:01.895201Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:01.901877Z", "completed_at": "2025-12-04T10:57:02.881462Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.064145565032959, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.data_project_1.stg_mediciones_madrid", "compiled": true, "compiled_code": "\n\nselect\n    id,\n    nombre_estacion,\n    'madrid' as city,\n    cast(lon as numeric) as lon,\n    cast(lat as numeric) as lat,\n    cast(no2 as numeric) as no2,\n    cast(o3 as numeric) as o3,\n    cast(pm10 as numeric) as pm10,\n    cast(pm25 as numeric) as pm25,\n    fecha_carg,\n    created_at, \n    date_trunc('hour', fecha_carg) as fecha_hour,\n    date_trunc('day', fecha_carg) as fecha_day,\n    date_trunc('month', fecha_carg) as fecha_month\nfrom \"data_project_1\".\"public\".\"mediciones\"\nwhere city='madrid'", "relation_name": "\"data_project_1\".\"analytics\".\"stg_mediciones_madrid\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:01.850267Z", "completed_at": "2025-12-04T10:57:01.909085Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:01.934967Z", "completed_at": "2025-12-04T10:57:02.891194Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.072221279144287, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.data_project_1.stg_mediciones_valencia", "compiled": true, "compiled_code": "\n\nselect\n    id,\n    nombre_estacion,\n    'valencia' as city,\n    cast(lon as numeric) as lon,\n    cast(lat as numeric) as lat,\n    cast(no2 as numeric) as no2,\n    cast(o3 as numeric) as o3,\n    cast(pm10 as numeric) as pm10,\n    cast(pm25 as numeric) as pm25,\n    fecha_carg,\n    created_at, \n    date_trunc('hour', fecha_carg) as fecha_hour,\n    date_trunc('day', fecha_carg) as fecha_day,\n    date_trunc('month', fecha_carg) as fecha_month\nfrom \"data_project_1\".\"public\".\"mediciones\"\nwhere city='valencia'", "relation_name": "\"data_project_1\".\"analytics\".\"stg_mediciones_valencia\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:03.034320Z", "completed_at": "2025-12-04T10:57:03.085305Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:03.155523Z", "completed_at": "2025-12-04T10:57:03.287623Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3535761833190918, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.data_project_1.unique_stg_mediciones_madrid_id.d23c45c57c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"data_project_1\".\"analytics\".\"stg_mediciones_madrid\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:02.970070Z", "completed_at": "2025-12-04T10:57:03.063016Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:03.068460Z", "completed_at": "2025-12-04T10:57:03.304320Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.41094112396240234, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.data_project_1.not_null_stg_mediciones_madrid_fecha_carg.716ed47dcf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect fecha_carg\nfrom \"data_project_1\".\"analytics\".\"stg_mediciones_madrid\"\nwhere fecha_carg is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:02.995589Z", "completed_at": "2025-12-04T10:57:03.066858Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:03.107854Z", "completed_at": "2025-12-04T10:57:03.313773Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4109158515930176, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.data_project_1.not_null_stg_mediciones_madrid_id.c139e76515", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"data_project_1\".\"analytics\".\"stg_mediciones_madrid\"\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:03.008732Z", "completed_at": "2025-12-04T10:57:03.073985Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:03.147248Z", "completed_at": "2025-12-04T10:57:03.334588Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4276924133300781, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.data_project_1.not_null_stg_mediciones_madrid_nombre_estacion.43047357f2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nombre_estacion\nfrom \"data_project_1\".\"analytics\".\"stg_mediciones_madrid\"\nwhere nombre_estacion is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:03.430267Z", "completed_at": "2025-12-04T10:57:03.492284Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:03.510438Z", "completed_at": "2025-12-04T10:57:03.637496Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.26636171340942383, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.data_project_1.not_null_stg_mediciones_valencia_fecha_carg.582baa8f9e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect fecha_carg\nfrom \"data_project_1\".\"analytics\".\"stg_mediciones_valencia\"\nwhere fecha_carg is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:03.462564Z", "completed_at": "2025-12-04T10:57:03.518915Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:03.536381Z", "completed_at": "2025-12-04T10:57:03.667559Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2722134590148926, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.data_project_1.not_null_stg_mediciones_valencia_id.e44a3bfb4e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"data_project_1\".\"analytics\".\"stg_mediciones_valencia\"\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:03.474593Z", "completed_at": "2025-12-04T10:57:03.517772Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:03.526290Z", "completed_at": "2025-12-04T10:57:03.675971Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2737131118774414, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.data_project_1.not_null_stg_mediciones_valencia_nombre_estacion.e581163046", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nombre_estacion\nfrom \"data_project_1\".\"analytics\".\"stg_mediciones_valencia\"\nwhere nombre_estacion is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:03.497080Z", "completed_at": "2025-12-04T10:57:03.557442Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:03.566702Z", "completed_at": "2025-12-04T10:57:03.734852Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.29744410514831543, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.data_project_1.unique_stg_mediciones_valencia_id.fcb6324170", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"data_project_1\".\"analytics\".\"stg_mediciones_valencia\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:03.853482Z", "completed_at": "2025-12-04T10:57:03.895158Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:03.901479Z", "completed_at": "2025-12-04T10:57:04.277719Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.49580907821655273, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.data_project_1.int_hourly_avg", "compiled": true, "compiled_code": "with all_data as (\n    select * from \"data_project_1\".\"analytics\".\"stg_mediciones_madrid\"\n    union all\n    select * from \"data_project_1\".\"analytics\".\"stg_mediciones_valencia\"\n)\n\nselect\n    city,\n    nombre_estacion,\n    fecha_hour,\n    avg(no2) as no2_avg,\n    avg(o3) as o3_avg,\n    avg(pm10) as pm10_avg,\n    avg(pm25) as pm25_avg\nfrom all_data\ngroup by 1,2,3\norder by fecha_hour, city, nombre_estacion", "relation_name": "\"data_project_1\".\"analytics\".\"int_hourly_avg\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:03.861868Z", "completed_at": "2025-12-04T10:57:03.900573Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:03.925878Z", "completed_at": "2025-12-04T10:57:04.342423Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5553989410400391, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.data_project_1.int_monthly_avg", "compiled": true, "compiled_code": "\n\nwith all_data as (\n    select * from \"data_project_1\".\"analytics\".\"stg_mediciones_madrid\"\n    union all\n    select * from \"data_project_1\".\"analytics\".\"stg_mediciones_valencia\"\n)\n\nselect\n    city,\n    nombre_estacion,\n    fecha_month,\n    avg(no2)  as no2_avg,\n    avg(o3)   as o3_avg,\n    avg(pm10) as pm10_avg,\n    avg(pm25) as pm25_avg\nfrom all_data\ngroup by city, nombre_estacion, fecha_month\norder by city, nombre_estacion, fecha_month", "relation_name": "\"data_project_1\".\"analytics\".\"int_monthly_avg\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:03.869716Z", "completed_at": "2025-12-04T10:57:03.920678Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:03.935043Z", "completed_at": "2025-12-04T10:57:04.357373Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5622153282165527, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.data_project_1.int_station_summary", "compiled": true, "compiled_code": "\n\nwith all_data as (\n    select * from \"data_project_1\".\"analytics\".\"stg_mediciones_madrid\"\n    union all\n    select * from \"data_project_1\".\"analytics\".\"stg_mediciones_valencia\"\n)\n\nselect\n    city,\n    nombre_estacion,\n    fecha_day,\n    avg(no2)  as no2_avg,\n    avg(o3)   as o3_avg,\n    avg(pm10) as pm10_avg,\n    avg(pm25) as pm25_avg\nfrom all_data\ngroup by city, nombre_estacion, fecha_day\norder by city, nombre_estacion, fecha_day", "relation_name": "\"data_project_1\".\"analytics\".\"int_station_summary\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:03.840935Z", "completed_at": "2025-12-04T10:57:03.899135Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:03.915235Z", "completed_at": "2025-12-04T10:57:04.375548Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.6054480075836182, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.data_project_1.int_daily_avg", "compiled": true, "compiled_code": "\n\nwith all_data as (\n    select * from \"data_project_1\".\"analytics\".\"stg_mediciones_madrid\"\n    union all\n    select * from \"data_project_1\".\"analytics\".\"stg_mediciones_valencia\"\n)\n\nselect\n    city,\n    nombre_estacion,\n    fecha_day,\n    avg(no2)  as no2_avg,\n    avg(o3)   as o3_avg,\n    avg(pm10) as pm10_avg,\n    avg(pm25) as pm25_avg\nfrom all_data\ngroup by city, nombre_estacion, fecha_day\norder by city, nombre_estacion, fecha_day", "relation_name": "\"data_project_1\".\"analytics\".\"int_daily_avg\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:04.519169Z", "completed_at": "2025-12-04T10:57:04.584836Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:04.597332Z", "completed_at": "2025-12-04T10:57:06.008504Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.607816219329834, "adapter_response": {"_message": "SELECT 34", "code": "SELECT", "rows_affected": 34}, "message": "SELECT 34", "failures": null, "unique_id": "model.data_project_1.mart_station_summary", "compiled": true, "compiled_code": "\n\nwith all_data as (\n    select * from \"data_project_1\".\"analytics\".\"stg_mediciones_madrid\"\n    union all\n    select * from \"data_project_1\".\"analytics\".\"stg_mediciones_valencia\"\n),\n\ndaily_avg as (\n    select\n        city,\n        nombre_estacion,\n        fecha_day,\n        avg(no2)  as no2_avg,\n        avg(o3)   as o3_avg,\n        avg(pm10) as pm10_avg,\n        avg(pm25) as pm25_avg\n    from all_data\n    group by city, nombre_estacion, fecha_day\n),\n\nstation_summary as (\n    select\n        city,\n        nombre_estacion,\n        min(fecha_day) as first_measurement,\n        max(fecha_day) as last_measurement,\n        avg(no2_avg)  as no2_avg,\n        avg(o3_avg)   as o3_avg,\n        avg(pm10_avg) as pm10_avg,\n        avg(pm25_avg) as pm25_avg,\n        case\n            when avg(pm25_avg) > 50 then 'Alto'\n            when avg(pm25_avg) > 25 then 'Moderado'\n            else 'Bajo'\n        end as nivel_pm25\n    from daily_avg\n    group by city, nombre_estacion\n)\n\nselect *\nfrom station_summary\norder by city, nombre_estacion", "relation_name": "\"data_project_1\".\"analytics\".\"mart_station_summary\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:04.559190Z", "completed_at": "2025-12-04T10:57:04.595339Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:04.649424Z", "completed_at": "2025-12-04T10:57:06.758930Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.688072919845581, "adapter_response": {"_message": "SELECT 0", "code": "SELECT", "rows_affected": 0}, "message": "SELECT 0", "failures": null, "unique_id": "model.data_project_1.mart_alerts", "compiled": true, "compiled_code": "\n\nwith hourly_data as (\n    select *\n    from \"data_project_1\".\"analytics\".\"int_hourly_avg\"\n)\n\nselect\n    city,\n    nombre_estacion,\n    fecha_hour,\n    no2_avg,\n    o3_avg,\n    pm10_avg,\n    pm25_avg,\n    case \n        when no2_avg > 200 then 'Alerta NO2'\n        when o3_avg > 180 then 'Alerta O3'\n        when pm10_avg > 150 then 'Alerta PM10'\n        when pm25_avg > 75 then 'Alerta PM2.5'\n        else null\n    end as alerta\nfrom hourly_data\nwhere no2_avg > 200\n   or o3_avg > 180\n   or pm10_avg > 150\n   or pm25_avg > 75\norder by fecha_hour, city, nombre_estacion", "relation_name": "\"data_project_1\".\"analytics\".\"mart_alerts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:04.572401Z", "completed_at": "2025-12-04T10:57:04.628717Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:04.658628Z", "completed_at": "2025-12-04T10:57:06.961429Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.7565250396728516, "adapter_response": {"_message": "SELECT 136", "code": "SELECT", "rows_affected": 136}, "message": "SELECT 136", "failures": null, "unique_id": "model.data_project_1.mart_hourly", "compiled": true, "compiled_code": "\n\nwith hourly_data as (\n    select * \n    from \"data_project_1\".\"analytics\".\"int_hourly_avg\"\n)\n\nselect\n    city,\n    nombre_estacion,\n    fecha_hour,\n    no2_avg,\n    o3_avg,\n    pm10_avg,\n    pm25_avg,\n    -- \u00cdndice de contaminaci\u00f3n por hora\n    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,\n    -- Clasificaci\u00f3n de NO2 por niveles\n    case\n        when no2_avg > 200 then 'Muy Alto'\n        when no2_avg > 100 then 'Alto'\n        when no2_avg > 50 then 'Moderado'\n        else 'Bajo'\n    end as nivel_no2,\n    -- Ranking por hora dentro de cada ciudad seg\u00fan PM2.5\n    rank() over (partition by city, fecha_hour order by pm25_avg desc) as ranking_pm25\nfrom hourly_data\norder by fecha_hour, city, nombre_estacion", "relation_name": "\"data_project_1\".\"analytics\".\"mart_hourly\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:04.586310Z", "completed_at": "2025-12-04T10:57:04.654929Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:04.668663Z", "completed_at": "2025-12-04T10:57:07.539510Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.2280898094177246, "adapter_response": {"_message": "SELECT 34", "code": "SELECT", "rows_affected": 34}, "message": "SELECT 34", "failures": null, "unique_id": "model.data_project_1.mart_monthly_promedio", "compiled": true, "compiled_code": "\n\nselect\n    city,\n    nombre_estacion,\n    fecha_month,\n    no2_avg,\n    o3_avg,\n    pm10_avg,\n    pm25_avg,\n    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as contaminacion_promedio\nfrom \"data_project_1\".\"analytics\".\"int_monthly_avg\"", "relation_name": "\"data_project_1\".\"analytics\".\"mart_monthly_promedio\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:08.573761Z", "completed_at": "2025-12-04T10:57:09.392857Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:09.485267Z", "completed_at": "2025-12-04T10:57:11.775742Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.142211437225342, "adapter_response": {"_message": "SELECT 68", "code": "SELECT", "rows_affected": 68}, "message": "SELECT 68", "failures": null, "unique_id": "model.data_project_1.mart_daily_promedio", "compiled": true, "compiled_code": "\n\nwith daily_data as (\n    select * \n    from \"data_project_1\".\"analytics\".\"int_daily_avg\"\n)\n\nselect\n    city,\n    nombre_estacion,\n    fecha_day,\n    no2_avg,\n    o3_avg,\n    pm10_avg,\n    pm25_avg,\n    -- Calculamos un \u00edndice de contaminaci\u00f3n promedio\n    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,\n    -- Clasificaci\u00f3n del nivel de NO2\n    case\n        when no2_avg > 200 then 'Muy Alto'\n        when no2_avg > 100 then 'Alto'\n        when no2_avg > 50 then 'Moderado'\n        else 'Bajo'\n    end as nivel_no2,\n    -- Ranking por d\u00eda dentro de cada ciudad seg\u00fan PM2.5\n    rank() over (partition by city, fecha_day order by pm25_avg desc) as ranking_pm25\nfrom daily_data\norder by fecha_day, city, nombre_estacion", "relation_name": "\"data_project_1\".\"analytics\".\"mart_daily_promedio\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:09.322552Z", "completed_at": "2025-12-04T10:57:09.858468Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:09.976778Z", "completed_at": "2025-12-04T10:57:11.813248Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.846388339996338, "adapter_response": {"_message": "SELECT 34", "code": "SELECT", "rows_affected": 34}, "message": "SELECT 34", "failures": null, "unique_id": "model.data_project_1.mart_weekly_extended", "compiled": true, "compiled_code": "\n\nwith daily_data as (\n    select *\n    from \"data_project_1\".\"analytics\".\"int_daily_avg\"\n),\n\nweekly_data as (\n    select\n        city,\n        nombre_estacion,\n        date_trunc('week', fecha_day) as fecha_week,\n        avg(no2_avg)  as no2_avg,\n        avg(o3_avg)   as o3_avg,\n        avg(pm10_avg) as pm10_avg,\n        avg(pm25_avg) as pm25_avg\n    from daily_data\n    group by city, nombre_estacion, date_trunc('week', fecha_day)\n)\n\nselect\n    *,\n    round((no2_avg + o3_avg + pm10_avg + pm25_avg)/4,2) as indice_contaminacion,\n    case\n        when no2_avg > 200 then 'Muy Alto'\n        when no2_avg > 100 then 'Alto'\n        when no2_avg > 50 then 'Moderado'\n        else 'Bajo'\n    end as nivel_no2\nfrom weekly_data\norder by fecha_week, city, nombre_estacion", "relation_name": "\"data_project_1\".\"analytics\".\"mart_weekly_extended\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:09.168979Z", "completed_at": "2025-12-04T10:57:09.693068Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:09.788612Z", "completed_at": "2025-12-04T10:57:11.859322Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 2.9514381885528564, "adapter_response": {"_message": "SELECT 36", "code": "SELECT", "rows_affected": 36}, "message": "SELECT 36", "failures": null, "unique_id": "model.data_project_1.mart_top_polluted_stations", "compiled": true, "compiled_code": "\n\nwith daily_data as (\n    select *\n    from \"data_project_1\".\"analytics\".\"int_daily_avg\"\n),\n\nranked as (\n    select\n        city,\n        nombre_estacion,\n        fecha_day,\n        no2_avg,\n        o3_avg,\n        pm10_avg,\n        pm25_avg,\n        rank() over (partition by city, fecha_day order by pm25_avg desc) as rank_pm25,\n        rank() over (partition by city, fecha_day order by pm10_avg desc) as rank_pm10\n    from daily_data\n)\n\nselect *\nfrom ranked\nwhere rank_pm25 <= 5 or rank_pm10 <= 5\norder by fecha_day, city, rank_pm25, rank_pm10", "relation_name": "\"data_project_1\".\"analytics\".\"mart_top_polluted_stations\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-04T10:57:12.213467Z", "completed_at": "2025-12-04T10:57:12.289337Z"}, {"name": "execute", "started_at": "2025-12-04T10:57:12.293225Z", "completed_at": "2025-12-04T10:57:12.610697Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4497063159942627, "adapter_response": {"_message": "SELECT 68", "code": "SELECT", "rows_affected": 68}, "message": "SELECT 68", "failures": null, "unique_id": "model.data_project_1.mart_fact_air_quality", "compiled": true, "compiled_code": "\n\nwith daily_data as (\n    select * from \"data_project_1\".\"analytics\".\"int_daily_avg\"\n),\nweekly_data as (\n    select * from \"data_project_1\".\"analytics\".\"mart_weekly_extended\"\n),\nmonthly_data as (\n    select * from \"data_project_1\".\"analytics\".\"int_monthly_avg\"\n)\n\nselect\n    coalesce(d.city, w.city, m.city) as city,\n    coalesce(d.nombre_estacion, w.nombre_estacion, m.nombre_estacion) as nombre_estacion,\n    d.fecha_day,\n    w.fecha_week,\n    m.fecha_month,\n    d.no2_avg as daily_no2,\n    d.o3_avg as daily_o3,\n    d.pm10_avg as daily_pm10,\n    d.pm25_avg as daily_pm25,\n    w.no2_avg as weekly_no2,\n    w.o3_avg as weekly_o3,\n    w.pm10_avg as weekly_pm10,\n    w.pm25_avg as weekly_pm25,\n    m.no2_avg as monthly_no2,\n    m.o3_avg as monthly_o3,\n    m.pm10_avg as monthly_pm10,\n    m.pm25_avg as monthly_pm25\nfrom daily_data d\nfull outer join weekly_data w\n    on d.city = w.city\n    and d.nombre_estacion = w.nombre_estacion\n    and date_trunc('week', d.fecha_day) = w.fecha_week\nfull outer join monthly_data m\n    on coalesce(d.city, w.city) = m.city\n    and coalesce(d.nombre_estacion, w.nombre_estacion) = m.nombre_estacion\n    and date_trunc('month', d.fecha_day) = m.fecha_month\norder by city, nombre_estacion, d.fecha_day", "relation_name": "\"data_project_1\".\"analytics\".\"mart_fact_air_quality\"", "batch_results": null}], "elapsed_time": 11.558552980422974, "args": {"log_format_file": "debug", "include_saved_query": false, "profiles_dir": "/usr/app/dbt", "macro_debugging": false, "printer_width": 80, "require_yaml_configuration_for_mf_time_spines": false, "strict_mode": false, "cache_selected_only": false, "project_dir": "/usr/app/dbt", "require_all_warnings_handled_by_warn_error": false, "favor_state": false, "use_fast_test_edges": false, "state_modified_compare_more_unrendered_values": false, "require_resource_names_without_spaces": true, "send_anonymous_usage_stats": true, "require_explicit_package_overrides_for_builtin_materializations": true, "require_generic_test_arguments_property": true, "select": [], "export_saved_queries": false, "version_check": true, "log_level": "info", "show_resource_report": false, "invocation_command": "dbt build --target dev", "state_modified_compare_vars": false, "require_nested_cumulative_type_params": false, "use_colors": true, "introspect": true, "quiet": false, "target": "dev", "warn_error_options": {"error": [], "warn": [], "silence": []}, "exclude": [], "resource_types": [], "indirect_selection": "eager", "vars": {}, "partial_parse_file_diff": true, "print": true, "static_parser": true, "require_batched_execution_for_custom_microbatch_strategy": false, "partial_parse": true, "log_path": "/usr/app/dbt/logs", "empty": false, "log_format": "default", "defer": false, "skip_nodes_if_on_run_start_fails": false, "which": "build", "use_colors_file": true, "show": false, "log_file_max_bytes": 10485760, "upload_to_artifacts_ingest_api": false, "write_json": true, "log_level_file": "debug", "exclude_resource_types": [], "show_all_deprecations": false, "source_freshness_run_project_hooks": true, "validate_macro_args": false, "populate_cache": true}}